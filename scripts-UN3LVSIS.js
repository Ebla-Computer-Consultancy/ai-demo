(()=>{var B=[,function(f,e,t){"use strict";var p=this&&this.__createBinding||(Object.create?function(i,a,s,h){h===void 0&&(h=s),Object.defineProperty(i,h,{enumerable:!0,get:function(){return a[s]}})}:function(i,a,s,h){h===void 0&&(h=s),i[h]=a[s]}),n=this&&this.__exportStar||function(i,a){for(var s in i)s==="default"||a.hasOwnProperty(s)||p(a,i,s)};Object.defineProperty(e,"__esModule",{value:!0}),new(t(2)).AgentConfig,n(t(79),e)},function(f,e,t){"use strict";var p=this&&this.__createBinding||(Object.create?function(s,h,c,r){r===void 0&&(r=c),Object.defineProperty(s,r,{enumerable:!0,get:function(){return h[c]}})}:function(s,h,c,r){r===void 0&&(r=c),s[r]=h[c]}),n=this&&this.__exportStar||function(s,h){for(var c in s)c==="default"||h.hasOwnProperty(c)||p(h,s,c)};Object.defineProperty(e,"__esModule",{value:!0}),e.AutoDetectSourceLanguagesOpenRangeOptionName=e.ForceDictationPropertyName=e.ServicePropertiesPropertyName=e.CancellationErrorCodePropertyName=e.OutputFormatPropertyName=void 0,n(t(3),e),n(t(56),e),n(t(55),e),n(t(57),e),n(t(58),e),n(t(59),e),n(t(203),e),n(t(204),e),n(t(205),e),n(t(207),e),n(t(208),e),n(t(209),e),n(t(210),e),n(t(211),e),n(t(212),e),n(t(213),e),n(t(214),e),n(t(195),e),n(t(215),e),n(t(216),e),n(t(217),e),n(t(218),e),n(t(219),e),n(t(220),e),n(t(221),e),n(t(222),e),n(t(223),e),n(t(224),e),n(t(225),e),n(t(226),e),n(t(227),e),n(t(228),e),n(t(229),e),n(t(230),e),n(t(231),e),n(t(232),e),n(t(233),e),n(t(235),e),n(t(236),e),n(t(237),e),n(t(238),e),n(t(242),e),n(t(243),e),n(t(259),e),n(t(260),e),n(t(262),e);var i=t(263);Object.defineProperty(e,"AvatarSynthesisAdapter",{enumerable:!0,get:function(){return i.AvatarSynthesisAdapter}});var a=t(264);Object.defineProperty(e,"SpeechSynthesisAdapter",{enumerable:!0,get:function(){return a.SpeechSynthesisAdapter}}),n(t(265),e),n(t(266),e),n(t(267),e),n(t(268),e),n(t(269),e),n(t(270),e),n(t(271),e),e.OutputFormatPropertyName="OutputFormat",e.CancellationErrorCodePropertyName="CancellationErrorCode",e.ServicePropertiesPropertyName="ServiceProperties",e.ForceDictationPropertyName="ForceDictation",e.AutoDetectSourceLanguagesOpenRangeOptionName="OpenRange"},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CognitiveSubscriptionKeyAuthentication=void 0;const p=t(4),n=t(54),i=t(55);e.CognitiveSubscriptionKeyAuthentication=class{constructor(a){if(!a)throw new p.ArgumentNullError("subscriptionKey");this.privAuthInfo=new i.AuthInfo(n.HeaderNames.AuthKey,a)}fetch(a){return Promise.resolve(this.privAuthInfo)}fetchOnExpiry(a){return Promise.resolve(this.privAuthInfo)}}},function(f,e,t){"use strict";var p=this&&this.__createBinding||(Object.create?function(a,s,h,c){c===void 0&&(c=h),Object.defineProperty(a,c,{enumerable:!0,get:function(){return s[h]}})}:function(a,s,h,c){c===void 0&&(c=h),a[c]=s[h]}),n=this&&this.__exportStar||function(a,s){for(var h in a)h==="default"||s.hasOwnProperty(h)||p(s,a,h)};Object.defineProperty(e,"__esModule",{value:!0}),n(t(5),e),n(t(24),e),n(t(25),e),n(t(27),e),n(t(28),e),n(t(29),e),n(t(26),e),n(t(30),e),n(t(31),e),n(t(7),e),n(t(32),e),n(t(33),e),n(t(34),e),n(t(35),e),n(t(36),e),n(t(37),e),n(t(38),e),n(t(39),e),n(t(40),e),n(t(41),e),n(t(42),e),n(t(6),e),n(t(43),e),n(t(44),e),n(t(45),e),n(t(46),e),n(t(47),e);var i=t(48);Object.defineProperty(e,"TranslationStatus",{enumerable:!0,get:function(){return i.TranslationStatus}}),n(t(49),e),n(t(50),e),n(t(51),e),n(t(52),e),n(t(53),e)},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AudioStreamNodeErrorEvent=e.AudioStreamNodeDetachedEvent=e.AudioStreamNodeAttachedEvent=e.AudioStreamNodeAttachingEvent=e.AudioStreamNodeEvent=e.AudioSourceErrorEvent=e.AudioSourceOffEvent=e.AudioSourceReadyEvent=e.AudioSourceInitializingEvent=e.AudioSourceEvent=void 0;const p=t(6);class n extends p.PlatformEvent{constructor(s,h,c=p.EventType.Info){super(s,c),this.privAudioSourceId=h}get audioSourceId(){return this.privAudioSourceId}}e.AudioSourceEvent=n,e.AudioSourceInitializingEvent=class extends n{constructor(a){super("AudioSourceInitializingEvent",a)}},e.AudioSourceReadyEvent=class extends n{constructor(a){super("AudioSourceReadyEvent",a)}},e.AudioSourceOffEvent=class extends n{constructor(a){super("AudioSourceOffEvent",a)}},e.AudioSourceErrorEvent=class extends n{constructor(a,s){super("AudioSourceErrorEvent",a,p.EventType.Error),this.privError=s}get error(){return this.privError}};class i extends n{constructor(s,h,c){super(s,h),this.privAudioNodeId=c}get audioNodeId(){return this.privAudioNodeId}}e.AudioStreamNodeEvent=i,e.AudioStreamNodeAttachingEvent=class extends i{constructor(a,s){super("AudioStreamNodeAttachingEvent",a,s)}},e.AudioStreamNodeAttachedEvent=class extends i{constructor(a,s){super("AudioStreamNodeAttachedEvent",a,s)}},e.AudioStreamNodeDetachedEvent=class extends i{constructor(a,s){super("AudioStreamNodeDetachedEvent",a,s)}},e.AudioStreamNodeErrorEvent=class extends i{constructor(a,s,h){super("AudioStreamNodeErrorEvent",a,s),this.privError=h}get error(){return this.privError}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlatformEvent=e.EventType=void 0;const p=t(7);(function(n){n[n.Debug=0]="Debug",n[n.Info=1]="Info",n[n.Warning=2]="Warning",n[n.Error=3]="Error",n[n.None=4]="None"})(e.EventType||(e.EventType={})),e.PlatformEvent=class{constructor(n,i){this.privName=n,this.privEventId=p.createNoDashGuid(),this.privEventTime=new Date().toISOString(),this.privEventType=i,this.privMetadata={}}get name(){return this.privName}get eventId(){return this.privEventId}get eventTime(){return this.privEventTime}get eventType(){return this.privEventType}get metadata(){return this.privMetadata}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createNoDashGuid=e.createGuid=void 0;const p=t(8),n=()=>p.v4();e.createGuid=n,e.createNoDashGuid=()=>n().replace(new RegExp("-","g"),"").toUpperCase()},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"NIL",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"v1",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(e,"v3",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"v4",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"v5",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"validate",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return h.default}});var p=d(t(9)),n=d(t(14)),i=d(t(18)),a=d(t(20)),s=d(t(22)),h=d(t(23)),c=d(t(12)),r=d(t(11)),o=d(t(16));function d(u){return u&&u.__esModule?u:{default:u}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var p,n=(p=t(10))&&p.__esModule?p:{default:p},i=t(11);let a,s,h=0,c=0;var r=function(o,d,u){let v=d&&u||0;const l=d||new Array(16);let g=(o=o||{}).node||a,m=o.clockseq!==void 0?o.clockseq:s;if(g==null||m==null){const I=o.random||(o.rng||n.default)();g==null&&(g=a=[1|I[0],I[1],I[2],I[3],I[4],I[5]]),m==null&&(m=s=16383&(I[6]<<8|I[7]))}let S=o.msecs!==void 0?o.msecs:Date.now(),y=o.nsecs!==void 0?o.nsecs:c+1;const C=S-h+(y-c)/1e4;if(C<0&&o.clockseq===void 0&&(m=m+1&16383),(C<0||S>h)&&o.nsecs===void 0&&(y=0),y>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");h=S,c=y,s=m,S+=122192928e5;const P=(1e4*(268435455&S)+y)%4294967296;l[v++]=P>>>24&255,l[v++]=P>>>16&255,l[v++]=P>>>8&255,l[v++]=255&P;const R=S/4294967296*1e4&268435455;l[v++]=R>>>8&255,l[v++]=255&R,l[v++]=R>>>24&15|16,l[v++]=R>>>16&255,l[v++]=m>>>8|128,l[v++]=255&m;for(let I=0;I<6;++I)l[v+I]=g[I];return d||(0,i.unsafeStringify)(l)};e.default=r},(f,e)=>{"use strict";let t;Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){if(!t&&(t=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!t))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return t(p)};const p=new Uint8Array(16)},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.unsafeStringify=a;var p,n=(p=t(12))&&p.__esModule?p:{default:p};const i=[];for(let h=0;h<256;++h)i.push((h+256).toString(16).slice(1));function a(h,c=0){return(i[h[c+0]]+i[h[c+1]]+i[h[c+2]]+i[h[c+3]]+"-"+i[h[c+4]]+i[h[c+5]]+"-"+i[h[c+6]]+i[h[c+7]]+"-"+i[h[c+8]]+i[h[c+9]]+"-"+i[h[c+10]]+i[h[c+11]]+i[h[c+12]]+i[h[c+13]]+i[h[c+14]]+i[h[c+15]]).toLowerCase()}var s=function(h,c=0){const r=a(h,c);if(!(0,n.default)(r))throw TypeError("Stringified UUID is invalid");return r};e.default=s},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var p,n=(p=t(13))&&p.__esModule?p:{default:p},i=function(a){return typeof a=="string"&&n.default.test(a)};e.default=i},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var p=i(t(15)),n=i(t(17));function i(s){return s&&s.__esModule?s:{default:s}}var a=(0,p.default)("v3",48,n.default);e.default=a},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.URL=e.DNS=void 0,e.default=function(h,c,r){function o(d,u,v,l){var g;if(typeof d=="string"&&(d=function(S){S=unescape(encodeURIComponent(S));const y=[];for(let C=0;C<S.length;++C)y.push(S.charCodeAt(C));return y}(d)),typeof u=="string"&&(u=(0,i.default)(u)),((g=u)===null||g===void 0?void 0:g.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let m=new Uint8Array(16+d.length);if(m.set(u),m.set(d,u.length),m=r(m),m[6]=15&m[6]|c,m[8]=63&m[8]|128,v){l=l||0;for(let S=0;S<16;++S)v[l+S]=m[S];return v}return(0,n.unsafeStringify)(m)}try{o.name=h}catch{}return o.DNS=a,o.URL=s,o};var p,n=t(11),i=(p=t(16))&&p.__esModule?p:{default:p};const a="6ba7b810-9dad-11d1-80b4-00c04fd430c8";e.DNS=a;const s="6ba7b811-9dad-11d1-80b4-00c04fd430c8";e.URL=s},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var p,n=(p=t(12))&&p.__esModule?p:{default:p},i=function(a){if(!(0,n.default)(a))throw TypeError("Invalid UUID");let s;const h=new Uint8Array(16);return h[0]=(s=parseInt(a.slice(0,8),16))>>>24,h[1]=s>>>16&255,h[2]=s>>>8&255,h[3]=255&s,h[4]=(s=parseInt(a.slice(9,13),16))>>>8,h[5]=255&s,h[6]=(s=parseInt(a.slice(14,18),16))>>>8,h[7]=255&s,h[8]=(s=parseInt(a.slice(19,23),16))>>>8,h[9]=255&s,h[10]=(s=parseInt(a.slice(24,36),16))/1099511627776&255,h[11]=s/4294967296&255,h[12]=s>>>24&255,h[13]=s>>>16&255,h[14]=s>>>8&255,h[15]=255&s,h};e.default=i},(f,e)=>{"use strict";function t(r){return 14+(r+64>>>9<<4)+1}function p(r,o){const d=(65535&r)+(65535&o);return(r>>16)+(o>>16)+(d>>16)<<16|65535&d}function n(r,o,d,u,v,l){return p((g=p(p(o,r),p(u,l)))<<(m=v)|g>>>32-m,d);var g,m}function i(r,o,d,u,v,l,g){return n(o&d|~o&u,r,o,v,l,g)}function a(r,o,d,u,v,l,g){return n(o&u|d&~u,r,o,v,l,g)}function s(r,o,d,u,v,l,g){return n(o^d^u,r,o,v,l,g)}function h(r,o,d,u,v,l,g){return n(d^(o|~u),r,o,v,l,g)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var c=function(r){if(typeof r=="string"){const o=unescape(encodeURIComponent(r));r=new Uint8Array(o.length);for(let d=0;d<o.length;++d)r[d]=o.charCodeAt(d)}return function(o){const d=[],u=32*o.length,v="0123456789abcdef";for(let l=0;l<u;l+=8){const g=o[l>>5]>>>l%32&255,m=parseInt(v.charAt(g>>>4&15)+v.charAt(15&g),16);d.push(m)}return d}(function(o,d){o[d>>5]|=128<<d%32,o[t(d)-1]=d;let u=1732584193,v=-271733879,l=-1732584194,g=271733878;for(let m=0;m<o.length;m+=16){const S=u,y=v,C=l,P=g;u=i(u,v,l,g,o[m],7,-680876936),g=i(g,u,v,l,o[m+1],12,-389564586),l=i(l,g,u,v,o[m+2],17,606105819),v=i(v,l,g,u,o[m+3],22,-1044525330),u=i(u,v,l,g,o[m+4],7,-176418897),g=i(g,u,v,l,o[m+5],12,1200080426),l=i(l,g,u,v,o[m+6],17,-1473231341),v=i(v,l,g,u,o[m+7],22,-45705983),u=i(u,v,l,g,o[m+8],7,1770035416),g=i(g,u,v,l,o[m+9],12,-1958414417),l=i(l,g,u,v,o[m+10],17,-42063),v=i(v,l,g,u,o[m+11],22,-1990404162),u=i(u,v,l,g,o[m+12],7,1804603682),g=i(g,u,v,l,o[m+13],12,-40341101),l=i(l,g,u,v,o[m+14],17,-1502002290),v=i(v,l,g,u,o[m+15],22,1236535329),u=a(u,v,l,g,o[m+1],5,-165796510),g=a(g,u,v,l,o[m+6],9,-1069501632),l=a(l,g,u,v,o[m+11],14,643717713),v=a(v,l,g,u,o[m],20,-373897302),u=a(u,v,l,g,o[m+5],5,-701558691),g=a(g,u,v,l,o[m+10],9,38016083),l=a(l,g,u,v,o[m+15],14,-660478335),v=a(v,l,g,u,o[m+4],20,-405537848),u=a(u,v,l,g,o[m+9],5,568446438),g=a(g,u,v,l,o[m+14],9,-1019803690),l=a(l,g,u,v,o[m+3],14,-187363961),v=a(v,l,g,u,o[m+8],20,1163531501),u=a(u,v,l,g,o[m+13],5,-1444681467),g=a(g,u,v,l,o[m+2],9,-51403784),l=a(l,g,u,v,o[m+7],14,1735328473),v=a(v,l,g,u,o[m+12],20,-1926607734),u=s(u,v,l,g,o[m+5],4,-378558),g=s(g,u,v,l,o[m+8],11,-2022574463),l=s(l,g,u,v,o[m+11],16,1839030562),v=s(v,l,g,u,o[m+14],23,-35309556),u=s(u,v,l,g,o[m+1],4,-1530992060),g=s(g,u,v,l,o[m+4],11,1272893353),l=s(l,g,u,v,o[m+7],16,-155497632),v=s(v,l,g,u,o[m+10],23,-1094730640),u=s(u,v,l,g,o[m+13],4,681279174),g=s(g,u,v,l,o[m],11,-358537222),l=s(l,g,u,v,o[m+3],16,-722521979),v=s(v,l,g,u,o[m+6],23,76029189),u=s(u,v,l,g,o[m+9],4,-640364487),g=s(g,u,v,l,o[m+12],11,-421815835),l=s(l,g,u,v,o[m+15],16,530742520),v=s(v,l,g,u,o[m+2],23,-995338651),u=h(u,v,l,g,o[m],6,-198630844),g=h(g,u,v,l,o[m+7],10,1126891415),l=h(l,g,u,v,o[m+14],15,-1416354905),v=h(v,l,g,u,o[m+5],21,-57434055),u=h(u,v,l,g,o[m+12],6,1700485571),g=h(g,u,v,l,o[m+3],10,-1894986606),l=h(l,g,u,v,o[m+10],15,-1051523),v=h(v,l,g,u,o[m+1],21,-2054922799),u=h(u,v,l,g,o[m+8],6,1873313359),g=h(g,u,v,l,o[m+15],10,-30611744),l=h(l,g,u,v,o[m+6],15,-1560198380),v=h(v,l,g,u,o[m+13],21,1309151649),u=h(u,v,l,g,o[m+4],6,-145523070),g=h(g,u,v,l,o[m+11],10,-1120210379),l=h(l,g,u,v,o[m+2],15,718787259),v=h(v,l,g,u,o[m+9],21,-343485551),u=p(u,S),v=p(v,y),l=p(l,C),g=p(g,P)}return[u,v,l,g]}(function(o){if(o.length===0)return[];const d=8*o.length,u=new Uint32Array(t(d));for(let v=0;v<d;v+=8)u[v>>5]|=(255&o[v/8])<<v%32;return u}(r),8*r.length))};e.default=c},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var p=a(t(19)),n=a(t(10)),i=t(11);function a(h){return h&&h.__esModule?h:{default:h}}var s=function(h,c,r){if(p.default.randomUUID&&!c&&!h)return p.default.randomUUID();const o=(h=h||{}).random||(h.rng||n.default)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,c){r=r||0;for(let d=0;d<16;++d)c[r+d]=o[d];return c}return(0,i.unsafeStringify)(o)};e.default=s},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};e.default=t},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var p=i(t(15)),n=i(t(21));function i(s){return s&&s.__esModule?s:{default:s}}var a=(0,p.default)("v5",80,n.default);e.default=a},(f,e)=>{"use strict";function t(i,a,s,h){switch(i){case 0:return a&s^~a&h;case 1:case 3:return a^s^h;case 2:return a&s^a&h^s&h}}function p(i,a){return i<<a|i>>>32-a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=function(i){const a=[1518500249,1859775393,2400959708,3395469782],s=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof i=="string"){const o=unescape(encodeURIComponent(i));i=[];for(let d=0;d<o.length;++d)i.push(o.charCodeAt(d))}else Array.isArray(i)||(i=Array.prototype.slice.call(i));i.push(128);const h=i.length/4+2,c=Math.ceil(h/16),r=new Array(c);for(let o=0;o<c;++o){const d=new Uint32Array(16);for(let u=0;u<16;++u)d[u]=i[64*o+4*u]<<24|i[64*o+4*u+1]<<16|i[64*o+4*u+2]<<8|i[64*o+4*u+3];r[o]=d}r[c-1][14]=8*(i.length-1)/Math.pow(2,32),r[c-1][14]=Math.floor(r[c-1][14]),r[c-1][15]=8*(i.length-1)&4294967295;for(let o=0;o<c;++o){const d=new Uint32Array(80);for(let S=0;S<16;++S)d[S]=r[o][S];for(let S=16;S<80;++S)d[S]=p(d[S-3]^d[S-8]^d[S-14]^d[S-16],1);let u=s[0],v=s[1],l=s[2],g=s[3],m=s[4];for(let S=0;S<80;++S){const y=Math.floor(S/20),C=p(u,5)+t(y,v,l,g)+m+a[y]+d[S]>>>0;m=g,g=l,l=p(v,30)>>>0,v=u,u=C}s[0]=s[0]+u>>>0,s[1]=s[1]+v>>>0,s[2]=s[2]+l>>>0,s[3]=s[3]+g>>>0,s[4]=s[4]+m>>>0}return[s[0]>>24&255,s[0]>>16&255,s[0]>>8&255,255&s[0],s[1]>>24&255,s[1]>>16&255,s[1]>>8&255,255&s[1],s[2]>>24&255,s[2]>>16&255,s[2]>>8&255,255&s[2],s[3]>>24&255,s[3]>>16&255,s[3]>>8&255,255&s[3],s[4]>>24&255,s[4]>>16&255,s[4]>>8&255,255&s[4]]};e.default=n},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.default="00000000-0000-0000-0000-000000000000"},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var p,n=(p=t(12))&&p.__esModule?p:{default:p},i=function(a){if(!(0,n.default)(a))throw TypeError("Invalid UUID");return parseInt(a.slice(14,15),16)};e.default=i},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionMessageSentEvent=e.ConnectionMessageReceivedEvent=e.ConnectionEstablishErrorEvent=e.ConnectionErrorEvent=e.ConnectionClosedEvent=e.ConnectionEstablishedEvent=e.ConnectionStartEvent=e.ConnectionEvent=e.ServiceEvent=void 0;const p=t(6);class n extends p.PlatformEvent{constructor(s,h,c=p.EventType.Info){super(s,c),this.privJsonResult=h}get jsonString(){return this.privJsonResult}}e.ServiceEvent=n;class i extends p.PlatformEvent{constructor(s,h,c=p.EventType.Info){super(s,c),this.privConnectionId=h}get connectionId(){return this.privConnectionId}}e.ConnectionEvent=i,e.ConnectionStartEvent=class extends i{constructor(a,s,h){super("ConnectionStartEvent",a),this.privUri=s,this.privHeaders=h}get uri(){return this.privUri}get headers(){return this.privHeaders}},e.ConnectionEstablishedEvent=class extends i{constructor(a){super("ConnectionEstablishedEvent",a)}},e.ConnectionClosedEvent=class extends i{constructor(a,s,h){super("ConnectionClosedEvent",a,p.EventType.Debug),this.privReason=h,this.privStatusCode=s}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}},e.ConnectionErrorEvent=class extends i{constructor(a,s,h){super("ConnectionErrorEvent",a,p.EventType.Debug),this.privMessage=s,this.privType=h}get message(){return this.privMessage}get type(){return this.privType}},e.ConnectionEstablishErrorEvent=class extends i{constructor(a,s,h){super("ConnectionEstablishErrorEvent",a,p.EventType.Error),this.privStatusCode=s,this.privReason=h}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}},e.ConnectionMessageReceivedEvent=class extends i{constructor(a,s,h){super("ConnectionMessageReceivedEvent",a),this.privNetworkReceivedTime=s,this.privMessage=h}get networkReceivedTime(){return this.privNetworkReceivedTime}get message(){return this.privMessage}},e.ConnectionMessageSentEvent=class extends i{constructor(a,s,h){super("ConnectionMessageSentEvent",a),this.privNetworkSentTime=s,this.privMessage=h}get networkSentTime(){return this.privNetworkSentTime}get message(){return this.privMessage}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionMessage=e.MessageType=void 0;const p=t(26),n=t(7);var i;(function(a){a[a.Text=0]="Text",a[a.Binary=1]="Binary"})(i=e.MessageType||(e.MessageType={})),e.ConnectionMessage=class{constructor(a,s,h,c){if(this.privBody=null,a===i.Text&&s&&typeof s!="string")throw new p.InvalidOperationError("Payload must be a string");if(a===i.Binary&&s&&!(s instanceof ArrayBuffer))throw new p.InvalidOperationError("Payload must be ArrayBuffer");switch(this.privMessageType=a,this.privBody=s,this.privHeaders=h||{},this.privId=c||n.createNoDashGuid(),this.messageType){case i.Binary:this.privSize=this.binaryBody!==null?this.binaryBody.byteLength:0;break;case i.Text:this.privSize=this.textBody.length}}get messageType(){return this.privMessageType}get headers(){return this.privHeaders}get body(){return this.privBody}get textBody(){if(this.privMessageType===i.Binary)throw new p.InvalidOperationError("Not supported for binary message");return this.privBody}get binaryBody(){if(this.privMessageType===i.Text)throw new p.InvalidOperationError("Not supported for text message");return this.privBody}get id(){return this.privId}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ObjectDisposedError=e.InvalidOperationError=e.ArgumentNullError=void 0;class t extends Error{constructor(a){super(a),this.name="ArgumentNull",this.message=a}}e.ArgumentNullError=t;class p extends Error{constructor(a){super(a),this.name="InvalidOperation",this.message=a}}e.InvalidOperationError=p;class n extends Error{constructor(a,s){super(s),this.name=a+"ObjectDisposed",this.message=s}}e.ObjectDisposedError=n},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionOpenResponse=void 0,e.ConnectionOpenResponse=class{constructor(t,p){this.privStatusCode=t,this.privReason=p}get statusCode(){return this.privStatusCode}get reason(){return this.privReason}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DeferralMap=void 0,e.DeferralMap=class{constructor(){this.privMap={}}add(t,p){this.privMap[t]=p}getId(t){return this.privMap[t]}complete(t,p){try{this.privMap[t].resolve(p)}catch(n){this.privMap[t].reject(n)}finally{this.privMap[t]=void 0}}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SendingAgentContextMessageEvent=e.DialogEvent=void 0;const p=t(6);class n extends p.PlatformEvent{constructor(a,s=p.EventType.Info){super(a,s)}}e.DialogEvent=n,e.SendingAgentContextMessageEvent=class extends n{constructor(i){super("SendingAgentContextMessageEvent"),this.privAgentConfig=i}get agentConfig(){return this.privAgentConfig}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Events=void 0;const p=t(26),n=t(31);class i{static setEventSource(s){if(!s)throw new p.ArgumentNullError("eventSource");i.privInstance=s}static get instance(){return i.privInstance}}e.Events=i,i.privInstance=new n.EventSource},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EventSource=void 0;const p=t(26),n=t(7);e.EventSource=class{constructor(i){this.privEventListeners={},this.privIsDisposed=!1,this.privConsoleListener=void 0,this.privMetadata=i}onEvent(i){if(this.isDisposed())throw new p.ObjectDisposedError("EventSource");if(this.metadata)for(const a in this.metadata)a&&i.metadata&&(i.metadata[a]||(i.metadata[a]=this.metadata[a]));for(const a in this.privEventListeners)a&&this.privEventListeners[a]&&this.privEventListeners[a](i)}attach(i){const a=n.createNoDashGuid();return this.privEventListeners[a]=i,{detach:()=>(delete this.privEventListeners[a],Promise.resolve())}}attachListener(i){return this.attach(a=>i.onEvent(a))}attachConsoleListener(i){return this.privConsoleListener&&this.privConsoleListener.detach(),this.privConsoleListener=this.attach(a=>i.onEvent(a)),this.privConsoleListener}isDisposed(){return this.privIsDisposed}dispose(){this.privEventListeners=null,this.privIsDisposed=!0}get metadata(){return this.privMetadata}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionState=void 0,function(t){t[t.None=0]="None",t[t.Connected=1]="Connected",t[t.Connecting=2]="Connecting",t[t.Disconnected=3]="Disconnected"}(e.ConnectionState||(e.ConnectionState={}))},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.List=void 0;const p=t(26);class n{constructor(a){if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.privList=[],a)for(const s of a)this.privList.push(s)}get(a){return this.throwIfDisposed(),this.privList[a]}first(){return this.get(0)}last(){return this.get(this.length()-1)}add(a){this.throwIfDisposed(),this.insertAt(this.privList.length,a)}insertAt(a,s){this.throwIfDisposed(),a===0?this.privList.unshift(s):a===this.privList.length?this.privList.push(s):this.privList.splice(a,0,s),this.triggerSubscriptions(this.privAddSubscriptions)}removeFirst(){return this.throwIfDisposed(),this.removeAt(0)}removeLast(){return this.throwIfDisposed(),this.removeAt(this.length()-1)}removeAt(a){return this.throwIfDisposed(),this.remove(a,1)[0]}remove(a,s){this.throwIfDisposed();const h=this.privList.splice(a,s);return this.triggerSubscriptions(this.privRemoveSubscriptions),h}clear(){this.throwIfDisposed(),this.remove(0,this.length())}length(){return this.throwIfDisposed(),this.privList.length}onAdded(a){this.throwIfDisposed();const s=this.privSubscriptionIdCounter++;return this.privAddSubscriptions[s]=a,{detach:()=>(delete this.privAddSubscriptions[s],Promise.resolve())}}onRemoved(a){this.throwIfDisposed();const s=this.privSubscriptionIdCounter++;return this.privRemoveSubscriptions[s]=a,{detach:()=>(delete this.privRemoveSubscriptions[s],Promise.resolve())}}onDisposed(a){this.throwIfDisposed();const s=this.privSubscriptionIdCounter++;return this.privDisposedSubscriptions[s]=a,{detach:()=>(delete this.privDisposedSubscriptions[s],Promise.resolve())}}join(a){return this.throwIfDisposed(),this.privList.join(a)}toArray(){const a=Array();return this.privList.forEach(s=>{a.push(s)}),a}any(a){return this.throwIfDisposed(),a?this.where(a).length()>0:this.length()>0}all(a){return this.throwIfDisposed(),this.where(a).length()===this.length()}forEach(a){this.throwIfDisposed();for(let s=0;s<this.length();s++)a(this.privList[s],s)}select(a){this.throwIfDisposed();const s=[];for(let h=0;h<this.privList.length;h++)s.push(a(this.privList[h],h));return new n(s)}where(a){this.throwIfDisposed();const s=new n;for(let h=0;h<this.privList.length;h++)a(this.privList[h],h)&&s.add(this.privList[h]);return s}orderBy(a){this.throwIfDisposed();const s=this.toArray().sort(a);return new n(s)}orderByDesc(a){return this.throwIfDisposed(),this.orderBy((s,h)=>a(h,s))}clone(){return this.throwIfDisposed(),new n(this.toArray())}concat(a){return this.throwIfDisposed(),new n(this.privList.concat(a.toArray()))}concatArray(a){return this.throwIfDisposed(),new n(this.privList.concat(a))}isDisposed(){return this.privList==null}dispose(a){this.isDisposed()||(this.privDisposeReason=a,this.privList=null,this.privAddSubscriptions=null,this.privRemoveSubscriptions=null,this.triggerSubscriptions(this.privDisposedSubscriptions))}throwIfDisposed(){if(this.isDisposed())throw new p.ObjectDisposedError("List",this.privDisposeReason)}triggerSubscriptions(a){if(a)for(const s in a)s&&a[s]()}}e.List=n},(f,e)=>{"use strict";var t;Object.defineProperty(e,"__esModule",{value:!0}),e.marshalPromiseToCallbacks=e.Sink=e.Deferred=e.PromiseResultEventSource=e.PromiseResult=e.PromiseState=void 0,function(i){i[i.None=0]="None",i[i.Resolved=1]="Resolved",i[i.Rejected=2]="Rejected"}(t=e.PromiseState||(e.PromiseState={}));class p{constructor(a){this.throwIfError=()=>{if(this.isError)throw this.error},a.on(s=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!1,this.privResult=s)},s=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!0,this.privError=s)})}get isCompleted(){return this.privIsCompleted}get isError(){return this.privIsError}get error(){return this.privError}get result(){return this.privResult}}e.PromiseResult=p;class n{constructor(){this.setResult=a=>{this.privOnSetResult(a)},this.setError=a=>{this.privOnSetError(a)},this.on=(a,s)=>{this.privOnSetResult=a,this.privOnSetError=s}}}e.PromiseResultEventSource=n,e.Deferred=class{constructor(){this.resolve=i=>(this.privResolve(i),this),this.reject=i=>(this.privReject(i),this),this.privPromise=new Promise((i,a)=>{this.privResolve=i,this.privReject=a})}get promise(){return this.privPromise}},e.Sink=class{constructor(){this.privState=t.None,this.privPromiseResult=null,this.privPromiseResultEvents=null,this.privSuccessHandlers=[],this.privErrorHandlers=[],this.privPromiseResultEvents=new n,this.privPromiseResult=new p(this.privPromiseResultEvents)}get state(){return this.privState}get result(){return this.privPromiseResult}resolve(i){if(this.privState!==t.None)throw new Error("'Cannot resolve a completed promise'");this.privState=t.Resolved,this.privPromiseResultEvents.setResult(i);for(let a=0;a<this.privSuccessHandlers.length;a++)this.executeSuccessCallback(i,this.privSuccessHandlers[a],this.privErrorHandlers[a]);this.detachHandlers()}reject(i){if(this.privState!==t.None)throw new Error("'Cannot reject a completed promise'");this.privState=t.Rejected,this.privPromiseResultEvents.setError(i);for(const a of this.privErrorHandlers)this.executeErrorCallback(i,a);this.detachHandlers()}on(i,a){i==null&&(i=()=>{}),this.privState===t.None?(this.privSuccessHandlers.push(i),this.privErrorHandlers.push(a)):(this.privState===t.Resolved?this.executeSuccessCallback(this.privPromiseResult.result,i,a):this.privState===t.Rejected&&this.executeErrorCallback(this.privPromiseResult.error,a),this.detachHandlers())}executeSuccessCallback(i,a,s){try{a(i)}catch(h){this.executeErrorCallback(`'Unhandled callback error: ${h}'`,s)}}executeErrorCallback(i,a){if(!a)throw new Error(`'Unhandled error: ${i}'`);try{a(i)}catch(s){throw new Error(`'Unhandled callback error: ${s}. InnerError: ${i}'`)}}detachHandlers(){this.privErrorHandlers=[],this.privSuccessHandlers=[]}},e.marshalPromiseToCallbacks=function(i,a,s){i.then(h=>{try{a&&a(h)}catch(c){if(s)try{if(c instanceof Error){const r=c;s(r.name+": "+r.message)}else s(c)}catch{}}},h=>{if(s)try{if(h instanceof Error){const c=h;s(c.name+": "+c.message)}else s(h)}catch{}})}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Queue=void 0;const p=t(26),n=t(42),i=t(43);var a;(function(s){s[s.Dequeue=0]="Dequeue",s[s.Peek=1]="Peek"})(a||(a={})),e.Queue=class{constructor(s){this.privPromiseStore=new n.List,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.privList=s||new n.List,this.privDetachables=[],this.privSubscribers=new n.List,this.privDetachables.push(this.privList.onAdded(()=>this.drain()))}enqueue(s){this.throwIfDispose(),this.enqueueFromPromise(new Promise(h=>h(s)))}enqueueFromPromise(s){this.throwIfDispose(),s.then(h=>{this.privList.add(h)},()=>{})}dequeue(){this.throwIfDispose();const s=new i.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:s,type:a.Dequeue}),this.drain()),s.promise}peek(){this.throwIfDispose();const s=new i.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:s,type:a.Peek}),this.drain()),s.promise}length(){return this.throwIfDispose(),this.privList.length()}isDisposed(){return this.privSubscribers==null}async drainAndDispose(s,h){if(!this.isDisposed()&&!this.privIsDisposing){this.privDisposeReason=h,this.privIsDisposing=!0;const c=this.privSubscribers;if(c){for(;c.length()>0;)c.removeFirst().deferral.resolve(void 0);this.privSubscribers===c&&(this.privSubscribers=c)}for(const r of this.privDetachables)await r.detach();if(this.privPromiseStore.length()>0&&s){const r=[];return this.privPromiseStore.toArray().forEach(o=>{r.push(o)}),Promise.all(r).finally(()=>{this.privSubscribers=null,this.privList.forEach(o=>{s(o)}),this.privList=null}).then()}this.privSubscribers=null,this.privList=null}}async dispose(s){await this.drainAndDispose(null,s)}drain(){if(!this.privIsDrainInProgress&&!this.privIsDisposing){this.privIsDrainInProgress=!0;const s=this.privSubscribers,h=this.privList;if(s&&h){for(;h.length()>0&&s.length()>0&&!this.privIsDisposing;){const c=s.removeFirst();if(c.type===a.Peek)c.deferral.resolve(h.first());else{const r=h.removeFirst();c.deferral.resolve(r)}}this.privSubscribers===s&&(this.privSubscribers=s),this.privList===h&&(this.privList=h)}this.privIsDrainInProgress=!1}}throwIfDispose(){if(this.isDisposed())throw this.privDisposeReason?new p.InvalidOperationError(this.privDisposeReason):new p.ObjectDisposedError("Queue");if(this.privIsDisposing)throw new p.InvalidOperationError("Queue disposing")}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RawWebsocketMessage=void 0;const p=t(25),n=t(26),i=t(7);e.RawWebsocketMessage=class{constructor(a,s,h){if(this.privPayload=null,!s)throw new n.ArgumentNullError("payload");if(a===p.MessageType.Binary&&Object.getPrototypeOf(s).constructor.name!=="ArrayBuffer")throw new n.InvalidOperationError("Payload must be ArrayBuffer");if(a===p.MessageType.Text&&typeof s!="string")throw new n.InvalidOperationError("Payload must be a string");this.privMessageType=a,this.privPayload=s,this.privId=h||i.createNoDashGuid()}get messageType(){return this.privMessageType}get payload(){return this.privPayload}get textContent(){if(this.privMessageType===p.MessageType.Binary)throw new n.InvalidOperationError("Not supported for binary message");return this.privPayload}get binaryContent(){if(this.privMessageType===p.MessageType.Text)throw new n.InvalidOperationError("Not supported for text message");return this.privPayload}get id(){return this.privId}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RiffPcmEncoder=void 0,e.RiffPcmEncoder=class{constructor(t,p){this.privActualSampleRate=t,this.privDesiredSampleRate=p}encode(t){const p=this.downSampleAudioFrame(t,this.privActualSampleRate,this.privDesiredSampleRate);if(!p)return null;const n=2*p.length,i=new ArrayBuffer(n),a=new DataView(i);return this.floatTo16BitPCM(a,0,p),i}setString(t,p,n){for(let i=0;i<n.length;i++)t.setUint8(p+i,n.charCodeAt(i))}floatTo16BitPCM(t,p,n){for(let i=0;i<n.length;i++,p+=2){const a=Math.max(-1,Math.min(1,n[i]));t.setInt16(p,a<0?32768*a:32767*a,!0)}}downSampleAudioFrame(t,p,n){if(!t)return null;if(n===p||n>p)return t;const i=p/n,a=Math.round(t.length/i),s=new Float32Array(a);let h=0,c=0;for(;c<a;){const r=Math.round((c+1)*i);let o=0,d=0;for(;h<r&&h<t.length;)o+=t[h++],d++;s[c++]=o/d}return s}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Stream=void 0;const p=t(26),n=t(7),i=t(44);e.Stream=class{constructor(a){this.privIsWriteEnded=!1,this.privIsReadEnded=!1,this.privId=a||n.createNoDashGuid(),this.privReaderQueue=new i.Queue}get isClosed(){return this.privIsWriteEnded}get isReadEnded(){return this.privIsReadEnded}get id(){return this.privId}close(){this.privIsWriteEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsWriteEnded=!0)}writeStreamChunk(a){if(this.throwIfClosed(),!this.privReaderQueue.isDisposed())try{this.privReaderQueue.enqueue(a)}catch{}}read(){if(this.privIsReadEnded)throw new p.InvalidOperationError("Stream read has already finished");return this.privReaderQueue.dequeue().then(async a=>((a===void 0||a.isEnd)&&await this.privReaderQueue.dispose("End of stream reached"),a))}readEnded(){this.privIsReadEnded||(this.privIsReadEnded=!0,this.privReaderQueue=new i.Queue)}throwIfClosed(){if(this.privIsWriteEnded)throw new p.InvalidOperationError("Stream closed")}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TranslationStatus=void 0,function(t){t[t.Success=0]="Success",t[t.Error=1]="Error"}(e.TranslationStatus||(e.TranslationStatus={}))},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ChunkedArrayBufferStream=void 0;const p=t(4);class n extends p.Stream{constructor(a,s){super(s),this.privTargetChunkSize=a,this.privNextBufferReadyBytes=0}writeStreamChunk(a){if(a.isEnd||this.privNextBufferReadyBytes===0&&a.buffer.byteLength===this.privTargetChunkSize)return void super.writeStreamChunk(a);let s=0;for(;s<a.buffer.byteLength;){this.privNextBufferToWrite===void 0&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=a.timeReceived);const h=Math.min(a.buffer.byteLength-s,this.privTargetChunkSize-this.privNextBufferReadyBytes),c=new Uint8Array(this.privNextBufferToWrite),r=new Uint8Array(a.buffer.slice(s,h+s));c.set(r,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=h,s+=h,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(super.writeStreamChunk({buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}}close(){this.privNextBufferReadyBytes===0||this.isClosed||super.writeStreamChunk({buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),super.close()}}e.ChunkedArrayBufferStream=n},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Timeout=void 0;class t{static load(){const n=new Map([[0,()=>{}]]),i=new Map,a="data:text/javascript;base64,"+btoa(`!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error('There is no interval scheduled with the given id "'.concat(e,'".'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error('The given method "'.concat(e.method,'" is not supported'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);`),s=new Worker(a);return s.addEventListener("message",({data:h})=>{if(t.isCallNotification(h)){const{params:{timerId:c}}=h,r=n.get(c);if(typeof r=="number"){const o=i.get(r);if(o===void 0||o!==c)throw new Error("The timer is in an undefined state.")}else{if(r===void 0)throw new Error("The timer is in an undefined state.");r(),n.delete(c)}}else{if(!t.isClearResponse(h)){const{error:{message:c}}=h;throw new Error(c)}{const{id:c}=h,r=i.get(c);if(r===void 0)throw new Error("The timer is in an undefined state.");i.delete(c),n.delete(r)}}}),{clearTimeout:h=>{const c=Math.random();i.set(c,h),n.set(h,c),s.postMessage({id:c,method:"clear",params:{timerId:h}})},setTimeout:(h,c)=>{const r=Math.random();return n.set(r,h),s.postMessage({id:null,method:"set",params:{delay:c,now:performance.now(),timerId:r}}),r}}}static loadWorkerTimers(){return()=>(t.workerTimers!==null||(t.workerTimers=t.load()),t.workerTimers)}static isCallNotification(n){return n.method!==void 0&&n.method==="call"}static isClearResponse(n){return n.error===null&&typeof n.id=="number"}}e.Timeout=t,t.workerTimers=null,t.clearTimeout=p=>t.timers().clearTimeout(p),t.setTimeout=(p,n)=>t.timers().setTimeout(p,n),t.timers=t.loadWorkerTimers()},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.OCSPCacheUpdateErrorEvent=e.OCSPResponseRetrievedEvent=e.OCSPCacheFetchErrorEvent=e.OCSPVerificationFailedEvent=e.OCSPCacheHitEvent=e.OCSPCacheEntryNeedsRefreshEvent=e.OCSPCacheEntryExpiredEvent=e.OCSPWSUpgradeStartedEvent=e.OCSPStapleReceivedEvent=e.OCSPCacheUpdateCompleteEvent=e.OCSPDiskCacheStoreEvent=e.OCSPMemoryCacheStoreEvent=e.OCSPCacheUpdateNeededEvent=e.OCSPDiskCacheHitEvent=e.OCSPCacheMissEvent=e.OCSPMemoryCacheHitEvent=e.OCSPEvent=void 0;const p=t(6);class n extends p.PlatformEvent{constructor(a,s,h){super(a,s),this.privSignature=h}}e.OCSPEvent=n,e.OCSPMemoryCacheHitEvent=class extends n{constructor(i){super("OCSPMemoryCacheHitEvent",p.EventType.Debug,i)}},e.OCSPCacheMissEvent=class extends n{constructor(i){super("OCSPCacheMissEvent",p.EventType.Debug,i)}},e.OCSPDiskCacheHitEvent=class extends n{constructor(i){super("OCSPDiskCacheHitEvent",p.EventType.Debug,i)}},e.OCSPCacheUpdateNeededEvent=class extends n{constructor(i){super("OCSPCacheUpdateNeededEvent",p.EventType.Debug,i)}},e.OCSPMemoryCacheStoreEvent=class extends n{constructor(i){super("OCSPMemoryCacheStoreEvent",p.EventType.Debug,i)}},e.OCSPDiskCacheStoreEvent=class extends n{constructor(i){super("OCSPDiskCacheStoreEvent",p.EventType.Debug,i)}},e.OCSPCacheUpdateCompleteEvent=class extends n{constructor(i){super("OCSPCacheUpdateCompleteEvent",p.EventType.Debug,i)}},e.OCSPStapleReceivedEvent=class extends n{constructor(){super("OCSPStapleReceivedEvent",p.EventType.Debug,"")}},e.OCSPWSUpgradeStartedEvent=class extends n{constructor(i){super("OCSPWSUpgradeStartedEvent",p.EventType.Debug,i)}},e.OCSPCacheEntryExpiredEvent=class extends n{constructor(i,a){super("OCSPCacheEntryExpiredEvent",p.EventType.Debug,i),this.privExpireTime=a}},e.OCSPCacheEntryNeedsRefreshEvent=class extends n{constructor(i,a,s){super("OCSPCacheEntryNeedsRefreshEvent",p.EventType.Debug,i),this.privExpireTime=s,this.privStartTime=a}},e.OCSPCacheHitEvent=class extends n{constructor(i,a,s){super("OCSPCacheHitEvent",p.EventType.Debug,i),this.privExpireTime=s,this.privExpireTimeString=new Date(s).toLocaleDateString(),this.privStartTime=a,this.privStartTimeString=new Date(a).toLocaleTimeString()}},e.OCSPVerificationFailedEvent=class extends n{constructor(i,a){super("OCSPVerificationFailedEvent",p.EventType.Debug,i),this.privError=a}},e.OCSPCacheFetchErrorEvent=class extends n{constructor(i,a){super("OCSPCacheFetchErrorEvent",p.EventType.Debug,i),this.privError=a}},e.OCSPResponseRetrievedEvent=class extends n{constructor(i){super("OCSPResponseRetrievedEvent",p.EventType.Debug,i)}},e.OCSPCacheUpdateErrorEvent=class extends n{constructor(i,a){super("OCSPCacheUpdateErrorEvent",p.EventType.Debug,i),this.privError=a}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BackgroundEvent=void 0;const p=t(4);class n extends p.PlatformEvent{constructor(a){super("BackgroundEvent",p.EventType.Error),this.privError=a}get error(){return this.privError}}e.BackgroundEvent=n},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HeaderNames=void 0;class t{}e.HeaderNames=t,t.AuthKey="Ocp-Apim-Subscription-Key",t.Authorization="Authorization",t.SpIDAuthKey="Apim-Subscription-Id",t.ConnectionId="X-ConnectionId",t.ContentType="Content-Type",t.CustomCommandsAppId="X-CommandsAppId",t.Path="Path",t.RequestId="X-RequestId",t.RequestStreamId="X-StreamId",t.RequestTimestamp="X-Timestamp"},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AuthInfo=void 0,e.AuthInfo=class{constructor(t,p){this.privHeaderName=t,this.privToken=p}get headerName(){return this.privHeaderName}get token(){return this.privToken}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CognitiveTokenAuthentication=void 0;const p=t(4),n=t(55),i=t(54);class a{constructor(h,c){if(!h)throw new p.ArgumentNullError("fetchCallback");if(!c)throw new p.ArgumentNullError("fetchOnExpiryCallback");this.privFetchCallback=h,this.privFetchOnExpiryCallback=c}fetch(h){return this.privFetchCallback(h).then(c=>new n.AuthInfo(i.HeaderNames.Authorization,c===void 0?void 0:a.privTokenPrefix+c))}fetchOnExpiry(h){return this.privFetchOnExpiryCallback(h).then(c=>new n.AuthInfo(i.HeaderNames.Authorization,c===void 0?void 0:a.privTokenPrefix+c))}}e.CognitiveTokenAuthentication=a,a.privTokenPrefix="Bearer "},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.IntentConnectionFactory=void 0;const p=t(60),n=t(79),i=t(134),a=t(2),s=t(54);class h extends i.ConnectionFactoryBase{create(r,o,d){let u=r.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Endpoint);if(!u){const m=r.parameters.getProperty(n.PropertyId.SpeechServiceConnection_IntentRegion),S=i.ConnectionFactoryBase.getHostSuffix(m);u=r.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Host,"wss://"+m+".sr.speech"+S)+"/speech/recognition/interactive/cognitiveservices/v1"}const v={format:"simple",language:r.parameters.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(r,v,u);const l={};o.token!==void 0&&o.token!==""&&(l[o.headerName]=o.token),l[s.HeaderNames.ConnectionId]=d,r.parameters.setProperty(n.PropertyId.SpeechServiceConnection_Url,u);const g=r.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new p.WebsocketConnection(u,v,l,new a.WebsocketMessageFormatter,p.ProxyInfo.fromRecognizerConfig(r),g,d)}getSpeechRegionFromIntentRegion(r){switch(r){case"West US":case"US West":case"westus":return"uswest";case"West US 2":case"US West 2":case"westus2":return"uswest2";case"South Central US":case"US South Central":case"southcentralus":return"ussouthcentral";case"West Central US":case"US West Central":case"westcentralus":return"uswestcentral";case"East US":case"US East":case"eastus":return"useast";case"East US 2":case"US East 2":case"eastus2":return"useast2";case"West Europe":case"Europe West":case"westeurope":return"europewest";case"North Europe":case"Europe North":case"northeurope":return"europenorth";case"Brazil South":case"South Brazil":case"southbrazil":return"brazilsouth";case"Australia East":case"East Australia":case"eastaustralia":return"australiaeast";case"Southeast Asia":case"Asia Southeast":case"southeastasia":return"asiasoutheast";case"East Asia":case"Asia East":case"eastasia":return"asiaeast";default:return r}}}e.IntentConnectionFactory=h},function(f,e,t){"use strict";var p=this&&this.__createBinding||(Object.create?function(i,a,s,h){h===void 0&&(h=s),Object.defineProperty(i,h,{enumerable:!0,get:function(){return a[s]}})}:function(i,a,s,h){h===void 0&&(h=s),i[h]=a[s]}),n=this&&this.__exportStar||function(i,a){for(var s in i)s==="default"||a.hasOwnProperty(s)||p(a,i,s)};Object.defineProperty(e,"__esModule",{value:!0}),n(t(61),e),n(t(65),e),n(t(66),e),n(t(68),e),n(t(69),e),n(t(70),e),n(t(71),e),n(t(77),e),n(t(78),e),n(t(199),e),n(t(202),e)},function(f,e,t){"use strict";var p=this&&this.__createBinding||(Object.create?function(c,r,o,d){d===void 0&&(d=o),Object.defineProperty(c,d,{enumerable:!0,get:function(){return r[o]}})}:function(c,r,o,d){d===void 0&&(d=o),c[d]=r[o]}),n=this&&this.__setModuleDefault||(Object.create?function(c,r){Object.defineProperty(c,"default",{enumerable:!0,value:r})}:function(c,r){c.default=r}),i=this&&this.__importStar||function(c){if(c&&c.__esModule)return c;var r={};if(c!=null)for(var o in c)o!=="default"&&Object.hasOwnProperty.call(c,o)&&p(r,c,o);return n(r,c),r};Object.defineProperty(e,"__esModule",{value:!0}),e.ConsoleLoggingListener=void 0;const a=i(t(62)),s=t(63),h=t(64);e.ConsoleLoggingListener=class{constructor(c=s.LogLevel.None){this.privLogPath=void 0,this.privEnableConsoleOutput=!0,this.privLogLevelFilter=c}set logPath(c){h.Contracts.throwIfNullOrUndefined(a.openSync,`
File System access not available`),this.privLogPath=c}set enableConsoleOutput(c){this.privEnableConsoleOutput=c}onEvent(c){if(c.eventType>=this.privLogLevelFilter){const r=this.toString(c);if(this.logCallback&&this.logCallback(r),this.privLogPath&&a.writeFileSync(this.privLogPath,r+`
`,{flag:"a+"}),this.privEnableConsoleOutput)switch(c.eventType){case s.LogLevel.Debug:console.debug(r);break;case s.LogLevel.Info:console.info(r);break;case s.LogLevel.Warning:console.warn(r);break;case s.LogLevel.Error:console.error(r);break;default:console.log(r)}}}toString(c){const r=[`${c.eventTime}`,`${c.name}`],o=c;for(const d in o)if(d&&c.hasOwnProperty(d)&&d!=="eventTime"&&d!=="eventType"&&d!=="eventId"&&d!=="name"&&d!=="constructor"){const u=o[d];let v="<NULL>";u!=null&&(v=typeof u=="number"||typeof u=="string"?u.toString():JSON.stringify(u)),r.push(`${d}: ${v}`)}return r.join(" | ")}}},()=>{},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LogLevel=void 0;const p=t(4);Object.defineProperty(e,"LogLevel",{enumerable:!0,get:function(){return p.EventType}})},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Contracts=void 0;class t{static throwIfNullOrUndefined(n,i){if(n==null)throw new Error("throwIfNullOrUndefined:"+i)}static throwIfNull(n,i){if(n===null)throw new Error("throwIfNull:"+i)}static throwIfNullOrWhitespace(n,i){if(t.throwIfNullOrUndefined(n,i),(""+n).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+i)}static throwIfNullOrTooLong(n,i,a){if(t.throwIfNullOrUndefined(n,i),(""+n).length>a)throw new Error("throwIfNullOrTooLong:"+i+" (more than "+a.toString()+" characters)")}static throwIfNullOrTooShort(n,i,a){if(t.throwIfNullOrUndefined(n,i),(""+n).length<a)throw new Error("throwIfNullOrTooShort:"+i+" (less than "+a.toString()+" characters)")}static throwIfDisposed(n){if(n)throw new Error("the object is already disposed")}static throwIfArrayEmptyOrWhitespace(n,i){if(t.throwIfNullOrUndefined(n,i),n.length===0)throw new Error("throwIfArrayEmptyOrWhitespace:"+i);for(const a of n)t.throwIfNullOrWhitespace(a,i)}static throwIfFileDoesNotExist(n,i){t.throwIfNullOrWhitespace(n,i)}static throwIfNotUndefined(n,i){if(n!==void 0)throw new Error("throwIfNotUndefined:"+i)}}e.Contracts=t},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MicAudioSource=e.AudioWorkletSourceURLPropertyName=void 0;const p=t(2),n=t(4),i=t(67);e.AudioWorkletSourceURLPropertyName="MICROPHONE-WorkletSourceUrl";class a{constructor(h,c,r,o){this.privRecorder=h,this.deviceId=c,this.privStreams={},this.privOutputChunkSize=a.AUDIOFORMAT.avgBytesPerSec/10,this.privId=r||n.createNoDashGuid(),this.privEvents=new n.EventSource,this.privMediaStream=o||null,this.privIsClosing=!1}get format(){return Promise.resolve(a.AUDIOFORMAT)}turnOn(){if(this.privInitializeDeferral)return this.privInitializeDeferral.promise;this.privInitializeDeferral=new n.Deferred;try{this.createAudioContext()}catch(r){if(r instanceof Error){const o=r;this.privInitializeDeferral.reject(o.name+": "+o.message)}else this.privInitializeDeferral.reject(r);return this.privInitializeDeferral.promise}const h=window.navigator;let c=h.getUserMedia||h.webkitGetUserMedia||h.mozGetUserMedia||h.msGetUserMedia;if(h.mediaDevices&&(c=(r,o,d)=>{h.mediaDevices.getUserMedia(r).then(o).catch(d)}),c){const r=()=>{this.onEvent(new n.AudioSourceInitializingEvent(this.privId)),this.privMediaStream&&this.privMediaStream.active?(this.onEvent(new n.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()):c({audio:!this.deviceId||{deviceId:this.deviceId},video:!1},o=>{this.privMediaStream=o,this.onEvent(new n.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()},o=>{const d=`Error occurred during microphone initialization: ${o}`;this.privInitializeDeferral.reject(d),this.onEvent(new n.AudioSourceErrorEvent(this.privId,d))})};this.privContext.state==="suspended"?this.privContext.resume().then(r).catch(o=>{this.privInitializeDeferral.reject(`Failed to initialize audio context: ${o}`)}):r()}else{const r="Browser does not support getUserMedia.";this.privInitializeDeferral.reject(r),this.onEvent(new n.AudioSourceErrorEvent(r,""))}return this.privInitializeDeferral.promise}id(){return this.privId}attach(h){return this.onEvent(new n.AudioStreamNodeAttachingEvent(this.privId,h)),this.listen(h).then(c=>(this.onEvent(new n.AudioStreamNodeAttachedEvent(this.privId,h)),{detach:async()=>(c.readEnded(),delete this.privStreams[h],this.onEvent(new n.AudioStreamNodeDetachedEvent(this.privId,h)),this.turnOff()),id:()=>h,read:()=>c.read()}))}detach(h){h&&this.privStreams[h]&&(this.privStreams[h].close(),delete this.privStreams[h],this.onEvent(new n.AudioStreamNodeDetachedEvent(this.privId,h)))}async turnOff(){for(const h in this.privStreams)if(h){const c=this.privStreams[h];c&&c.close()}this.onEvent(new n.AudioSourceOffEvent(this.privId)),this.privInitializeDeferral&&(await this.privInitializeDeferral,this.privInitializeDeferral=null),await this.destroyAudioContext()}get events(){return this.privEvents}get deviceInfo(){return this.getMicrophoneLabel().then(h=>({bitspersample:a.AUDIOFORMAT.bitsPerSample,channelcount:a.AUDIOFORMAT.channels,connectivity:p.connectivity.Unknown,manufacturer:"Speech SDK",model:h,samplerate:a.AUDIOFORMAT.samplesPerSec,type:p.type.Microphones}))}setProperty(h,c){if(h!==e.AudioWorkletSourceURLPropertyName)throw new Error("Property '"+h+"' is not supported on Microphone.");this.privRecorder.setWorkletUrl(c)}getMicrophoneLabel(){const h="microphone";if(this.privMicrophoneLabel!==void 0)return Promise.resolve(this.privMicrophoneLabel);if(this.privMediaStream===void 0||!this.privMediaStream.active)return Promise.resolve(h);this.privMicrophoneLabel=h;const c=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(c===void 0)return Promise.resolve(this.privMicrophoneLabel);const r=new n.Deferred;return navigator.mediaDevices.enumerateDevices().then(o=>{for(const d of o)if(d.deviceId===c){this.privMicrophoneLabel=d.label;break}r.resolve(this.privMicrophoneLabel)},()=>r.resolve(this.privMicrophoneLabel)),r.promise}async listen(h){await this.turnOn();const c=new n.ChunkedArrayBufferStream(this.privOutputChunkSize,h);this.privStreams[h]=c;try{this.privRecorder.record(this.privContext,this.privMediaStream,c)}catch(r){throw this.onEvent(new n.AudioStreamNodeErrorEvent(this.privId,h,r)),r}return c}onEvent(h){this.privEvents.onEvent(h),n.Events.instance.onEvent(h)}createAudioContext(){this.privContext||(this.privContext=i.AudioStreamFormatImpl.getAudioContext(a.AUDIOFORMAT.samplesPerSec))}async destroyAudioContext(){if(!this.privContext)return;this.privRecorder.releaseMediaResources(this.privContext);let h=!1;"close"in this.privContext&&(h=!0),h?this.privIsClosing||(this.privIsClosing=!0,await this.privContext.close(),this.privContext=null,this.privIsClosing=!1):this.privContext!==null&&this.privContext.state==="running"&&await this.privContext.suspend()}}e.MicAudioSource=a,a.AUDIOFORMAT=i.AudioStreamFormat.getDefaultInputFormat()},(f,e)=>{"use strict";var t;Object.defineProperty(e,"__esModule",{value:!0}),e.AudioStreamFormatImpl=e.AudioStreamFormat=e.AudioFormatTag=void 0,function(i){i[i.PCM=1]="PCM",i[i.MuLaw=2]="MuLaw",i[i.Siren=3]="Siren",i[i.MP3=4]="MP3",i[i.SILKSkype=5]="SILKSkype",i[i.OGG_OPUS=6]="OGG_OPUS",i[i.WEBM_OPUS=7]="WEBM_OPUS",i[i.ALaw=8]="ALaw",i[i.FLAC=9]="FLAC",i[i.OPUS=10]="OPUS",i[i.AMR_WB=11]="AMR_WB",i[i.G722=12]="G722"}(t=e.AudioFormatTag||(e.AudioFormatTag={}));class p{static getDefaultInputFormat(){return n.getDefaultInputFormat()}static getWaveFormat(a,s,h,c){return new n(a,s,h,c)}static getWaveFormatPCM(a,s,h){return new n(a,s,h)}}e.AudioStreamFormat=p;class n extends p{constructor(a=16e3,s=16,h=1,c=t.PCM){super();let r=!0;switch(c){case t.PCM:this.formatTag=1;break;case t.ALaw:this.formatTag=6;break;case t.MuLaw:this.formatTag=7;break;default:r=!1}if(this.bitsPerSample=s,this.samplesPerSec=a,this.channels=h,this.avgBytesPerSec=this.samplesPerSec*this.channels*(this.bitsPerSample/8),this.blockAlign=this.channels*Math.max(this.bitsPerSample,8),r){this.privHeader=new ArrayBuffer(44);const o=new DataView(this.privHeader);this.setString(o,0,"RIFF"),o.setUint32(4,0,!0),this.setString(o,8,"WAVEfmt "),o.setUint32(16,16,!0),o.setUint16(20,this.formatTag,!0),o.setUint16(22,this.channels,!0),o.setUint32(24,this.samplesPerSec,!0),o.setUint32(28,this.avgBytesPerSec,!0),o.setUint16(32,this.channels*(this.bitsPerSample/8),!0),o.setUint16(34,this.bitsPerSample,!0),this.setString(o,36,"data"),o.setUint32(40,0,!0)}}static getDefaultInputFormat(){return new n}static getAudioContext(a){const s=window.AudioContext||window.webkitAudioContext||!1;if(s)return a!==void 0&&navigator.mediaDevices.getSupportedConstraints().sampleRate?new s({sampleRate:a}):new s;throw new Error("Browser does not support Web Audio API (AudioContext is not available).")}close(){}get header(){return this.privHeader}setString(a,s,h){for(let c=0;c<h.length;c++)a.setUint8(s+c,h.charCodeAt(c))}}e.AudioStreamFormatImpl=n},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FileAudioSource=void 0;const p=t(2),n=t(4),i=t(67);e.FileAudioSource=class{constructor(a,s,h){this.privStreams={},this.privHeaderEnd=44,this.privId=h||n.createNoDashGuid(),this.privEvents=new n.EventSource,this.privSource=a,typeof window<"u"&&typeof Blob<"u"&&this.privSource instanceof Blob?this.privFilename=a.name:this.privFilename=s||"unknown.wav",this.privAudioFormatPromise=this.readHeader()}get format(){return this.privAudioFormatPromise}turnOn(){if(this.privFilename.lastIndexOf(".wav")!==this.privFilename.length-4){const a=this.privFilename+" is not supported. Only WAVE files are allowed at the moment.";return this.onEvent(new n.AudioSourceErrorEvent(a,"")),Promise.reject(a)}this.onEvent(new n.AudioSourceInitializingEvent(this.privId)),this.onEvent(new n.AudioSourceReadyEvent(this.privId))}id(){return this.privId}async attach(a){this.onEvent(new n.AudioStreamNodeAttachingEvent(this.privId,a));const s=await this.upload(a);return this.onEvent(new n.AudioStreamNodeAttachedEvent(this.privId,a)),Promise.resolve({detach:async()=>{s.readEnded(),delete this.privStreams[a],this.onEvent(new n.AudioStreamNodeDetachedEvent(this.privId,a)),await this.turnOff()},id:()=>a,read:()=>s.read()})}detach(a){a&&this.privStreams[a]&&(this.privStreams[a].close(),delete this.privStreams[a],this.onEvent(new n.AudioStreamNodeDetachedEvent(this.privId,a)))}turnOff(){for(const a in this.privStreams)if(a){const s=this.privStreams[a];s&&!s.isClosed&&s.close()}return this.onEvent(new n.AudioSourceOffEvent(this.privId)),Promise.resolve()}get events(){return this.privEvents}get deviceInfo(){return this.privAudioFormatPromise.then(a=>Promise.resolve({bitspersample:a.bitsPerSample,channelcount:a.channels,connectivity:p.connectivity.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:a.samplesPerSec,type:p.type.File}))}readHeader(){const a=this.privSource.slice(0,4296),s=new n.Deferred,h=c=>{const r=new DataView(c),o=m=>String.fromCharCode(r.getUint8(m),r.getUint8(m+1),r.getUint8(m+2),r.getUint8(m+3));if(o(0)!=="RIFF")return void s.reject("Invalid WAV header in file, RIFF was not found");if(o(8)!=="WAVE"||o(12)!=="fmt ")return void s.reject("Invalid WAV header in file, WAVEfmt was not found");const d=r.getInt32(16,!0),u=r.getUint16(22,!0),v=r.getUint32(24,!0),l=r.getUint16(34,!0);let g=36+Math.max(d-16,0);for(;o(g)!=="data";g+=2)if(g>4288)return void s.reject("Invalid WAV header in file, data block was not found");this.privHeaderEnd=g+8,s.resolve(i.AudioStreamFormat.getWaveFormatPCM(v,l,u))};if(typeof window<"u"&&typeof Blob<"u"&&a instanceof Blob){const c=new FileReader;c.onload=r=>{const o=r.target.result;h(o)},c.readAsArrayBuffer(a)}else{const c=a;h(c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength))}return s.promise}async upload(a){const s=h=>{const c=`Error occurred while processing '${this.privFilename}'. ${h}`;throw this.onEvent(new n.AudioStreamNodeErrorEvent(this.privId,a,c)),new Error(c)};try{await this.turnOn();const h=await this.privAudioFormatPromise,c=new n.ChunkedArrayBufferStream(h.avgBytesPerSec/10,a);this.privStreams[a]=c;const r=this.privSource.slice(this.privHeaderEnd),o=d=>{c.isClosed||(c.writeStreamChunk({buffer:d,isEnd:!1,timeReceived:Date.now()}),c.close())};if(typeof window<"u"&&typeof Blob<"u"&&r instanceof Blob){const d=new FileReader;d.onerror=u=>s(u.toString()),d.onload=u=>{const v=u.target.result;o(v)},d.readAsArrayBuffer(r)}else{const d=r;o(d.buffer.slice(d.byteOffset,d.byteOffset+d.byteLength))}return c}catch(h){s(h)}}onEvent(a){this.privEvents.onEvent(a),n.Events.instance.onEvent(a)}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PcmRecorder=void 0;const p=t(4);e.PcmRecorder=class{constructor(n){this.privStopInputOnRelease=n}record(n,i,a){const s=new p.RiffPcmEncoder(n.sampleRate,16e3),h=n.createMediaStreamSource(i),c=()=>{const o=(()=>{let d=0;try{return n.createScriptProcessor(d,1,1)}catch{d=2048;let v=n.sampleRate;for(;d<16384&&v>=32e3;)d<<=1,v>>=1;return n.createScriptProcessor(d,1,1)}})();o.onaudioprocess=d=>{const u=d.inputBuffer.getChannelData(0);if(a&&!a.isClosed){const v=s.encode(u);v&&a.writeStreamChunk({buffer:v,isEnd:!1,timeReceived:Date.now()})}},h.connect(o),o.connect(n.destination),this.privMediaResources={scriptProcessorNode:o,source:h,stream:i}},r=!!this.privSpeechProcessorScript&&this.privSpeechProcessorScript.toLowerCase()==="ignore";if(n.audioWorklet&&!r){if(!this.privSpeechProcessorScript){const o=new Blob([`class SP extends AudioWorkletProcessor {
                    constructor(options) {
                      super(options);
                    }
                    process(inputs, outputs) {
                      const input = inputs[0];
                      const output = [];
                      for (let channel = 0; channel < input.length; channel += 1) {
                        output[channel] = input[channel];
                      }
                      this.port.postMessage(output[0]);
                      return true;
                    }
                  }
                  registerProcessor('speech-processor', SP);`],{type:"application/javascript; charset=utf-8"});this.privSpeechProcessorScript=URL.createObjectURL(o)}n.audioWorklet.addModule(this.privSpeechProcessorScript).then(()=>{const o=new AudioWorkletNode(n,"speech-processor");o.port.onmessage=d=>{const u=d.data;if(a&&!a.isClosed){const v=s.encode(u);v&&a.writeStreamChunk({buffer:v,isEnd:!1,timeReceived:Date.now()})}},h.connect(o),o.connect(n.destination),this.privMediaResources={scriptProcessorNode:o,source:h,stream:i}}).catch(()=>{c()})}else try{c()}catch(o){throw new Error(`Unable to start audio worklet node for PCMRecorder: ${o}`)}}releaseMediaResources(n){this.privMediaResources&&(this.privMediaResources.scriptProcessorNode&&(this.privMediaResources.scriptProcessorNode.disconnect(n.destination),this.privMediaResources.scriptProcessorNode=null),this.privMediaResources.source&&(this.privMediaResources.source.disconnect(),this.privStopInputOnRelease&&this.privMediaResources.stream.getTracks().forEach(i=>i.stop()),this.privMediaResources.source=null))}setWorkletUrl(n){this.privSpeechProcessorScript=n}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WebsocketConnection=void 0;const p=t(4),n=t(71);e.WebsocketConnection=class{constructor(i,a,s,h,c,r=!1,o){if(this.privIsDisposed=!1,!i)throw new p.ArgumentNullError("uri");if(!h)throw new p.ArgumentNullError("messageFormatter");this.privMessageFormatter=h;let d="",u=0;if(a){for(const v in a)if(v){d+=u===0&&i.indexOf("?")===-1?"?":"&",d+=encodeURIComponent(v);let l=a[v];l&&(l=encodeURIComponent(l),d+=`=${l}`),u++}}if(s)for(const v in s)v&&(d+=u===0&&i.indexOf("?")===-1?"?":"&",d+=`${v}=${encodeURIComponent(s[v])}`,u++);this.privUri=i+d,this.privId=o||p.createNoDashGuid(),this.privConnectionMessageAdapter=new n.WebsocketMessageAdapter(this.privUri,this.id,this.privMessageFormatter,c,s,r)}async dispose(){this.privIsDisposed=!0,this.privConnectionMessageAdapter&&await this.privConnectionMessageAdapter.close()}isDisposed(){return this.privIsDisposed}get id(){return this.privId}get uri(){return this.privUri}state(){return this.privConnectionMessageAdapter.state}open(){return this.privConnectionMessageAdapter.open()}send(i){return this.privConnectionMessageAdapter.send(i)}read(){return this.privConnectionMessageAdapter.read()}get events(){return this.privConnectionMessageAdapter.events}}},function(f,e,t){"use strict";var p=this&&this.__createBinding||(Object.create?function(l,g,m,S){S===void 0&&(S=m),Object.defineProperty(l,S,{enumerable:!0,get:function(){return g[m]}})}:function(l,g,m,S){S===void 0&&(S=m),l[S]=g[m]}),n=this&&this.__setModuleDefault||(Object.create?function(l,g){Object.defineProperty(l,"default",{enumerable:!0,value:g})}:function(l,g){l.default=g}),i=this&&this.__importStar||function(l){if(l&&l.__esModule)return l;var g={};if(l!=null)for(var m in l)m!=="default"&&Object.hasOwnProperty.call(l,m)&&p(g,l,m);return n(g,l),g},a=this&&this.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(e,"__esModule",{value:!0}),e.WebsocketMessageAdapter=void 0;const s=i(t(72)),h=i(t(73)),c=a(t(74)),r=a(t(75)),o=a(t(76)),d=t(54),u=t(4);class v{constructor(g,m,S,y,C,P){if(!g)throw new u.ArgumentNullError("uri");if(!S)throw new u.ArgumentNullError("messageFormatter");this.proxyInfo=y,this.privConnectionEvents=new u.EventSource,this.privConnectionId=m,this.privMessageFormatter=S,this.privConnectionState=u.ConnectionState.None,this.privUri=g,this.privHeaders=C,this.privEnableCompression=P,this.privHeaders[d.HeaderNames.ConnectionId]=this.privConnectionId,this.privLastErrorReceived=""}get state(){return this.privConnectionState}open(){if(this.privConnectionState===u.ConnectionState.Disconnected)return Promise.reject(`Cannot open a connection that is in ${this.privConnectionState} state`);if(this.privConnectionEstablishDeferral)return this.privConnectionEstablishDeferral.promise;this.privConnectionEstablishDeferral=new u.Deferred,this.privCertificateValidatedDeferral=new u.Deferred,this.privConnectionState=u.ConnectionState.Connecting;try{if(typeof WebSocket>"u"||v.forceNpmWebSocket){const g={headers:this.privHeaders,perMessageDeflate:this.privEnableCompression};this.privCertificateValidatedDeferral.resolve(),g.agent=this.getAgent();let m=new URL(this.privUri).protocol;m?.toLocaleLowerCase()==="wss:"?m="https:":m?.toLocaleLowerCase()==="ws:"&&(m="http:"),g.agent.protocol=m,this.privWebsocketClient=new o.default(this.privUri,g)}else this.privCertificateValidatedDeferral.resolve(),this.privWebsocketClient=new WebSocket(this.privUri);this.privWebsocketClient.binaryType="arraybuffer",this.privReceivingMessageQueue=new u.Queue,this.privDisconnectDeferral=new u.Deferred,this.privSendMessageQueue=new u.Queue,this.processSendQueue().catch(g=>{u.Events.instance.onEvent(new u.BackgroundEvent(g))})}catch(g){return this.privConnectionEstablishDeferral.resolve(new u.ConnectionOpenResponse(500,g)),this.privConnectionEstablishDeferral.promise}return this.onEvent(new u.ConnectionStartEvent(this.privConnectionId,this.privUri)),this.privWebsocketClient.onopen=()=>{this.privCertificateValidatedDeferral.promise.then(()=>{this.privConnectionState=u.ConnectionState.Connected,this.onEvent(new u.ConnectionEstablishedEvent(this.privConnectionId)),this.privConnectionEstablishDeferral.resolve(new u.ConnectionOpenResponse(200,""))},g=>{this.privConnectionEstablishDeferral.reject(g)})},this.privWebsocketClient.onerror=g=>{this.onEvent(new u.ConnectionErrorEvent(this.privConnectionId,g.message,g.type)),this.privLastErrorReceived=g.message},this.privWebsocketClient.onclose=g=>{this.privConnectionState===u.ConnectionState.Connecting?(this.privConnectionState=u.ConnectionState.Disconnected,this.privConnectionEstablishDeferral.resolve(new u.ConnectionOpenResponse(g.code,g.reason+" "+this.privLastErrorReceived))):(this.privConnectionState=u.ConnectionState.Disconnected,this.privWebsocketClient=null,this.onEvent(new u.ConnectionClosedEvent(this.privConnectionId,g.code,g.reason))),this.onClose(g.code,g.reason).catch(m=>{u.Events.instance.onEvent(new u.BackgroundEvent(m))})},this.privWebsocketClient.onmessage=g=>{const m=new Date().toISOString();if(this.privConnectionState===u.ConnectionState.Connected){const S=new u.Deferred;if(this.privReceivingMessageQueue.enqueueFromPromise(S.promise),g.data instanceof ArrayBuffer){const y=new u.RawWebsocketMessage(u.MessageType.Binary,g.data);this.privMessageFormatter.toConnectionMessage(y).then(C=>{this.onEvent(new u.ConnectionMessageReceivedEvent(this.privConnectionId,m,C)),S.resolve(C)},C=>{S.reject(`Invalid binary message format. Error: ${C}`)})}else{const y=new u.RawWebsocketMessage(u.MessageType.Text,g.data);this.privMessageFormatter.toConnectionMessage(y).then(C=>{this.onEvent(new u.ConnectionMessageReceivedEvent(this.privConnectionId,m,C)),S.resolve(C)},C=>{S.reject(`Invalid text message format. Error: ${C}`)})}}},this.privConnectionEstablishDeferral.promise}send(g){if(this.privConnectionState!==u.ConnectionState.Connected)return Promise.reject(`Cannot send on connection that is in ${u.ConnectionState[this.privConnectionState]} state`);const m=new u.Deferred,S=new u.Deferred;return this.privSendMessageQueue.enqueueFromPromise(S.promise),this.privMessageFormatter.fromConnectionMessage(g).then(y=>{S.resolve({Message:g,RawWebsocketMessage:y,sendStatusDeferral:m})},y=>{S.reject(`Error formatting the message. ${y}`)}),m.promise}read(){return this.privConnectionState!==u.ConnectionState.Connected?Promise.reject(`Cannot read on connection that is in ${this.privConnectionState} state`):this.privReceivingMessageQueue.dequeue()}close(g){return this.privWebsocketClient?(this.privConnectionState!==u.ConnectionState.Disconnected&&this.privWebsocketClient.close(1e3,g||"Normal closure by client"),this.privDisconnectDeferral.promise):Promise.resolve()}get events(){return this.privConnectionEvents}sendRawMessage(g){try{return g?(this.onEvent(new u.ConnectionMessageSentEvent(this.privConnectionId,new Date().toISOString(),g.Message)),this.isWebsocketOpen?(this.privWebsocketClient.send(g.RawWebsocketMessage.payload),Promise.resolve()):Promise.reject("websocket send error: Websocket not ready "+this.privConnectionId+" "+g.Message.id+" "+new Error().stack)):Promise.resolve()}catch(m){return Promise.reject(`websocket send error: ${m}`)}}async onClose(g,m){const S=`Connection closed. ${g}: ${m}`;this.privConnectionState=u.ConnectionState.Disconnected,this.privDisconnectDeferral.resolve(),await this.privReceivingMessageQueue.drainAndDispose(()=>{},S),await this.privSendMessageQueue.drainAndDispose(y=>{y.sendStatusDeferral.reject(S)},S)}async processSendQueue(){for(;;){const g=this.privSendMessageQueue.dequeue(),m=await g;if(!m)return;try{await this.sendRawMessage(m),m.sendStatusDeferral.resolve()}catch(S){m.sendStatusDeferral.reject(S)}}}onEvent(g){this.privConnectionEvents.onEvent(g),u.Events.instance.onEvent(g)}getAgent(){const g=new c.default.Agent(this.createConnection);return this.proxyInfo!==void 0&&this.proxyInfo.HostName!==void 0&&this.proxyInfo.Port>0&&(g.proxyInfo=this.proxyInfo),g}static GetProxyAgent(g){const m={host:g.HostName,port:g.Port};return g.UserName?m.headers={"Proxy-Authentication":"Basic "+new Buffer(`${g.UserName}:${g.Password===void 0?"":g.Password}`).toString("base64")}:m.headers={},m.headers.requestOCSP="true",new r.default(m)}createConnection(g,m){let S;if(m={...m,requestOCSP:!0,servername:m.host},this.proxyInfo){const y=v.GetProxyAgent(this.proxyInfo);S=new Promise((C,P)=>{y.callback(g,m,(R,I)=>{R?P(R):C(I)})})}else S=m.secureEndpoint?Promise.resolve(h.connect(m)):Promise.resolve(s.connect(m));return S}get isWebsocketOpen(){return this.privWebsocketClient&&this.privWebsocketClient.readyState===this.privWebsocketClient.OPEN}}e.WebsocketMessageAdapter=v,v.forceNpmWebSocket=!1},()=>{},()=>{},()=>{},()=>{},()=>{},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ReplayableAudioNode=void 0,e.ReplayableAudioNode=class{constructor(p,n){this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.privAudioNode=p,this.privBytesPerSecond=n}id(){return this.privAudioNode.id()}read(){if(this.privReplay&&this.privBuffers.length!==0){const p=this.privReplayOffset-this.privBufferStartOffset;let n=Math.round(p*this.privBytesPerSecond*1e-7);n%2!=0&&n++;let i=0;for(;i<this.privBuffers.length&&n>=this.privBuffers[i].chunk.buffer.byteLength;)n-=this.privBuffers[i++].chunk.buffer.byteLength;if(i<this.privBuffers.length){const a=this.privBuffers[i].chunk.buffer.slice(n);return this.privReplayOffset+=a.byteLength/this.privBytesPerSecond*1e7,i===this.privBuffers.length-1&&(this.privReplay=!1),Promise.resolve({buffer:a,isEnd:!1,timeReceived:this.privBuffers[i].chunk.timeReceived})}}return this.privAudioNode.read().then(p=>(p&&p.buffer&&(this.privBuffers.push(new t(p,this.privBufferSerial++,this.privBufferedBytes)),this.privBufferedBytes+=p.buffer.byteLength),p))}detach(){return this.privBuffers=void 0,this.privAudioNode.detach()}replay(){this.privBuffers&&this.privBuffers.length!==0&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)}shrinkBuffers(p){if(this.privBuffers===void 0||this.privBuffers.length===0)return;this.privLastShrinkOffset=p;const n=p-this.privBufferStartOffset;let i=Math.round(n*this.privBytesPerSecond*1e-7),a=0;for(;a<this.privBuffers.length&&i>=this.privBuffers[a].chunk.buffer.byteLength;)i-=this.privBuffers[a++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(p-i/this.privBytesPerSecond*1e7),this.privBuffers=this.privBuffers.slice(a)}findTimeAtOffset(p){if(p<this.privBufferStartOffset||this.privBuffers===void 0)return 0;for(const n of this.privBuffers){const i=n.byteOffset/this.privBytesPerSecond*1e7,a=i+n.chunk.buffer.byteLength/this.privBytesPerSecond*1e7;if(p>=i&&p<=a)return n.chunk.timeReceived}return 0}};class t{constructor(n,i,a){this.chunk=n,this.serial=i,this.byteOffset=a}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ProxyInfo=void 0;const p=t(79);class n{constructor(a,s,h,c){this.privProxyHostName=a,this.privProxyPort=s,this.privProxyUserName=h,this.privProxyPassword=c}static fromParameters(a){return new n(a.getProperty(p.PropertyId.SpeechServiceConnection_ProxyHostName),parseInt(a.getProperty(p.PropertyId.SpeechServiceConnection_ProxyPort),10),a.getProperty(p.PropertyId.SpeechServiceConnection_ProxyUserName),a.getProperty(p.PropertyId.SpeechServiceConnection_ProxyPassword))}static fromRecognizerConfig(a){return this.fromParameters(a.parameters)}get HostName(){return this.privProxyHostName}get Port(){return this.privProxyPort}get UserName(){return this.privProxyUserName}get Password(){return this.privProxyPassword}}e.ProxyInfo=n},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var p=t(80);Object.defineProperty(e,"AudioConfig",{enumerable:!0,get:function(){return p.AudioConfig}});var n=t(67);Object.defineProperty(e,"AudioStreamFormat",{enumerable:!0,get:function(){return n.AudioStreamFormat}}),Object.defineProperty(e,"AudioFormatTag",{enumerable:!0,get:function(){return n.AudioFormatTag}});var i=t(83);Object.defineProperty(e,"AudioInputStream",{enumerable:!0,get:function(){return i.AudioInputStream}}),Object.defineProperty(e,"PullAudioInputStream",{enumerable:!0,get:function(){return i.PullAudioInputStream}}),Object.defineProperty(e,"PushAudioInputStream",{enumerable:!0,get:function(){return i.PushAudioInputStream}});var a=t(84);Object.defineProperty(e,"AudioOutputStream",{enumerable:!0,get:function(){return a.AudioOutputStream}}),Object.defineProperty(e,"PullAudioOutputStream",{enumerable:!0,get:function(){return a.PullAudioOutputStream}}),Object.defineProperty(e,"PushAudioOutputStream",{enumerable:!0,get:function(){return a.PushAudioOutputStream}});var s=t(87);Object.defineProperty(e,"CancellationReason",{enumerable:!0,get:function(){return s.CancellationReason}});var h=t(88);Object.defineProperty(e,"PullAudioInputStreamCallback",{enumerable:!0,get:function(){return h.PullAudioInputStreamCallback}});var c=t(89);Object.defineProperty(e,"PushAudioOutputStreamCallback",{enumerable:!0,get:function(){return c.PushAudioOutputStreamCallback}});var r=t(90);Object.defineProperty(e,"KeywordRecognitionModel",{enumerable:!0,get:function(){return r.KeywordRecognitionModel}});var o=t(91);Object.defineProperty(e,"SessionEventArgs",{enumerable:!0,get:function(){return o.SessionEventArgs}});var d=t(92);Object.defineProperty(e,"RecognitionEventArgs",{enumerable:!0,get:function(){return d.RecognitionEventArgs}});var u=t(93);Object.defineProperty(e,"OutputFormat",{enumerable:!0,get:function(){return u.OutputFormat}});var v=t(94);Object.defineProperty(e,"IntentRecognitionEventArgs",{enumerable:!0,get:function(){return v.IntentRecognitionEventArgs}});var l=t(95);Object.defineProperty(e,"RecognitionResult",{enumerable:!0,get:function(){return l.RecognitionResult}});var g=t(96);Object.defineProperty(e,"SpeechRecognitionResult",{enumerable:!0,get:function(){return g.SpeechRecognitionResult}});var m=t(97);Object.defineProperty(e,"IntentRecognitionResult",{enumerable:!0,get:function(){return m.IntentRecognitionResult}});var S=t(98);Object.defineProperty(e,"LanguageUnderstandingModel",{enumerable:!0,get:function(){return S.LanguageUnderstandingModel}});var y=t(99);Object.defineProperty(e,"SpeechRecognitionEventArgs",{enumerable:!0,get:function(){return y.SpeechRecognitionEventArgs}}),Object.defineProperty(e,"ConversationTranscriptionEventArgs",{enumerable:!0,get:function(){return y.ConversationTranscriptionEventArgs}}),Object.defineProperty(e,"MeetingTranscriptionEventArgs",{enumerable:!0,get:function(){return y.MeetingTranscriptionEventArgs}});var C=t(100);Object.defineProperty(e,"SpeechRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return C.SpeechRecognitionCanceledEventArgs}});var P=t(102);Object.defineProperty(e,"TranslationRecognitionEventArgs",{enumerable:!0,get:function(){return P.TranslationRecognitionEventArgs}});var R=t(103);Object.defineProperty(e,"TranslationSynthesisEventArgs",{enumerable:!0,get:function(){return R.TranslationSynthesisEventArgs}});var I=t(104);Object.defineProperty(e,"TranslationRecognitionResult",{enumerable:!0,get:function(){return I.TranslationRecognitionResult}});var T=t(105);Object.defineProperty(e,"TranslationSynthesisResult",{enumerable:!0,get:function(){return T.TranslationSynthesisResult}});var w=t(106);Object.defineProperty(e,"ResultReason",{enumerable:!0,get:function(){return w.ResultReason}});var E=t(107);Object.defineProperty(e,"SpeechConfig",{enumerable:!0,get:function(){return E.SpeechConfig}}),Object.defineProperty(e,"SpeechConfigImpl",{enumerable:!0,get:function(){return E.SpeechConfigImpl}});var A=t(108);Object.defineProperty(e,"SpeechTranslationConfig",{enumerable:!0,get:function(){return A.SpeechTranslationConfig}}),Object.defineProperty(e,"SpeechTranslationConfigImpl",{enumerable:!0,get:function(){return A.SpeechTranslationConfigImpl}});var D=t(109);Object.defineProperty(e,"PropertyCollection",{enumerable:!0,get:function(){return D.PropertyCollection}});var N=t(110);Object.defineProperty(e,"PropertyId",{enumerable:!0,get:function(){return N.PropertyId}});var k=t(111);Object.defineProperty(e,"Recognizer",{enumerable:!0,get:function(){return k.Recognizer}});var O=t(112);Object.defineProperty(e,"SpeechRecognizer",{enumerable:!0,get:function(){return O.SpeechRecognizer}});var q=t(113);Object.defineProperty(e,"IntentRecognizer",{enumerable:!0,get:function(){return q.IntentRecognizer}});var U=t(114);Object.defineProperty(e,"VoiceProfileType",{enumerable:!0,get:function(){return U.VoiceProfileType}});var W=t(115);Object.defineProperty(e,"TranslationRecognizer",{enumerable:!0,get:function(){return W.TranslationRecognizer}});var H=t(118);Object.defineProperty(e,"Translations",{enumerable:!0,get:function(){return H.Translations}});var V=t(119);Object.defineProperty(e,"NoMatchReason",{enumerable:!0,get:function(){return V.NoMatchReason}});var K=t(120);Object.defineProperty(e,"NoMatchDetails",{enumerable:!0,get:function(){return K.NoMatchDetails}});var J=t(121);Object.defineProperty(e,"TranslationRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return J.TranslationRecognitionCanceledEventArgs}});var G=t(122);Object.defineProperty(e,"IntentRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return G.IntentRecognitionCanceledEventArgs}});var $=t(123);Object.defineProperty(e,"CancellationDetailsBase",{enumerable:!0,get:function(){return $.CancellationDetailsBase}});var Q=t(124);Object.defineProperty(e,"CancellationDetails",{enumerable:!0,get:function(){return Q.CancellationDetails}});var X=t(125);Object.defineProperty(e,"CancellationErrorCode",{enumerable:!0,get:function(){return X.CancellationErrorCode}});var Z=t(126);Object.defineProperty(e,"ConnectionEventArgs",{enumerable:!0,get:function(){return Z.ConnectionEventArgs}});var Y=t(127);Object.defineProperty(e,"ServiceEventArgs",{enumerable:!0,get:function(){return Y.ServiceEventArgs}});var ee=t(116);Object.defineProperty(e,"Connection",{enumerable:!0,get:function(){return ee.Connection}});var te=t(128);Object.defineProperty(e,"PhraseListGrammar",{enumerable:!0,get:function(){return te.PhraseListGrammar}});var ie=t(129);Object.defineProperty(e,"DialogServiceConfig",{enumerable:!0,get:function(){return ie.DialogServiceConfig}});var re=t(130);Object.defineProperty(e,"BotFrameworkConfig",{enumerable:!0,get:function(){return re.BotFrameworkConfig}});var ne=t(131);Object.defineProperty(e,"CustomCommandsConfig",{enumerable:!0,get:function(){return ne.CustomCommandsConfig}});var se=t(132);Object.defineProperty(e,"DialogServiceConnector",{enumerable:!0,get:function(){return se.DialogServiceConnector}});var oe=t(136);Object.defineProperty(e,"ActivityReceivedEventArgs",{enumerable:!0,get:function(){return oe.ActivityReceivedEventArgs}});var ae=t(137);Object.defineProperty(e,"TurnStatusReceivedEventArgs",{enumerable:!0,get:function(){return ae.TurnStatusReceivedEventArgs}});var ce=t(139);Object.defineProperty(e,"ServicePropertyChannel",{enumerable:!0,get:function(){return ce.ServicePropertyChannel}});var pe=t(140);Object.defineProperty(e,"ProfanityOption",{enumerable:!0,get:function(){return pe.ProfanityOption}});var he=t(141);Object.defineProperty(e,"BaseAudioPlayer",{enumerable:!0,get:function(){return he.BaseAudioPlayer}});var ue=t(142);Object.defineProperty(e,"ConnectionMessageEventArgs",{enumerable:!0,get:function(){return ue.ConnectionMessageEventArgs}});var de=t(117);Object.defineProperty(e,"ConnectionMessage",{enumerable:!0,get:function(){return de.ConnectionMessage}});var ve=t(143);Object.defineProperty(e,"VoiceProfile",{enumerable:!0,get:function(){return ve.VoiceProfile}});var L=t(144);Object.defineProperty(e,"VoiceProfileEnrollmentResult",{enumerable:!0,get:function(){return L.VoiceProfileEnrollmentResult}}),Object.defineProperty(e,"VoiceProfileEnrollmentCancellationDetails",{enumerable:!0,get:function(){return L.VoiceProfileEnrollmentCancellationDetails}});var x=t(145);Object.defineProperty(e,"VoiceProfileResult",{enumerable:!0,get:function(){return x.VoiceProfileResult}}),Object.defineProperty(e,"VoiceProfileCancellationDetails",{enumerable:!0,get:function(){return x.VoiceProfileCancellationDetails}});var le=t(146);Object.defineProperty(e,"VoiceProfilePhraseResult",{enumerable:!0,get:function(){return le.VoiceProfilePhraseResult}});var ge=t(147);Object.defineProperty(e,"VoiceProfileClient",{enumerable:!0,get:function(){return ge.VoiceProfileClient}});var me=t(148);Object.defineProperty(e,"SpeakerRecognizer",{enumerable:!0,get:function(){return me.SpeakerRecognizer}});var fe=t(149);Object.defineProperty(e,"SpeakerIdentificationModel",{enumerable:!0,get:function(){return fe.SpeakerIdentificationModel}});var Se=t(150);Object.defineProperty(e,"SpeakerVerificationModel",{enumerable:!0,get:function(){return Se.SpeakerVerificationModel}});var ye=t(151);Object.defineProperty(e,"AutoDetectSourceLanguageConfig",{enumerable:!0,get:function(){return ye.AutoDetectSourceLanguageConfig}});var Ce=t(153);Object.defineProperty(e,"AutoDetectSourceLanguageResult",{enumerable:!0,get:function(){return Ce.AutoDetectSourceLanguageResult}});var Pe=t(154);Object.defineProperty(e,"SourceLanguageConfig",{enumerable:!0,get:function(){return Pe.SourceLanguageConfig}});var z=t(155);Object.defineProperty(e,"SpeakerRecognitionResult",{enumerable:!0,get:function(){return z.SpeakerRecognitionResult}}),Object.defineProperty(e,"SpeakerRecognitionResultType",{enumerable:!0,get:function(){return z.SpeakerRecognitionResultType}}),Object.defineProperty(e,"SpeakerRecognitionCancellationDetails",{enumerable:!0,get:function(){return z.SpeakerRecognitionCancellationDetails}});var b=t(156);Object.defineProperty(e,"Conversation",{enumerable:!0,get:function(){return b.Conversation}}),Object.defineProperty(e,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return b.ConversationExpirationEventArgs}}),Object.defineProperty(e,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return b.ConversationParticipantsChangedEventArgs}}),Object.defineProperty(e,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return b.ConversationTranslationCanceledEventArgs}}),Object.defineProperty(e,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return b.ConversationTranslationEventArgs}}),Object.defineProperty(e,"ConversationTranslationResult",{enumerable:!0,get:function(){return b.ConversationTranslationResult}}),Object.defineProperty(e,"ConversationTranslator",{enumerable:!0,get:function(){return b.ConversationTranslator}}),Object.defineProperty(e,"ConversationTranscriber",{enumerable:!0,get:function(){return b.ConversationTranscriber}}),Object.defineProperty(e,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return b.ConversationTranscriptionResult}}),Object.defineProperty(e,"Meeting",{enumerable:!0,get:function(){return b.Meeting}}),Object.defineProperty(e,"MeetingTranscriber",{enumerable:!0,get:function(){return b.MeetingTranscriber}}),Object.defineProperty(e,"Participant",{enumerable:!0,get:function(){return b.Participant}}),Object.defineProperty(e,"ParticipantChangedReason",{enumerable:!0,get:function(){return b.ParticipantChangedReason}}),Object.defineProperty(e,"User",{enumerable:!0,get:function(){return b.User}});var Re=t(174);Object.defineProperty(e,"Synthesizer",{enumerable:!0,get:function(){return Re.Synthesizer}});var Ie=t(86);Object.defineProperty(e,"SpeechSynthesisOutputFormat",{enumerable:!0,get:function(){return Ie.SpeechSynthesisOutputFormat}});var Te=t(175);Object.defineProperty(e,"SpeechSynthesizer",{enumerable:!0,get:function(){return Te.SpeechSynthesizer}});var we=t(176);Object.defineProperty(e,"SynthesisResult",{enumerable:!0,get:function(){return we.SynthesisResult}});var Ee=t(177);Object.defineProperty(e,"SpeechSynthesisResult",{enumerable:!0,get:function(){return Ee.SpeechSynthesisResult}});var Ae=t(178);Object.defineProperty(e,"SpeechSynthesisEventArgs",{enumerable:!0,get:function(){return Ae.SpeechSynthesisEventArgs}});var be=t(179);Object.defineProperty(e,"SpeechSynthesisWordBoundaryEventArgs",{enumerable:!0,get:function(){return be.SpeechSynthesisWordBoundaryEventArgs}});var Oe=t(180);Object.defineProperty(e,"SpeechSynthesisBookmarkEventArgs",{enumerable:!0,get:function(){return Oe.SpeechSynthesisBookmarkEventArgs}});var Me=t(181);Object.defineProperty(e,"SpeechSynthesisVisemeEventArgs",{enumerable:!0,get:function(){return Me.SpeechSynthesisVisemeEventArgs}});var De=t(182);Object.defineProperty(e,"SpeechSynthesisBoundaryType",{enumerable:!0,get:function(){return De.SpeechSynthesisBoundaryType}});var ke=t(183);Object.defineProperty(e,"SynthesisVoicesResult",{enumerable:!0,get:function(){return ke.SynthesisVoicesResult}});var Ne=t(184);Object.defineProperty(e,"VoiceInfo",{enumerable:!0,get:function(){return Ne.VoiceInfo}});var ze=t(185);Object.defineProperty(e,"SpeakerAudioDestination",{enumerable:!0,get:function(){return ze.SpeakerAudioDestination}});var _e=t(186);Object.defineProperty(e,"ConversationTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return _e.ConversationTranscriptionCanceledEventArgs}});var Le=t(187);Object.defineProperty(e,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return Le.MeetingTranscriptionCanceledEventArgs}});var xe=t(188);Object.defineProperty(e,"PronunciationAssessmentGradingSystem",{enumerable:!0,get:function(){return xe.PronunciationAssessmentGradingSystem}});var Fe=t(189);Object.defineProperty(e,"PronunciationAssessmentGranularity",{enumerable:!0,get:function(){return Fe.PronunciationAssessmentGranularity}});var Be=t(190);Object.defineProperty(e,"PronunciationAssessmentConfig",{enumerable:!0,get:function(){return Be.PronunciationAssessmentConfig}});var je=t(191);Object.defineProperty(e,"PronunciationAssessmentResult",{enumerable:!0,get:function(){return je.PronunciationAssessmentResult}});var qe=t(152);Object.defineProperty(e,"LanguageIdMode",{enumerable:!0,get:function(){return qe.LanguageIdMode}});var Ue=t(192);Object.defineProperty(e,"AvatarConfig",{enumerable:!0,get:function(){return Ue.AvatarConfig}});var We=t(193);Object.defineProperty(e,"AvatarEventArgs",{enumerable:!0,get:function(){return We.AvatarEventArgs}});var He=t(194);Object.defineProperty(e,"AvatarSynthesizer",{enumerable:!0,get:function(){return He.AvatarSynthesizer}});var F=t(196);Object.defineProperty(e,"AvatarVideoFormat",{enumerable:!0,get:function(){return F.AvatarVideoFormat}}),Object.defineProperty(e,"Coordinate",{enumerable:!0,get:function(){return F.Coordinate}});var Ve=t(197);Object.defineProperty(e,"AvatarWebRTCConnectionResult",{enumerable:!0,get:function(){return Ve.AvatarWebRTCConnectionResult}});var Ke=t(198);Object.defineProperty(e,"Diagnostics",{enumerable:!0,get:function(){return Ke.Diagnostics}});var Je=t(63);Object.defineProperty(e,"LogLevel",{enumerable:!0,get:function(){return Je.LogLevel}})},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AudioOutputConfigImpl=e.AudioConfigImpl=e.AudioConfig=void 0;const p=t(60),n=t(64),i=t(79),a=t(81),s=t(83),h=t(84);class c{static fromDefaultMicrophoneInput(){const u=new p.PcmRecorder(!0);return new r(new p.MicAudioSource(u))}static fromMicrophoneInput(u){const v=new p.PcmRecorder(!0);return new r(new p.MicAudioSource(v,u))}static fromWavFileInput(u,v="unnamedBuffer.wav"){return new r(new p.FileAudioSource(u,v))}static fromStreamInput(u){if(u instanceof i.PullAudioInputStreamCallback)return new r(new s.PullAudioInputStreamImpl(u));if(u instanceof i.AudioInputStream)return new r(u);if(typeof MediaStream<"u"&&u instanceof MediaStream){const v=new p.PcmRecorder(!1);return new r(new p.MicAudioSource(v,null,null,u))}throw new Error("Not Supported Type")}static fromDefaultSpeakerOutput(){return new o(new i.SpeakerAudioDestination)}static fromSpeakerOutput(u){if(u===void 0)return c.fromDefaultSpeakerOutput();if(u instanceof i.SpeakerAudioDestination)return new o(u);throw new Error("Not Supported Type")}static fromAudioFileOutput(u){return new o(new a.AudioFileWriter(u))}static fromStreamOutput(u){if(u instanceof i.PushAudioOutputStreamCallback)return new o(new h.PushAudioOutputStreamImpl(u));if(u instanceof i.PushAudioOutputStream)return new o(u);if(u instanceof i.PullAudioOutputStream)return new o(u);throw new Error("Not Supported Type")}}e.AudioConfig=c;class r extends c{constructor(u){super(),this.privSource=u}get format(){return this.privSource.format}close(u,v){this.privSource.turnOff().then(()=>{u&&u()},l=>{v&&v(l)})}id(){return this.privSource.id()}turnOn(){return this.privSource.turnOn()}attach(u){return this.privSource.attach(u)}detach(u){return this.privSource.detach(u)}turnOff(){return this.privSource.turnOff()}get events(){return this.privSource.events}setProperty(u,v){if(n.Contracts.throwIfNull(v,"value"),this.privSource.setProperty===void 0)throw new Error("This AudioConfig instance does not support setting properties.");this.privSource.setProperty(u,v)}getProperty(u,v){if(this.privSource.getProperty!==void 0)return this.privSource.getProperty(u,v);throw new Error("This AudioConfig instance does not support getting properties.")}get deviceInfo(){return this.privSource.deviceInfo}}e.AudioConfigImpl=r;class o extends c{constructor(u){super(),this.privDestination=u}set format(u){this.privDestination.format=u}write(u){this.privDestination.write(u)}close(){this.privDestination.close()}id(){return this.privDestination.id()}setProperty(){throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(){throw new Error("This AudioConfig instance does not support getting properties.")}}e.AudioOutputConfigImpl=o},function(f,e,t){"use strict";var p=this&&this.__createBinding||(Object.create?function(h,c,r,o){o===void 0&&(o=r),Object.defineProperty(h,o,{enumerable:!0,get:function(){return c[r]}})}:function(h,c,r,o){o===void 0&&(o=r),h[o]=c[r]}),n=this&&this.__setModuleDefault||(Object.create?function(h,c){Object.defineProperty(h,"default",{enumerable:!0,value:c})}:function(h,c){h.default=c}),i=this&&this.__importStar||function(h){if(h&&h.__esModule)return h;var c={};if(h!=null)for(var r in h)r!=="default"&&Object.hasOwnProperty.call(h,r)&&p(c,h,r);return n(c,h),c};Object.defineProperty(e,"__esModule",{value:!0}),e.AudioFileWriter=void 0;const a=i(t(82)),s=t(64);e.AudioFileWriter=class{constructor(h){s.Contracts.throwIfNullOrUndefined(a.openSync,`
File System access not available, please use Push or PullAudioOutputStream`),this.privFd=a.openSync(h,"w")}set format(h){s.Contracts.throwIfNotUndefined(this.privAudioFormat,"format is already set"),this.privAudioFormat=h;let c=0;this.privAudioFormat.hasHeader&&(c=this.privAudioFormat.header.byteLength),this.privFd!==void 0&&(this.privWriteStream=a.createWriteStream("",{fd:this.privFd,start:c,autoClose:!1}))}write(h){s.Contracts.throwIfNullOrUndefined(this.privAudioFormat,"must set format before writing."),this.privWriteStream!==void 0&&this.privWriteStream.write(new Uint8Array(h.slice(0)))}close(){this.privFd!==void 0&&(this.privWriteStream.on("finish",()=>{this.privAudioFormat.hasHeader&&(this.privAudioFormat.updateHeader(this.privWriteStream.bytesWritten),a.writeSync(this.privFd,new Int8Array(this.privAudioFormat.header),0,this.privAudioFormat.header.byteLength,0)),a.closeSync(this.privFd),this.privFd=void 0}),this.privWriteStream.end())}id(){return this.privId}}},()=>{},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PullAudioInputStreamImpl=e.PullAudioInputStream=e.PushAudioInputStreamImpl=e.PushAudioInputStream=e.AudioInputStream=void 0;const p=t(2),n=t(4),i=t(7),a=t(79),s=t(67);class h{constructor(){}static createPushStream(v){return c.create(v)}static createPullStream(v,l){return o.create(v,l)}}e.AudioInputStream=h;class c extends h{static create(v){return new r(v)}}e.PushAudioInputStream=c;class r extends c{constructor(v){super(),this.privFormat=v===void 0?s.AudioStreamFormatImpl.getDefaultInputFormat():v,this.privEvents=new n.EventSource,this.privId=i.createNoDashGuid(),this.privStream=new n.ChunkedArrayBufferStream(this.privFormat.avgBytesPerSec/10)}get format(){return Promise.resolve(this.privFormat)}write(v){this.privStream.writeStreamChunk({buffer:v,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}id(){return this.privId}turnOn(){this.onEvent(new n.AudioSourceInitializingEvent(this.privId)),this.onEvent(new n.AudioSourceReadyEvent(this.privId))}async attach(v){this.onEvent(new n.AudioStreamNodeAttachingEvent(this.privId,v)),await this.turnOn();const l=this.privStream;return this.onEvent(new n.AudioStreamNodeAttachedEvent(this.privId,v)),{detach:async()=>(this.onEvent(new n.AudioStreamNodeDetachedEvent(this.privId,v)),this.turnOff()),id:()=>v,read:()=>l.read()}}detach(v){this.onEvent(new n.AudioStreamNodeDetachedEvent(this.privId,v))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:p.connectivity.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:p.type.Stream})}onEvent(v){this.privEvents.onEvent(v),n.Events.instance.onEvent(v)}toBuffer(v){const l=Buffer.alloc(v.byteLength),g=new Uint8Array(v);for(let m=0;m<l.length;++m)l[m]=g[m];return l}}e.PushAudioInputStreamImpl=r;class o extends h{constructor(){super()}static create(v,l){return new d(v,l)}}e.PullAudioInputStream=o;class d extends o{constructor(v,l){super(),this.privFormat=l===void 0?a.AudioStreamFormat.getDefaultInputFormat():l,this.privEvents=new n.EventSource,this.privId=i.createNoDashGuid(),this.privCallback=v,this.privIsClosed=!1,this.privBufferSize=this.privFormat.avgBytesPerSec/10}get format(){return Promise.resolve(this.privFormat)}close(){this.privIsClosed=!0,this.privCallback.close()}id(){return this.privId}turnOn(){this.onEvent(new n.AudioSourceInitializingEvent(this.privId)),this.onEvent(new n.AudioSourceReadyEvent(this.privId))}async attach(v){return this.onEvent(new n.AudioStreamNodeAttachingEvent(this.privId,v)),await this.turnOn(),this.onEvent(new n.AudioStreamNodeAttachedEvent(this.privId,v)),{detach:()=>(this.privCallback.close(),this.onEvent(new n.AudioStreamNodeDetachedEvent(this.privId,v)),this.turnOff()),id:()=>v,read:()=>{let l,g=0;for(;g<this.privBufferSize;){const m=new ArrayBuffer(this.privBufferSize-g),S=this.privCallback.read(m);if(l===void 0?l=m:new Int8Array(l).set(new Int8Array(m),g),S===0)break;g+=S}return Promise.resolve({buffer:l.slice(0,g),isEnd:this.privIsClosed||g===0,timeReceived:Date.now()})}}}detach(v){this.onEvent(new n.AudioStreamNodeDetachedEvent(this.privId,v))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:p.connectivity.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:p.type.Stream})}onEvent(v){this.privEvents.onEvent(v),n.Events.instance.onEvent(v)}}e.PullAudioInputStreamImpl=d},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PushAudioOutputStreamImpl=e.PushAudioOutputStream=e.PullAudioOutputStreamImpl=e.PullAudioOutputStream=e.AudioOutputStream=void 0;const p=t(4),n=t(64),i=t(85);class a{constructor(){}static createPullStream(){return s.create()}}e.AudioOutputStream=a;class s extends a{static create(){return new h}}e.PullAudioOutputStream=s;class h extends s{constructor(){super(),this.privId=p.createNoDashGuid(),this.privStream=new p.Stream}set format(d){d==null&&(this.privFormat=i.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privFormat=d}get format(){return this.privFormat}get isClosed(){return this.privStream.isClosed}id(){return this.privId}async read(d){const u=new Int8Array(d);let v=0;if(this.privLastChunkView!==void 0){if(this.privLastChunkView.length>d.byteLength)return u.set(this.privLastChunkView.slice(0,d.byteLength)),this.privLastChunkView=this.privLastChunkView.slice(d.byteLength),Promise.resolve(d.byteLength);u.set(this.privLastChunkView),v=this.privLastChunkView.length,this.privLastChunkView=void 0}for(;v<d.byteLength&&!this.privStream.isReadEnded;){const l=await this.privStream.read();if(l===void 0||l.isEnd)this.privStream.readEnded();else{let g;l.buffer.byteLength>d.byteLength-v?(g=l.buffer.slice(0,d.byteLength-v),this.privLastChunkView=new Int8Array(l.buffer.slice(d.byteLength-v))):g=l.buffer,u.set(new Int8Array(g),v),v+=g.byteLength}}return v}write(d){n.Contracts.throwIfNullOrUndefined(this.privStream,"must set format before writing"),this.privStream.writeStreamChunk({buffer:d,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}}e.PullAudioOutputStreamImpl=h;class c extends a{constructor(){super()}static create(d){return new r(d)}}e.PushAudioOutputStream=c;class r extends c{constructor(d){super(),this.privId=p.createNoDashGuid(),this.privCallback=d}set format(d){}write(d){this.privCallback.write&&this.privCallback.write(d)}close(){this.privCallback.close&&this.privCallback.close()}id(){return this.privId}}e.PushAudioOutputStreamImpl=r},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AudioOutputFormatImpl=void 0;const p=t(86),n=t(67);class i extends n.AudioStreamFormatImpl{constructor(s,h,c,r,o,d,u,v,l){super(c,d,h,s),this.formatTag=s,this.avgBytesPerSec=r,this.blockAlign=o,this.priAudioFormatString=u,this.priRequestAudioFormatString=v,this.priHasHeader=l}static fromSpeechSynthesisOutputFormat(s){return s===void 0?i.getDefaultOutputFormat():i.fromSpeechSynthesisOutputFormatString(i.SpeechSynthesisOutputFormatToString[s])}static fromSpeechSynthesisOutputFormatString(s){switch(s){case"raw-8khz-8bit-mono-mulaw":return new i(n.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,s,s,!1);case"riff-16khz-16kbps-mono-siren":return new i(n.AudioFormatTag.Siren,1,16e3,2e3,40,0,s,"audio-16khz-16kbps-mono-siren",!0);case"audio-16khz-16kbps-mono-siren":return new i(n.AudioFormatTag.Siren,1,16e3,2e3,40,0,s,s,!1);case"audio-16khz-32kbitrate-mono-mp3":return new i(n.AudioFormatTag.MP3,1,16e3,4096,2,16,s,s,!1);case"audio-16khz-128kbitrate-mono-mp3":return new i(n.AudioFormatTag.MP3,1,16e3,16384,2,16,s,s,!1);case"audio-16khz-64kbitrate-mono-mp3":return new i(n.AudioFormatTag.MP3,1,16e3,8192,2,16,s,s,!1);case"audio-24khz-48kbitrate-mono-mp3":return new i(n.AudioFormatTag.MP3,1,24e3,6144,2,16,s,s,!1);case"audio-24khz-96kbitrate-mono-mp3":return new i(n.AudioFormatTag.MP3,1,24e3,12288,2,16,s,s,!1);case"audio-24khz-160kbitrate-mono-mp3":return new i(n.AudioFormatTag.MP3,1,24e3,20480,2,16,s,s,!1);case"raw-16khz-16bit-mono-truesilk":return new i(n.AudioFormatTag.SILKSkype,1,16e3,32e3,2,16,s,s,!1);case"riff-8khz-16bit-mono-pcm":return new i(n.AudioFormatTag.PCM,1,8e3,16e3,2,16,s,"raw-8khz-16bit-mono-pcm",!0);case"riff-24khz-16bit-mono-pcm":return new i(n.AudioFormatTag.PCM,1,24e3,48e3,2,16,s,"raw-24khz-16bit-mono-pcm",!0);case"riff-8khz-8bit-mono-mulaw":return new i(n.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,s,"raw-8khz-8bit-mono-mulaw",!0);case"raw-16khz-16bit-mono-pcm":return new i(n.AudioFormatTag.PCM,1,16e3,32e3,2,16,s,"raw-16khz-16bit-mono-pcm",!1);case"raw-24khz-16bit-mono-pcm":return new i(n.AudioFormatTag.PCM,1,24e3,48e3,2,16,s,"raw-24khz-16bit-mono-pcm",!1);case"raw-8khz-16bit-mono-pcm":return new i(n.AudioFormatTag.PCM,1,8e3,16e3,2,16,s,"raw-8khz-16bit-mono-pcm",!1);case"ogg-16khz-16bit-mono-opus":return new i(n.AudioFormatTag.OGG_OPUS,1,16e3,8192,2,16,s,s,!1);case"ogg-24khz-16bit-mono-opus":return new i(n.AudioFormatTag.OGG_OPUS,1,24e3,8192,2,16,s,s,!1);case"raw-48khz-16bit-mono-pcm":return new i(n.AudioFormatTag.PCM,1,48e3,96e3,2,16,s,"raw-48khz-16bit-mono-pcm",!1);case"riff-48khz-16bit-mono-pcm":return new i(n.AudioFormatTag.PCM,1,48e3,96e3,2,16,s,"raw-48khz-16bit-mono-pcm",!0);case"audio-48khz-96kbitrate-mono-mp3":return new i(n.AudioFormatTag.MP3,1,48e3,12288,2,16,s,s,!1);case"audio-48khz-192kbitrate-mono-mp3":return new i(n.AudioFormatTag.MP3,1,48e3,24576,2,16,s,s,!1);case"ogg-48khz-16bit-mono-opus":return new i(n.AudioFormatTag.OGG_OPUS,1,48e3,12e3,2,16,s,s,!1);case"webm-16khz-16bit-mono-opus":return new i(n.AudioFormatTag.WEBM_OPUS,1,16e3,4e3,2,16,s,s,!1);case"webm-24khz-16bit-mono-opus":return new i(n.AudioFormatTag.WEBM_OPUS,1,24e3,6e3,2,16,s,s,!1);case"webm-24khz-16bit-24kbps-mono-opus":return new i(n.AudioFormatTag.WEBM_OPUS,1,24e3,3e3,2,16,s,s,!1);case"audio-16khz-16bit-32kbps-mono-opus":return new i(n.AudioFormatTag.OPUS,1,16e3,4e3,2,16,s,s,!1);case"audio-24khz-16bit-48kbps-mono-opus":return new i(n.AudioFormatTag.OPUS,1,24e3,6e3,2,16,s,s,!1);case"audio-24khz-16bit-24kbps-mono-opus":return new i(n.AudioFormatTag.OPUS,1,24e3,3e3,2,16,s,s,!1);case"audio-24khz-16bit-mono-flac":return new i(n.AudioFormatTag.FLAC,1,24e3,24e3,2,16,s,s,!1);case"audio-48khz-16bit-mono-flac":return new i(n.AudioFormatTag.FLAC,1,48e3,3e4,2,16,s,s,!1);case"raw-24khz-16bit-mono-truesilk":return new i(n.AudioFormatTag.SILKSkype,1,24e3,48e3,2,16,s,s,!1);case"raw-8khz-8bit-mono-alaw":return new i(n.AudioFormatTag.ALaw,1,8e3,8e3,1,8,s,s,!1);case"riff-8khz-8bit-mono-alaw":return new i(n.AudioFormatTag.ALaw,1,8e3,8e3,1,8,s,"raw-8khz-8bit-mono-alaw",!0);case"raw-22050hz-16bit-mono-pcm":return new i(n.AudioFormatTag.PCM,1,22050,44100,2,16,s,s,!1);case"riff-22050hz-16bit-mono-pcm":return new i(n.AudioFormatTag.PCM,1,22050,44100,2,16,s,"raw-22050hz-16bit-mono-pcm",!0);case"raw-44100hz-16bit-mono-pcm":return new i(n.AudioFormatTag.PCM,1,44100,88200,2,16,s,s,!1);case"riff-44100hz-16bit-mono-pcm":return new i(n.AudioFormatTag.PCM,1,44100,88200,2,16,s,"raw-44100hz-16bit-mono-pcm",!0);case"amr-wb-16000h":return new i(n.AudioFormatTag.AMR_WB,1,16e3,3052,2,16,s,s,!1);case"g722-16khz-64kbps":return new i(n.AudioFormatTag.G722,1,16e3,8e3,2,16,s,s,!1);default:return new i(n.AudioFormatTag.PCM,1,16e3,32e3,2,16,"riff-16khz-16bit-mono-pcm","raw-16khz-16bit-mono-pcm",!0)}}static getDefaultOutputFormat(){return i.fromSpeechSynthesisOutputFormatString(typeof window<"u"?"audio-24khz-48kbitrate-mono-mp3":"riff-16khz-16bit-mono-pcm")}get hasHeader(){return this.priHasHeader}get header(){if(this.hasHeader)return this.privHeader}updateHeader(s){if(this.priHasHeader){const h=new DataView(this.privHeader);h.setUint32(4,s+this.privHeader.byteLength-8,!0),h.setUint32(40,s,!0)}}get requestAudioFormatString(){return this.priRequestAudioFormatString}addHeader(s){if(!this.hasHeader)return s;this.updateHeader(s.byteLength);const h=new Uint8Array(s.byteLength+this.header.byteLength);return h.set(new Uint8Array(this.header),0),h.set(new Uint8Array(s),this.header.byteLength),h.buffer}}e.AudioOutputFormatImpl=i,i.SpeechSynthesisOutputFormatToString={[p.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoMULaw]:"raw-8khz-8bit-mono-mulaw",[p.SpeechSynthesisOutputFormat.Riff16Khz16KbpsMonoSiren]:"riff-16khz-16kbps-mono-siren",[p.SpeechSynthesisOutputFormat.Audio16Khz16KbpsMonoSiren]:"audio-16khz-16kbps-mono-siren",[p.SpeechSynthesisOutputFormat.Audio16Khz32KBitRateMonoMp3]:"audio-16khz-32kbitrate-mono-mp3",[p.SpeechSynthesisOutputFormat.Audio16Khz128KBitRateMonoMp3]:"audio-16khz-128kbitrate-mono-mp3",[p.SpeechSynthesisOutputFormat.Audio16Khz64KBitRateMonoMp3]:"audio-16khz-64kbitrate-mono-mp3",[p.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3]:"audio-24khz-48kbitrate-mono-mp3",[p.SpeechSynthesisOutputFormat.Audio24Khz96KBitRateMonoMp3]:"audio-24khz-96kbitrate-mono-mp3",[p.SpeechSynthesisOutputFormat.Audio24Khz160KBitRateMonoMp3]:"audio-24khz-160kbitrate-mono-mp3",[p.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoTrueSilk]:"raw-16khz-16bit-mono-truesilk",[p.SpeechSynthesisOutputFormat.Riff16Khz16BitMonoPcm]:"riff-16khz-16bit-mono-pcm",[p.SpeechSynthesisOutputFormat.Riff8Khz16BitMonoPcm]:"riff-8khz-16bit-mono-pcm",[p.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm]:"riff-24khz-16bit-mono-pcm",[p.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoMULaw]:"riff-8khz-8bit-mono-mulaw",[p.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoPcm]:"raw-16khz-16bit-mono-pcm",[p.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoPcm]:"raw-24khz-16bit-mono-pcm",[p.SpeechSynthesisOutputFormat.Raw8Khz16BitMonoPcm]:"raw-8khz-16bit-mono-pcm",[p.SpeechSynthesisOutputFormat.Ogg16Khz16BitMonoOpus]:"ogg-16khz-16bit-mono-opus",[p.SpeechSynthesisOutputFormat.Ogg24Khz16BitMonoOpus]:"ogg-24khz-16bit-mono-opus",[p.SpeechSynthesisOutputFormat.Raw48Khz16BitMonoPcm]:"raw-48khz-16bit-mono-pcm",[p.SpeechSynthesisOutputFormat.Riff48Khz16BitMonoPcm]:"riff-48khz-16bit-mono-pcm",[p.SpeechSynthesisOutputFormat.Audio48Khz96KBitRateMonoMp3]:"audio-48khz-96kbitrate-mono-mp3",[p.SpeechSynthesisOutputFormat.Audio48Khz192KBitRateMonoMp3]:"audio-48khz-192kbitrate-mono-mp3",[p.SpeechSynthesisOutputFormat.Ogg48Khz16BitMonoOpus]:"ogg-48khz-16bit-mono-opus",[p.SpeechSynthesisOutputFormat.Webm16Khz16BitMonoOpus]:"webm-16khz-16bit-mono-opus",[p.SpeechSynthesisOutputFormat.Webm24Khz16BitMonoOpus]:"webm-24khz-16bit-mono-opus",[p.SpeechSynthesisOutputFormat.Webm24Khz16Bit24KbpsMonoOpus]:"webm-24khz-16bit-24kbps-mono-opus",[p.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoTrueSilk]:"raw-24khz-16bit-mono-truesilk",[p.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoALaw]:"raw-8khz-8bit-mono-alaw",[p.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoALaw]:"riff-8khz-8bit-mono-alaw",[p.SpeechSynthesisOutputFormat.Audio16Khz16Bit32KbpsMonoOpus]:"audio-16khz-16bit-32kbps-mono-opus",[p.SpeechSynthesisOutputFormat.Audio24Khz16Bit48KbpsMonoOpus]:"audio-24khz-16bit-48kbps-mono-opus",[p.SpeechSynthesisOutputFormat.Audio24Khz16Bit24KbpsMonoOpus]:"audio-24khz-16bit-24kbps-mono-opus",[p.SpeechSynthesisOutputFormat.Raw22050Hz16BitMonoPcm]:"raw-22050hz-16bit-mono-pcm",[p.SpeechSynthesisOutputFormat.Riff22050Hz16BitMonoPcm]:"riff-22050hz-16bit-mono-pcm",[p.SpeechSynthesisOutputFormat.Raw44100Hz16BitMonoPcm]:"raw-44100hz-16bit-mono-pcm",[p.SpeechSynthesisOutputFormat.Riff44100Hz16BitMonoPcm]:"riff-44100hz-16bit-mono-pcm",[p.SpeechSynthesisOutputFormat.AmrWb16000Hz]:"amr-wb-16000hz",[p.SpeechSynthesisOutputFormat.G72216Khz64Kbps]:"g722-16khz-64kbps"}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechSynthesisOutputFormat=void 0,function(t){t[t.Raw8Khz8BitMonoMULaw=0]="Raw8Khz8BitMonoMULaw",t[t.Riff16Khz16KbpsMonoSiren=1]="Riff16Khz16KbpsMonoSiren",t[t.Audio16Khz16KbpsMonoSiren=2]="Audio16Khz16KbpsMonoSiren",t[t.Audio16Khz32KBitRateMonoMp3=3]="Audio16Khz32KBitRateMonoMp3",t[t.Audio16Khz128KBitRateMonoMp3=4]="Audio16Khz128KBitRateMonoMp3",t[t.Audio16Khz64KBitRateMonoMp3=5]="Audio16Khz64KBitRateMonoMp3",t[t.Audio24Khz48KBitRateMonoMp3=6]="Audio24Khz48KBitRateMonoMp3",t[t.Audio24Khz96KBitRateMonoMp3=7]="Audio24Khz96KBitRateMonoMp3",t[t.Audio24Khz160KBitRateMonoMp3=8]="Audio24Khz160KBitRateMonoMp3",t[t.Raw16Khz16BitMonoTrueSilk=9]="Raw16Khz16BitMonoTrueSilk",t[t.Riff16Khz16BitMonoPcm=10]="Riff16Khz16BitMonoPcm",t[t.Riff8Khz16BitMonoPcm=11]="Riff8Khz16BitMonoPcm",t[t.Riff24Khz16BitMonoPcm=12]="Riff24Khz16BitMonoPcm",t[t.Riff8Khz8BitMonoMULaw=13]="Riff8Khz8BitMonoMULaw",t[t.Raw16Khz16BitMonoPcm=14]="Raw16Khz16BitMonoPcm",t[t.Raw24Khz16BitMonoPcm=15]="Raw24Khz16BitMonoPcm",t[t.Raw8Khz16BitMonoPcm=16]="Raw8Khz16BitMonoPcm",t[t.Ogg16Khz16BitMonoOpus=17]="Ogg16Khz16BitMonoOpus",t[t.Ogg24Khz16BitMonoOpus=18]="Ogg24Khz16BitMonoOpus",t[t.Raw48Khz16BitMonoPcm=19]="Raw48Khz16BitMonoPcm",t[t.Riff48Khz16BitMonoPcm=20]="Riff48Khz16BitMonoPcm",t[t.Audio48Khz96KBitRateMonoMp3=21]="Audio48Khz96KBitRateMonoMp3",t[t.Audio48Khz192KBitRateMonoMp3=22]="Audio48Khz192KBitRateMonoMp3",t[t.Ogg48Khz16BitMonoOpus=23]="Ogg48Khz16BitMonoOpus",t[t.Webm16Khz16BitMonoOpus=24]="Webm16Khz16BitMonoOpus",t[t.Webm24Khz16BitMonoOpus=25]="Webm24Khz16BitMonoOpus",t[t.Raw24Khz16BitMonoTrueSilk=26]="Raw24Khz16BitMonoTrueSilk",t[t.Raw8Khz8BitMonoALaw=27]="Raw8Khz8BitMonoALaw",t[t.Riff8Khz8BitMonoALaw=28]="Riff8Khz8BitMonoALaw",t[t.Webm24Khz16Bit24KbpsMonoOpus=29]="Webm24Khz16Bit24KbpsMonoOpus",t[t.Audio16Khz16Bit32KbpsMonoOpus=30]="Audio16Khz16Bit32KbpsMonoOpus",t[t.Audio24Khz16Bit48KbpsMonoOpus=31]="Audio24Khz16Bit48KbpsMonoOpus",t[t.Audio24Khz16Bit24KbpsMonoOpus=32]="Audio24Khz16Bit24KbpsMonoOpus",t[t.Raw22050Hz16BitMonoPcm=33]="Raw22050Hz16BitMonoPcm",t[t.Riff22050Hz16BitMonoPcm=34]="Riff22050Hz16BitMonoPcm",t[t.Raw44100Hz16BitMonoPcm=35]="Raw44100Hz16BitMonoPcm",t[t.Riff44100Hz16BitMonoPcm=36]="Riff44100Hz16BitMonoPcm",t[t.AmrWb16000Hz=37]="AmrWb16000Hz",t[t.G72216Khz64Kbps=38]="G72216Khz64Kbps"}(e.SpeechSynthesisOutputFormat||(e.SpeechSynthesisOutputFormat={}))},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CancellationReason=void 0,function(t){t[t.Error=0]="Error",t[t.EndOfStream=1]="EndOfStream"}(e.CancellationReason||(e.CancellationReason={}))},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PullAudioInputStreamCallback=void 0,e.PullAudioInputStreamCallback=class{}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PushAudioOutputStreamCallback=void 0,e.PushAudioOutputStreamCallback=class{}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.KeywordRecognitionModel=void 0;const p=t(64);e.KeywordRecognitionModel=class{constructor(){this.privDisposed=!1}static fromFile(n){throw p.Contracts.throwIfFileDoesNotExist(n,"fileName"),new Error("Not yet implemented.")}static fromStream(n){throw p.Contracts.throwIfNull(n,"file"),new Error("Not yet implemented.")}close(){this.privDisposed||(this.privDisposed=!0)}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SessionEventArgs=void 0,e.SessionEventArgs=class{constructor(t){this.privSessionId=t}get sessionId(){return this.privSessionId}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RecognitionEventArgs=void 0;const p=t(79);class n extends p.SessionEventArgs{constructor(a,s){super(s),this.privOffset=a}get offset(){return this.privOffset}}e.RecognitionEventArgs=n},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.OutputFormat=void 0,function(t){t[t.Simple=0]="Simple",t[t.Detailed=1]="Detailed"}(e.OutputFormat||(e.OutputFormat={}))},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.IntentRecognitionEventArgs=void 0;const p=t(79);class n extends p.RecognitionEventArgs{constructor(a,s,h){super(s,h),this.privResult=a}get result(){return this.privResult}}e.IntentRecognitionEventArgs=n},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RecognitionResult=void 0,e.RecognitionResult=class{constructor(t,p,n,i,a,s,h,c,r,o){this.privResultId=t,this.privReason=p,this.privText=n,this.privDuration=i,this.privOffset=a,this.privLanguage=s,this.privLanguageDetectionConfidence=h,this.privErrorDetails=c,this.privJson=r,this.privProperties=o}get resultId(){return this.privResultId}get reason(){return this.privReason}get text(){return this.privText}get duration(){return this.privDuration}get offset(){return this.privOffset}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}get errorDetails(){return this.privErrorDetails}get json(){return this.privJson}get properties(){return this.privProperties}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechRecognitionResult=void 0;const p=t(79);class n extends p.RecognitionResult{constructor(a,s,h,c,r,o,d,u,v,l,g){super(a,s,h,c,r,o,d,v,l,g),this.privSpeakerId=u}get speakerId(){return this.privSpeakerId}}e.SpeechRecognitionResult=n},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.IntentRecognitionResult=void 0;const p=t(79);class n extends p.SpeechRecognitionResult{constructor(a,s,h,c,r,o,d,u,v,l,g){super(s,h,c,r,o,d,u,void 0,v,l,g),this.privIntentId=a}get intentId(){return this.privIntentId}}e.IntentRecognitionResult=n},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LanguageUnderstandingModelImpl=e.LanguageUnderstandingModel=void 0;const p=t(64);class n{constructor(){}static fromEndpoint(s){p.Contracts.throwIfNull(s,"uri"),p.Contracts.throwIfNullOrWhitespace(s.hostname,"uri");const h=new i,c=s.host.indexOf(".");if(c===-1)throw new Error("Could not determine region from endpoint");h.region=s.host.substr(0,c);const r=s.pathname.lastIndexOf("/")+1;if(r===-1)throw new Error("Could not determine appId from endpoint");if(h.appId=s.pathname.substr(r),h.subscriptionKey=s.searchParams.get("subscription-key"),h.subscriptionKey===void 0)throw new Error("Could not determine subscription key from endpoint");return h}static fromAppId(s){p.Contracts.throwIfNullOrWhitespace(s,"appId");const h=new i;return h.appId=s,h}static fromSubscription(s,h,c){p.Contracts.throwIfNullOrWhitespace(s,"subscriptionKey"),p.Contracts.throwIfNullOrWhitespace(h,"appId"),p.Contracts.throwIfNullOrWhitespace(c,"region");const r=new i;return r.appId=h,r.region=c,r.subscriptionKey=s,r}}e.LanguageUnderstandingModel=n;class i extends n{}e.LanguageUnderstandingModelImpl=i},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MeetingTranscriptionEventArgs=e.ConversationTranscriptionEventArgs=e.SpeechRecognitionEventArgs=void 0;const p=t(79);class n extends p.RecognitionEventArgs{constructor(s,h,c){super(h,c),this.privResult=s}get result(){return this.privResult}}e.SpeechRecognitionEventArgs=n;class i extends p.RecognitionEventArgs{constructor(s,h,c){super(h,c),this.privResult=s}get result(){return this.privResult}}e.ConversationTranscriptionEventArgs=i,e.MeetingTranscriptionEventArgs=class extends n{}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechRecognitionCanceledEventArgs=void 0;const p=t(101);class n extends p.CancellationEventArgsBase{}e.SpeechRecognitionCanceledEventArgs=n},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CancellationEventArgsBase=void 0;const p=t(79);class n extends p.RecognitionEventArgs{constructor(a,s,h,c,r){super(c,r),this.privReason=a,this.privErrorDetails=s,this.privErrorCode=h}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}}e.CancellationEventArgsBase=n},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TranslationRecognitionEventArgs=void 0;const p=t(79);class n extends p.RecognitionEventArgs{constructor(a,s,h){super(s,h),this.privResult=a}get result(){return this.privResult}}e.TranslationRecognitionEventArgs=n},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TranslationSynthesisEventArgs=void 0;const p=t(79);class n extends p.SessionEventArgs{constructor(a,s){super(s),this.privResult=a}get result(){return this.privResult}}e.TranslationSynthesisEventArgs=n},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TranslationRecognitionResult=void 0;const p=t(79);class n extends p.SpeechRecognitionResult{constructor(a,s,h,c,r,o,d,u,v,l,g){super(s,h,c,r,o,d,u,void 0,v,l,g),this.privTranslations=a}static fromSpeechRecognitionResult(a){return new n(void 0,a.resultId,a.reason,a.text,a.duration,a.offset,a.language,a.languageDetectionConfidence,a.errorDetails,a.json,a.properties)}get translations(){return this.privTranslations}}e.TranslationRecognitionResult=n},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TranslationSynthesisResult=void 0,e.TranslationSynthesisResult=class{constructor(t,p){this.privReason=t,this.privAudio=p}get audio(){return this.privAudio}get reason(){return this.privReason}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ResultReason=void 0,function(t){t[t.NoMatch=0]="NoMatch",t[t.Canceled=1]="Canceled",t[t.RecognizingSpeech=2]="RecognizingSpeech",t[t.RecognizedSpeech=3]="RecognizedSpeech",t[t.RecognizedKeyword=4]="RecognizedKeyword",t[t.RecognizingIntent=5]="RecognizingIntent",t[t.RecognizedIntent=6]="RecognizedIntent",t[t.TranslatingSpeech=7]="TranslatingSpeech",t[t.TranslatedSpeech=8]="TranslatedSpeech",t[t.SynthesizingAudio=9]="SynthesizingAudio",t[t.SynthesizingAudioCompleted=10]="SynthesizingAudioCompleted",t[t.SynthesizingAudioStarted=11]="SynthesizingAudioStarted",t[t.EnrollingVoiceProfile=12]="EnrollingVoiceProfile",t[t.EnrolledVoiceProfile=13]="EnrolledVoiceProfile",t[t.RecognizedSpeakers=14]="RecognizedSpeakers",t[t.RecognizedSpeaker=15]="RecognizedSpeaker",t[t.ResetVoiceProfile=16]="ResetVoiceProfile",t[t.DeletedVoiceProfile=17]="DeletedVoiceProfile",t[t.VoicesListRetrieved=18]="VoicesListRetrieved",t[t.TranslatingParticipantSpeech=19]="TranslatingParticipantSpeech",t[t.TranslatedParticipantSpeech=20]="TranslatedParticipantSpeech",t[t.TranslatedInstantMessage=21]="TranslatedInstantMessage",t[t.TranslatedParticipantInstantMessage=22]="TranslatedParticipantInstantMessage"}(e.ResultReason||(e.ResultReason={}))},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechConfigImpl=e.SpeechConfig=void 0;const p=t(2),n=t(64),i=t(79);class a{constructor(){}static fromSubscription(c,r){n.Contracts.throwIfNullOrWhitespace(c,"subscriptionKey"),n.Contracts.throwIfNullOrWhitespace(r,"region");const o=new s;return o.setProperty(i.PropertyId.SpeechServiceConnection_Region,r),o.setProperty(i.PropertyId.SpeechServiceConnection_IntentRegion,r),o.setProperty(i.PropertyId.SpeechServiceConnection_Key,c),o}static fromEndpoint(c,r){n.Contracts.throwIfNull(c,"endpoint");const o=new s;return o.setProperty(i.PropertyId.SpeechServiceConnection_Endpoint,c.href),r!==void 0&&o.setProperty(i.PropertyId.SpeechServiceConnection_Key,r),o}static fromHost(c,r){n.Contracts.throwIfNull(c,"hostName");const o=new s;return o.setProperty(i.PropertyId.SpeechServiceConnection_Host,c.protocol+"//"+c.hostname+(c.port===""?"":":"+c.port)),r!==void 0&&o.setProperty(i.PropertyId.SpeechServiceConnection_Key,r),o}static fromAuthorizationToken(c,r){n.Contracts.throwIfNull(c,"authorizationToken"),n.Contracts.throwIfNullOrWhitespace(r,"region");const o=new s;return o.setProperty(i.PropertyId.SpeechServiceConnection_Region,r),o.setProperty(i.PropertyId.SpeechServiceConnection_IntentRegion,r),o.authorizationToken=c,o}close(){}}e.SpeechConfig=a;class s extends a{constructor(){super(),this.privProperties=new i.PropertyCollection,this.speechRecognitionLanguage="en-US",this.outputFormat=i.OutputFormat.Simple}get properties(){return this.privProperties}get endPoint(){return new URL(this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_Endpoint))}get subscriptionKey(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_Key)}get region(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_Region)}get authorizationToken(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(c){this.privProperties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,c)}get speechRecognitionLanguage(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage)}set speechRecognitionLanguage(c){this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage,c)}get autoDetectSourceLanguages(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)}set autoDetectSourceLanguages(c){this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,c)}get outputFormat(){return i.OutputFormat[this.privProperties.getProperty(p.OutputFormatPropertyName,void 0)]}set outputFormat(c){this.privProperties.setProperty(p.OutputFormatPropertyName,i.OutputFormat[c])}get endpointId(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(c){this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_EndpointId,c)}setProperty(c,r){n.Contracts.throwIfNull(r,"value"),this.privProperties.setProperty(c,r)}getProperty(c,r){return this.privProperties.getProperty(c,r)}setProxy(c,r,o,d){this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyHostName],c),this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyPort],r),this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyUserName],o),this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyPassword],d)}setServiceProperty(c,r){const o=JSON.parse(this.privProperties.getProperty(p.ServicePropertiesPropertyName,"{}"));o[c]=r,this.privProperties.setProperty(p.ServicePropertiesPropertyName,JSON.stringify(o))}setProfanity(c){this.privProperties.setProperty(i.PropertyId.SpeechServiceResponse_ProfanityOption,i.ProfanityOption[c])}enableAudioLogging(){this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privProperties.setProperty(i.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privProperties.setProperty(p.ForceDictationPropertyName,"true")}clone(){const c=new s;return c.privProperties=this.privProperties.clone(),c}get speechSynthesisLanguage(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(c){this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_SynthLanguage,c)}get speechSynthesisVoiceName(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(c){this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_SynthVoice,c)}get speechSynthesisOutputFormat(){return i.SpeechSynthesisOutputFormat[this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(c){this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_SynthOutputFormat,i.SpeechSynthesisOutputFormat[c])}}e.SpeechConfigImpl=s},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechTranslationConfigImpl=e.SpeechTranslationConfig=void 0;const p=t(2),n=t(64),i=t(79);class a extends i.SpeechConfig{constructor(){super()}static fromSubscription(c,r){n.Contracts.throwIfNullOrWhitespace(c,"subscriptionKey"),n.Contracts.throwIfNullOrWhitespace(r,"region");const o=new s;return o.properties.setProperty(i.PropertyId.SpeechServiceConnection_Key,c),o.properties.setProperty(i.PropertyId.SpeechServiceConnection_Region,r),o}static fromAuthorizationToken(c,r){n.Contracts.throwIfNullOrWhitespace(c,"authorizationToken"),n.Contracts.throwIfNullOrWhitespace(r,"region");const o=new s;return o.properties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,c),o.properties.setProperty(i.PropertyId.SpeechServiceConnection_Region,r),o}static fromHost(c,r){n.Contracts.throwIfNull(c,"hostName");const o=new s;return o.setProperty(i.PropertyId.SpeechServiceConnection_Host,c.protocol+"//"+c.hostname+(c.port===""?"":":"+c.port)),r!==void 0&&o.setProperty(i.PropertyId.SpeechServiceConnection_Key,r),o}static fromEndpoint(c,r){n.Contracts.throwIfNull(c,"endpoint"),n.Contracts.throwIfNull(r,"subscriptionKey");const o=new s;return o.properties.setProperty(i.PropertyId.SpeechServiceConnection_Endpoint,c.href),o.properties.setProperty(i.PropertyId.SpeechServiceConnection_Key,r),o}}e.SpeechTranslationConfig=a;class s extends a{constructor(){super(),this.privSpeechProperties=new i.PropertyCollection,this.outputFormat=i.OutputFormat.Simple}set authorizationToken(c){n.Contracts.throwIfNullOrWhitespace(c,"value"),this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,c)}set speechRecognitionLanguage(c){n.Contracts.throwIfNullOrWhitespace(c,"value"),this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage,c)}get speechRecognitionLanguage(){return this.privSpeechProperties.getProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_RecoLanguage])}get subscriptionKey(){return this.privSpeechProperties.getProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_Key])}get outputFormat(){return i.OutputFormat[this.privSpeechProperties.getProperty(p.OutputFormatPropertyName,void 0)]}set outputFormat(c){this.privSpeechProperties.setProperty(p.OutputFormatPropertyName,i.OutputFormat[c])}get endpointId(){return this.privSpeechProperties.getProperty(i.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(c){this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_EndpointId,c)}addTargetLanguage(c){n.Contracts.throwIfNullOrWhitespace(c,"value");const r=this.targetLanguages;r.includes(c)||(r.push(c),this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_TranslationToLanguages,r.join(",")))}get targetLanguages(){return this.privSpeechProperties.getProperty(i.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?this.privSpeechProperties.getProperty(i.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","):[]}get voiceName(){return this.getProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_TranslationVoice])}set voiceName(c){n.Contracts.throwIfNullOrWhitespace(c,"value"),this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_TranslationVoice,c)}get region(){return this.privSpeechProperties.getProperty(i.PropertyId.SpeechServiceConnection_Region)}setProxy(c,r,o,d){this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyHostName],c),this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyPort],r),this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyUserName],o),this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyPassword],d)}getProperty(c,r){return this.privSpeechProperties.getProperty(c,r)}setProperty(c,r){this.privSpeechProperties.setProperty(c,r)}get properties(){return this.privSpeechProperties}close(){}setServiceProperty(c,r){const o=JSON.parse(this.privSpeechProperties.getProperty(p.ServicePropertiesPropertyName,"{}"));o[c]=r,this.privSpeechProperties.setProperty(p.ServicePropertiesPropertyName,JSON.stringify(o))}setProfanity(c){this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceResponse_ProfanityOption,i.ProfanityOption[c])}enableAudioLogging(){this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privSpeechProperties.setProperty(p.ForceDictationPropertyName,"true")}get speechSynthesisLanguage(){return this.privSpeechProperties.getProperty(i.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(c){this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_SynthLanguage,c)}get speechSynthesisVoiceName(){return this.privSpeechProperties.getProperty(i.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(c){this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_SynthVoice,c)}get speechSynthesisOutputFormat(){return i.SpeechSynthesisOutputFormat[this.privSpeechProperties.getProperty(i.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(c){this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_SynthOutputFormat,i.SpeechSynthesisOutputFormat[c])}}e.SpeechTranslationConfigImpl=s},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PropertyCollection=void 0;const p=t(79);class n{constructor(){this.privKeys=[],this.privValues=[]}getProperty(a,s){let h;h=typeof a=="string"?a:p.PropertyId[a];for(let c=0;c<this.privKeys.length;c++)if(this.privKeys[c]===h)return this.privValues[c];if(s!==void 0)return String(s)}setProperty(a,s){let h;h=typeof a=="string"?a:p.PropertyId[a];for(let c=0;c<this.privKeys.length;c++)if(this.privKeys[c]===h)return void(this.privValues[c]=s);this.privKeys.push(h),this.privValues.push(s)}clone(){const a=new n;for(let s=0;s<this.privKeys.length;s++)a.privKeys.push(this.privKeys[s]),a.privValues.push(this.privValues[s]);return a}mergeTo(a){this.privKeys.forEach(s=>{if(a.getProperty(s,void 0)===void 0){const h=this.getProperty(s);a.setProperty(s,h)}})}get keys(){return this.privKeys}}e.PropertyCollection=n},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PropertyId=void 0,function(t){t[t.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",t[t.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",t[t.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",t[t.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",t[t.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",t[t.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",t[t.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",t[t.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",t[t.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",t[t.SpeechServiceConnection_IntentRegion=9]="SpeechServiceConnection_IntentRegion",t[t.SpeechServiceConnection_ProxyHostName=10]="SpeechServiceConnection_ProxyHostName",t[t.SpeechServiceConnection_ProxyPort=11]="SpeechServiceConnection_ProxyPort",t[t.SpeechServiceConnection_ProxyUserName=12]="SpeechServiceConnection_ProxyUserName",t[t.SpeechServiceConnection_ProxyPassword=13]="SpeechServiceConnection_ProxyPassword",t[t.SpeechServiceConnection_RecoMode=14]="SpeechServiceConnection_RecoMode",t[t.SpeechServiceConnection_RecoLanguage=15]="SpeechServiceConnection_RecoLanguage",t[t.Speech_SessionId=16]="Speech_SessionId",t[t.SpeechServiceConnection_SynthLanguage=17]="SpeechServiceConnection_SynthLanguage",t[t.SpeechServiceConnection_SynthVoice=18]="SpeechServiceConnection_SynthVoice",t[t.SpeechServiceConnection_SynthOutputFormat=19]="SpeechServiceConnection_SynthOutputFormat",t[t.SpeechServiceConnection_AutoDetectSourceLanguages=20]="SpeechServiceConnection_AutoDetectSourceLanguages",t[t.SpeechServiceResponse_RequestDetailedResultTrueFalse=21]="SpeechServiceResponse_RequestDetailedResultTrueFalse",t[t.SpeechServiceResponse_RequestProfanityFilterTrueFalse=22]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",t[t.SpeechServiceResponse_JsonResult=23]="SpeechServiceResponse_JsonResult",t[t.SpeechServiceResponse_JsonErrorDetails=24]="SpeechServiceResponse_JsonErrorDetails",t[t.CancellationDetails_Reason=25]="CancellationDetails_Reason",t[t.CancellationDetails_ReasonText=26]="CancellationDetails_ReasonText",t[t.CancellationDetails_ReasonDetailedText=27]="CancellationDetails_ReasonDetailedText",t[t.LanguageUnderstandingServiceResponse_JsonResult=28]="LanguageUnderstandingServiceResponse_JsonResult",t[t.SpeechServiceConnection_Url=29]="SpeechServiceConnection_Url",t[t.SpeechServiceConnection_InitialSilenceTimeoutMs=30]="SpeechServiceConnection_InitialSilenceTimeoutMs",t[t.SpeechServiceConnection_EndSilenceTimeoutMs=31]="SpeechServiceConnection_EndSilenceTimeoutMs",t[t.Speech_SegmentationSilenceTimeoutMs=32]="Speech_SegmentationSilenceTimeoutMs",t[t.SpeechServiceConnection_EnableAudioLogging=33]="SpeechServiceConnection_EnableAudioLogging",t[t.SpeechServiceConnection_LanguageIdMode=34]="SpeechServiceConnection_LanguageIdMode",t[t.SpeechServiceConnection_RecognitionEndpointVersion=35]="SpeechServiceConnection_RecognitionEndpointVersion",t[t.SpeechServiceConnection_SpeakerIdMode=36]="SpeechServiceConnection_SpeakerIdMode",t[t.SpeechServiceResponse_ProfanityOption=37]="SpeechServiceResponse_ProfanityOption",t[t.SpeechServiceResponse_PostProcessingOption=38]="SpeechServiceResponse_PostProcessingOption",t[t.SpeechServiceResponse_RequestWordLevelTimestamps=39]="SpeechServiceResponse_RequestWordLevelTimestamps",t[t.SpeechServiceResponse_StablePartialResultThreshold=40]="SpeechServiceResponse_StablePartialResultThreshold",t[t.SpeechServiceResponse_OutputFormatOption=41]="SpeechServiceResponse_OutputFormatOption",t[t.SpeechServiceResponse_TranslationRequestStablePartialResult=42]="SpeechServiceResponse_TranslationRequestStablePartialResult",t[t.SpeechServiceResponse_RequestWordBoundary=43]="SpeechServiceResponse_RequestWordBoundary",t[t.SpeechServiceResponse_RequestPunctuationBoundary=44]="SpeechServiceResponse_RequestPunctuationBoundary",t[t.SpeechServiceResponse_RequestSentenceBoundary=45]="SpeechServiceResponse_RequestSentenceBoundary",t[t.Conversation_ApplicationId=46]="Conversation_ApplicationId",t[t.Conversation_DialogType=47]="Conversation_DialogType",t[t.Conversation_Initial_Silence_Timeout=48]="Conversation_Initial_Silence_Timeout",t[t.Conversation_From_Id=49]="Conversation_From_Id",t[t.Conversation_Conversation_Id=50]="Conversation_Conversation_Id",t[t.Conversation_Custom_Voice_Deployment_Ids=51]="Conversation_Custom_Voice_Deployment_Ids",t[t.Conversation_Speech_Activity_Template=52]="Conversation_Speech_Activity_Template",t[t.Conversation_Request_Bot_Status_Messages=53]="Conversation_Request_Bot_Status_Messages",t[t.Conversation_Agent_Connection_Id=54]="Conversation_Agent_Connection_Id",t[t.SpeechServiceConnection_Host=55]="SpeechServiceConnection_Host",t[t.ConversationTranslator_Host=56]="ConversationTranslator_Host",t[t.ConversationTranslator_Name=57]="ConversationTranslator_Name",t[t.ConversationTranslator_CorrelationId=58]="ConversationTranslator_CorrelationId",t[t.ConversationTranslator_Token=59]="ConversationTranslator_Token",t[t.PronunciationAssessment_ReferenceText=60]="PronunciationAssessment_ReferenceText",t[t.PronunciationAssessment_GradingSystem=61]="PronunciationAssessment_GradingSystem",t[t.PronunciationAssessment_Granularity=62]="PronunciationAssessment_Granularity",t[t.PronunciationAssessment_EnableMiscue=63]="PronunciationAssessment_EnableMiscue",t[t.PronunciationAssessment_Json=64]="PronunciationAssessment_Json",t[t.PronunciationAssessment_Params=65]="PronunciationAssessment_Params",t[t.SpeakerRecognition_Api_Version=66]="SpeakerRecognition_Api_Version",t[t.WebWorkerLoadType=67]="WebWorkerLoadType",t[t.TalkingAvatarService_WebRTC_SDP=68]="TalkingAvatarService_WebRTC_SDP"}(e.PropertyId||(e.PropertyId={}))},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Recognizer=void 0;const p=t(2),n=t(4),i=t(64),a=t(79);class s{constructor(c,r,o){this.audioConfig=c!==void 0?c:a.AudioConfig.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=r.clone(),this.privConnectionFactory=o,this.implCommonRecognizerSetup()}close(c,r){i.Contracts.throwIfDisposed(this.privDisposed),n.marshalPromiseToCallbacks(this.dispose(!0),c,r)}get internalData(){return this.privReco}async dispose(c){this.privDisposed||(this.privDisposed=!0,c&&this.privReco&&(await this.privReco.audioSource.turnOff(),await this.privReco.dispose()))}static get telemetryEnabled(){return p.ServiceRecognizerBase.telemetryDataEnabled}static enableTelemetry(c){p.ServiceRecognizerBase.telemetryDataEnabled=c}implCommonRecognizerSetup(){let c=typeof window<"u"?"Browser":"Node",r="unknown",o="unknown";typeof navigator<"u"&&(c=c+"/"+navigator.platform,r=navigator.userAgent,o=navigator.appVersion);const d=this.createRecognizerConfig(new p.SpeechServiceConfig(new p.Context(new p.OS(c,r,o))));this.privReco=this.createServiceRecognizer(s.getAuthFromProperties(this.privProperties),this.privConnectionFactory,this.audioConfig,d)}async recognizeOnceAsyncImpl(c){i.Contracts.throwIfDisposed(this.privDisposed);const r=new n.Deferred;await this.implRecognizerStop(),await this.privReco.recognize(c,r.resolve,r.reject);const o=await r.promise;return await this.implRecognizerStop(),o}async startContinuousRecognitionAsyncImpl(c){i.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop(),await this.privReco.recognize(c,void 0,void 0)}async stopContinuousRecognitionAsyncImpl(){i.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop()}async implRecognizerStop(){this.privReco&&await this.privReco.stopRecognizing()}static getAuthFromProperties(c){const r=c.getProperty(a.PropertyId.SpeechServiceConnection_Key,void 0);return r&&r!==""?new p.CognitiveSubscriptionKeyAuthentication(r):new p.CognitiveTokenAuthentication(()=>{const o=c.getProperty(a.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(o)},()=>{const o=c.getProperty(a.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(o)})}}e.Recognizer=s},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechRecognizer=void 0;const p=t(2),n=t(4),i=t(64),a=t(79);class s extends a.Recognizer{constructor(c,r){const o=c;i.Contracts.throwIfNull(o,"speechConfig"),i.Contracts.throwIfNullOrWhitespace(o.properties.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage),a.PropertyId[a.PropertyId.SpeechServiceConnection_RecoLanguage]),super(r,o.properties,new p.SpeechConnectionFactory),this.privDisposedRecognizer=!1}static FromConfig(c,r,o){const d=c;return r.properties.mergeTo(d.properties),new s(c,o)}get endpointId(){return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(a.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(c){i.Contracts.throwIfNullOrWhitespace(c,"token"),this.properties.setProperty(a.PropertyId.SpeechServiceAuthorization_Token,c)}get speechRecognitionLanguage(){return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(p.OutputFormatPropertyName,a.OutputFormat[a.OutputFormat.Simple])===a.OutputFormat[a.OutputFormat.Simple]?a.OutputFormat.Simple:a.OutputFormat.Detailed}get properties(){return this.privProperties}recognizeOnceAsync(c,r){n.marshalPromiseToCallbacks(this.recognizeOnceAsyncImpl(p.RecognitionMode.Interactive),c,r)}startContinuousRecognitionAsync(c,r){n.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(p.RecognitionMode.Conversation),c,r)}stopContinuousRecognitionAsync(c,r){n.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),c,r)}startKeywordRecognitionAsync(c,r,o){i.Contracts.throwIfNull(c,"model"),o&&o("Not yet implemented.")}stopKeywordRecognitionAsync(c){c&&c()}close(c,r){i.Contracts.throwIfDisposed(this.privDisposedRecognizer),n.marshalPromiseToCallbacks(this.dispose(!0),c,r)}async dispose(c){this.privDisposedRecognizer||(c&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(c))}createRecognizerConfig(c){return new p.RecognizerConfig(c,this.privProperties)}createServiceRecognizer(c,r,o,d){const u=o;return new p.SpeechServiceRecognizer(c,r,u,d,this)}}e.SpeechRecognizer=s},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.IntentRecognizer=void 0;const p=t(2),n=t(4),i=t(64),a=t(79);class s extends a.Recognizer{constructor(c,r){i.Contracts.throwIfNullOrUndefined(c,"speechConfig");const o=c;i.Contracts.throwIfNullOrUndefined(o,"speechConfig"),super(r,o.properties,new p.IntentConnectionFactory),this.privAddedIntents=[],this.privAddedLmIntents={},this.privDisposedIntentRecognizer=!1,this.privProperties=o.properties,i.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage),a.PropertyId[a.PropertyId.SpeechServiceConnection_RecoLanguage])}get speechRecognitionLanguage(){return i.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage)}get authorizationToken(){return this.properties.getProperty(a.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(c){this.properties.setProperty(a.PropertyId.SpeechServiceAuthorization_Token,c)}get properties(){return this.privProperties}recognizeOnceAsync(c,r){if(i.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),Object.keys(this.privAddedLmIntents).length!==0||this.privUmbrellaIntent!==void 0){const o=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",o.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(o.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}n.marshalPromiseToCallbacks(this.recognizeOnceAsyncImpl(p.RecognitionMode.Interactive),c,r)}startContinuousRecognitionAsync(c,r){if(Object.keys(this.privAddedLmIntents).length!==0||this.privUmbrellaIntent!==void 0){const o=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",o.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(o.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}n.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(p.RecognitionMode.Conversation),c,r)}stopContinuousRecognitionAsync(c,r){n.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),c,r)}startKeywordRecognitionAsync(c,r,o){i.Contracts.throwIfNull(c,"model"),o&&o("Not yet implemented.")}stopKeywordRecognitionAsync(c,r){if(c)try{c()}catch(o){r&&r(o)}}addIntent(c,r){i.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),i.Contracts.throwIfNullOrWhitespace(r,"intentId"),i.Contracts.throwIfNullOrWhitespace(c,"simplePhrase"),this.privAddedIntents.push([r,c])}addIntentWithLanguageModel(c,r,o){i.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),i.Contracts.throwIfNullOrWhitespace(c,"intentId"),i.Contracts.throwIfNull(r,"model");const d=r;i.Contracts.throwIfNullOrWhitespace(d.appId,"model.appId"),this.privAddedLmIntents[c]=new p.AddedLmIntent(d,o)}addAllIntents(c,r){i.Contracts.throwIfNull(c,"model");const o=c;i.Contracts.throwIfNullOrWhitespace(o.appId,"model.appId"),this.privUmbrellaIntent=new p.AddedLmIntent(o,r)}close(c,r){i.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),n.marshalPromiseToCallbacks(this.dispose(!0),c,r)}createRecognizerConfig(c){return new p.RecognizerConfig(c,this.privProperties)}createServiceRecognizer(c,r,o,d){const u=o;return new p.IntentServiceRecognizer(c,r,u,d,this)}async dispose(c){this.privDisposedIntentRecognizer||c&&(this.privDisposedIntentRecognizer=!0,await super.dispose(c))}buildSpeechContext(){let c,r,o;const d=[];this.privUmbrellaIntent!==void 0&&(c=this.privUmbrellaIntent.modelImpl.appId,r=this.privUmbrellaIntent.modelImpl.region,o=this.privUmbrellaIntent.modelImpl.subscriptionKey);for(const u of Object.keys(this.privAddedLmIntents)){const v=this.privAddedLmIntents[u];if(c===void 0)c=v.modelImpl.appId;else if(c!==v.modelImpl.appId)throw new Error("Intents must all be from the same LUIS model");if(r===void 0)r=v.modelImpl.region;else if(r!==v.modelImpl.region)throw new Error("Intents must all be from the same LUIS model in a single region");if(o===void 0)o=v.modelImpl.subscriptionKey;else if(o!==v.modelImpl.subscriptionKey)throw new Error("Intents must all use the same subscription key");const l="luis/"+c+"-PRODUCTION#"+u;d.push(l)}return{Intent:{id:c,key:o===void 0?this.privProperties.getProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_Key]):o,provider:"LUIS"},ReferenceGrammars:this.privUmbrellaIntent===void 0?d:["luis/"+c+"-PRODUCTION"]}}}e.IntentRecognizer=s},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VoiceProfileType=void 0,function(t){t[t.TextIndependentIdentification=0]="TextIndependentIdentification",t[t.TextDependentVerification=1]="TextDependentVerification",t[t.TextIndependentVerification=2]="TextIndependentVerification"}(e.VoiceProfileType||(e.VoiceProfileType={}))},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TranslationRecognizer=void 0;const p=t(2),n=t(4),i=t(116),a=t(64),s=t(79);class h extends s.Recognizer{constructor(r,o,d){const u=r;a.Contracts.throwIfNull(u,"speechConfig"),super(o,u.properties,d||new p.TranslationConnectionFactory),this.privDisposedTranslationRecognizer=!1,this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&a.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationVoice),s.PropertyId[s.PropertyId.SpeechServiceConnection_TranslationVoice]),a.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages),s.PropertyId[s.PropertyId.SpeechServiceConnection_TranslationToLanguages]),a.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage),s.PropertyId[s.PropertyId.SpeechServiceConnection_RecoLanguage])}static FromConfig(r,o,d){const u=r;return o.properties.mergeTo(u.properties),new h(r,d)}get speechRecognitionLanguage(){return a.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage)}get targetLanguages(){return a.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",")}get voiceName(){return a.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(s.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(r){this.properties.setProperty(s.PropertyId.SpeechServiceAuthorization_Token,r)}recognizeOnceAsync(r,o){a.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),n.marshalPromiseToCallbacks(this.recognizeOnceAsyncImpl(p.RecognitionMode.Interactive),r,o)}startContinuousRecognitionAsync(r,o){n.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(p.RecognitionMode.Conversation),r,o)}stopContinuousRecognitionAsync(r,o){n.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),r,o)}removeTargetLanguage(r){if(a.Contracts.throwIfNullOrUndefined(r,"language to be removed"),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0){const o=this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),d=o.indexOf(r);d>-1&&(o.splice(d,1),this.properties.setProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,o.join(",")),this.updateLanguages(o))}}addTargetLanguage(r){a.Contracts.throwIfNullOrUndefined(r,"language to be added");let o=[];this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?(o=this.properties.getProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),o.includes(r)||(o.push(r),this.properties.setProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,o.join(",")))):(this.properties.setProperty(s.PropertyId.SpeechServiceConnection_TranslationToLanguages,r),o=[r]),this.updateLanguages(o)}close(r,o){a.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),n.marshalPromiseToCallbacks(this.dispose(!0),r,o)}onConnection(){}async dispose(r){this.privDisposedTranslationRecognizer||(this.privDisposedTranslationRecognizer=!0,r&&(await this.implRecognizerStop(),await super.dispose(r)))}createRecognizerConfig(r){return new p.RecognizerConfig(r,this.privProperties)}createServiceRecognizer(r,o,d,u){const v=d;return new p.TranslationServiceRecognizer(r,o,v,u,this)}updateLanguages(r){const o=i.Connection.fromRecognizer(this);o&&(o.setMessageProperty("speech.context","translationcontext",{to:r}),o.sendMessageAsync("event",JSON.stringify({id:"translation",name:"updateLanguage",to:r})))}}e.TranslationRecognizer=h},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Connection=void 0;const p=t(2),n=t(4),i=t(117),a=t(64),s=t(79);class h{static fromRecognizer(r){const o=r.internalData,d=new h;return d.privInternalData=o,d.setupEvents(),d}static fromSynthesizer(r){const o=r.internalData,d=new h;return d.privInternalData=o,d.setupEvents(),d}openConnection(r,o){n.marshalPromiseToCallbacks(this.privInternalData.connect(),r,o)}closeConnection(r,o){if(this.privInternalData instanceof p.SynthesisAdapterBase)throw new Error("Disconnecting a synthesizer's connection is currently not supported");n.marshalPromiseToCallbacks(this.privInternalData.disconnect(),r,o)}setMessageProperty(r,o,d){if(a.Contracts.throwIfNullOrWhitespace(o,"propertyName"),this.privInternalData instanceof p.ServiceRecognizerBase){if(r.toLowerCase()!=="speech.context")throw new Error("Only speech.context message property sets are currently supported for recognizer");this.privInternalData.speechContext.setSection(o,d)}else if(this.privInternalData instanceof p.SynthesisAdapterBase){if(r.toLowerCase()!=="synthesis.context")throw new Error("Only synthesis.context message property sets are currently supported for synthesizer");this.privInternalData.synthesisContext.setSection(o,d)}}sendMessageAsync(r,o,d,u){n.marshalPromiseToCallbacks(this.privInternalData.sendNetworkMessage(r,o),d,u)}close(){}setupEvents(){this.privEventListener=this.privInternalData.connectionEvents.attach(r=>{r.name==="ConnectionEstablishedEvent"?this.connected&&this.connected(new s.ConnectionEventArgs(r.connectionId)):r.name==="ConnectionClosedEvent"?this.disconnected&&this.disconnected(new s.ConnectionEventArgs(r.connectionId)):r.name==="ConnectionMessageSentEvent"?this.messageSent&&this.messageSent(new s.ConnectionMessageEventArgs(new i.ConnectionMessageImpl(r.message))):r.name==="ConnectionMessageReceivedEvent"&&this.messageReceived&&this.messageReceived(new s.ConnectionMessageEventArgs(new i.ConnectionMessageImpl(r.message)))}),this.privServiceEventListener=this.privInternalData.serviceEvents.attach(r=>{this.receivedServiceMessage&&this.receivedServiceMessage(new s.ServiceEventArgs(r.jsonString,r.name))})}}e.Connection=h},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionMessageImpl=e.ConnectionMessage=void 0;const p=t(54),n=t(4),i=t(109),a=t(110);e.ConnectionMessage=class{},e.ConnectionMessageImpl=class{constructor(s){this.privConnectionMessage=s,this.privProperties=new i.PropertyCollection,this.privConnectionMessage.headers[p.HeaderNames.ConnectionId]&&this.privProperties.setProperty(a.PropertyId.Speech_SessionId,this.privConnectionMessage.headers[p.HeaderNames.ConnectionId]),Object.keys(this.privConnectionMessage.headers).forEach(h=>{this.privProperties.setProperty(h,this.privConnectionMessage.headers[h])})}get path(){return this.privConnectionMessage.headers[Object.keys(this.privConnectionMessage.headers).find(s=>s.toLowerCase()==="path".toLowerCase())]}get isTextMessage(){return this.privConnectionMessage.messageType===n.MessageType.Text}get isBinaryMessage(){return this.privConnectionMessage.messageType===n.MessageType.Binary}get TextMessage(){return this.privConnectionMessage.textBody}get binaryMessage(){return this.privConnectionMessage.binaryBody}get properties(){return this.privProperties}toString(){return""}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Translations=void 0;const p=t(79);e.Translations=class{constructor(){this.privMap=new p.PropertyCollection}get languages(){return this.privMap.keys}get(n,i){return this.privMap.getProperty(n,i)}set(n,i){this.privMap.setProperty(n,i)}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NoMatchReason=void 0,function(t){t[t.NotRecognized=0]="NotRecognized",t[t.InitialSilenceTimeout=1]="InitialSilenceTimeout",t[t.InitialBabbleTimeout=2]="InitialBabbleTimeout"}(e.NoMatchReason||(e.NoMatchReason={}))},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NoMatchDetails=void 0;const p=t(2),n=t(79);class i{constructor(s){this.privReason=s}static fromResult(s){const h=p.SimpleSpeechPhrase.fromJSON(s.json);let c=n.NoMatchReason.NotRecognized;switch(h.RecognitionStatus){case p.RecognitionStatus.BabbleTimeout:c=n.NoMatchReason.InitialBabbleTimeout;break;case p.RecognitionStatus.InitialSilenceTimeout:c=n.NoMatchReason.InitialSilenceTimeout;break;default:c=n.NoMatchReason.NotRecognized}return new i(c)}get reason(){return this.privReason}}e.NoMatchDetails=i},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TranslationRecognitionCanceledEventArgs=void 0,e.TranslationRecognitionCanceledEventArgs=class{constructor(t,p,n,i,a){this.privCancelReason=p,this.privErrorDetails=n,this.privResult=a,this.privSessionId=t,this.privErrorCode=i}get result(){return this.privResult}get sessionId(){return this.privSessionId}get reason(){return this.privCancelReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.IntentRecognitionCanceledEventArgs=void 0;const p=t(79);class n extends p.IntentRecognitionEventArgs{constructor(a,s,h,c,r,o){super(c,r,o),this.privReason=a,this.privErrorDetails=s,this.privErrorCode=h}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}}e.IntentRecognitionCanceledEventArgs=n},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CancellationDetailsBase=void 0,e.CancellationDetailsBase=class{constructor(t,p,n){this.privReason=t,this.privErrorDetails=p,this.privErrorCode=n}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get ErrorCode(){return this.privErrorCode}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CancellationDetails=void 0;const p=t(2),n=t(123),i=t(79);class a extends n.CancellationDetailsBase{constructor(h,c,r){super(h,c,r)}static fromResult(h){let c=i.CancellationReason.Error,r=i.CancellationErrorCode.NoError;if(h instanceof i.RecognitionResult&&h.json){const o=p.SimpleSpeechPhrase.fromJSON(h.json);c=p.EnumTranslation.implTranslateCancelResult(o.RecognitionStatus)}return h.properties&&(r=i.CancellationErrorCode[h.properties.getProperty(p.CancellationErrorCodePropertyName,i.CancellationErrorCode[i.CancellationErrorCode.NoError])]),new a(c,h.errorDetails||p.EnumTranslation.implTranslateErrorDetails(r),r)}}e.CancellationDetails=a},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CancellationErrorCode=void 0,function(t){t[t.NoError=0]="NoError",t[t.AuthenticationFailure=1]="AuthenticationFailure",t[t.BadRequestParameters=2]="BadRequestParameters",t[t.TooManyRequests=3]="TooManyRequests",t[t.ConnectionFailure=4]="ConnectionFailure",t[t.ServiceTimeout=5]="ServiceTimeout",t[t.ServiceError=6]="ServiceError",t[t.RuntimeError=7]="RuntimeError",t[t.Forbidden=8]="Forbidden"}(e.CancellationErrorCode||(e.CancellationErrorCode={}))},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionEventArgs=void 0;const p=t(79);class n extends p.SessionEventArgs{}e.ConnectionEventArgs=n},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ServiceEventArgs=void 0;const p=t(79);class n extends p.SessionEventArgs{constructor(a,s,h){super(h),this.privJsonResult=a,this.privEventName=s}get jsonString(){return this.privJsonResult}get eventName(){return this.privEventName}}e.ServiceEventArgs=n},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PhraseListGrammar=void 0;class t{constructor(n){this.privGrammerBuilder=n.dynamicGrammar}static fromRecognizer(n){const i=n.internalData;return new t(i)}addPhrase(n){this.privGrammerBuilder.addPhrase(n)}addPhrases(n){this.privGrammerBuilder.addPhrase(n)}clear(){this.privGrammerBuilder.clearPhrases()}}e.PhraseListGrammar=t},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DialogServiceConfigImpl=e.DialogServiceConfig=void 0;const p=t(64),n=t(79);class i{constructor(){}set applicationId(s){}static get DialogTypes(){return{BotFramework:"bot_framework",CustomCommands:"custom_commands"}}}e.DialogServiceConfig=i,e.DialogServiceConfigImpl=class extends i{constructor(){super(),this.privSpeechConfig=new n.SpeechConfigImpl}get properties(){return this.privSpeechConfig.properties}get speechRecognitionLanguage(){return this.privSpeechConfig.speechRecognitionLanguage}set speechRecognitionLanguage(a){p.Contracts.throwIfNullOrWhitespace(a,"value"),this.privSpeechConfig.speechRecognitionLanguage=a}get outputFormat(){return this.privSpeechConfig.outputFormat}set outputFormat(a){this.privSpeechConfig.outputFormat=a}setProperty(a,s){this.privSpeechConfig.setProperty(a,s)}getProperty(a,s){return this.privSpeechConfig.getProperty(a)}setProxy(a,s,h,c){this.setProperty(n.PropertyId.SpeechServiceConnection_ProxyHostName,a),this.setProperty(n.PropertyId.SpeechServiceConnection_ProxyPort,`${s}`),h&&this.setProperty(n.PropertyId.SpeechServiceConnection_ProxyUserName,h),c&&this.setProperty(n.PropertyId.SpeechServiceConnection_ProxyPassword,c)}setServiceProperty(a,s,h){this.privSpeechConfig.setServiceProperty(a,s)}close(){}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BotFrameworkConfig=void 0;const p=t(64),n=t(129),i=t(79);class a extends n.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(h,c,r){p.Contracts.throwIfNullOrWhitespace(h,"subscription"),p.Contracts.throwIfNullOrWhitespace(c,"region");const o=new n.DialogServiceConfigImpl;return o.setProperty(i.PropertyId.Conversation_DialogType,n.DialogServiceConfig.DialogTypes.BotFramework),o.setProperty(i.PropertyId.SpeechServiceConnection_Key,h),o.setProperty(i.PropertyId.SpeechServiceConnection_Region,c),r&&o.setProperty(i.PropertyId.Conversation_ApplicationId,r),o}static fromAuthorizationToken(h,c,r){p.Contracts.throwIfNullOrWhitespace(h,"authorizationToken"),p.Contracts.throwIfNullOrWhitespace(c,"region");const o=new n.DialogServiceConfigImpl;return o.setProperty(i.PropertyId.Conversation_DialogType,n.DialogServiceConfig.DialogTypes.BotFramework),o.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,h),o.setProperty(i.PropertyId.SpeechServiceConnection_Region,c),r&&o.setProperty(i.PropertyId.Conversation_ApplicationId,r),o}static fromHost(h,c,r){p.Contracts.throwIfNullOrUndefined(h,"host");const o=h instanceof URL?h:new URL(`wss://${h}.convai.speech.azure.us`);p.Contracts.throwIfNullOrUndefined(o,"resolvedHost");const d=new n.DialogServiceConfigImpl;return d.setProperty(i.PropertyId.Conversation_DialogType,n.DialogServiceConfig.DialogTypes.BotFramework),d.setProperty(i.PropertyId.SpeechServiceConnection_Host,o.toString()),c!==void 0&&d.setProperty(i.PropertyId.SpeechServiceConnection_Key,c),d}static fromEndpoint(h,c){p.Contracts.throwIfNull(h,"endpoint");const r=new n.DialogServiceConfigImpl;return r.setProperty(i.PropertyId.Conversation_DialogType,n.DialogServiceConfig.DialogTypes.BotFramework),r.setProperty(i.PropertyId.SpeechServiceConnection_Endpoint,h.toString()),c!==void 0&&r.setProperty(i.PropertyId.SpeechServiceConnection_Key,c),r}}e.BotFrameworkConfig=a},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CustomCommandsConfig=void 0;const p=t(64),n=t(129),i=t(79);class a extends n.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(h,c,r){p.Contracts.throwIfNullOrWhitespace(h,"applicationId"),p.Contracts.throwIfNullOrWhitespace(c,"subscription"),p.Contracts.throwIfNullOrWhitespace(r,"region");const o=new n.DialogServiceConfigImpl;return o.setProperty(i.PropertyId.Conversation_DialogType,n.DialogServiceConfig.DialogTypes.CustomCommands),o.setProperty(i.PropertyId.Conversation_ApplicationId,h),o.setProperty(i.PropertyId.SpeechServiceConnection_Key,c),o.setProperty(i.PropertyId.SpeechServiceConnection_Region,r),o}static fromAuthorizationToken(h,c,r){p.Contracts.throwIfNullOrWhitespace(h,"applicationId"),p.Contracts.throwIfNullOrWhitespace(c,"authorizationToken"),p.Contracts.throwIfNullOrWhitespace(r,"region");const o=new n.DialogServiceConfigImpl;return o.setProperty(i.PropertyId.Conversation_DialogType,n.DialogServiceConfig.DialogTypes.CustomCommands),o.setProperty(i.PropertyId.Conversation_ApplicationId,h),o.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,c),o.setProperty(i.PropertyId.SpeechServiceConnection_Region,r),o}set applicationId(h){p.Contracts.throwIfNullOrWhitespace(h,"value"),this.setProperty(i.PropertyId.Conversation_ApplicationId,h)}get applicationId(){return this.getProperty(i.PropertyId.Conversation_ApplicationId)}}e.CustomCommandsConfig=a},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DialogServiceConnector=void 0;const p=t(133),n=t(2),i=t(4),a=t(64),s=t(79),h=t(110);class c extends s.Recognizer{constructor(o,d){const u=o;a.Contracts.throwIfNull(o,"dialogConfig"),super(d,u.properties,new p.DialogConnectionFactory),this.isTurnComplete=!0,this.privIsDisposed=!1,this.privProperties=u.properties.clone();const v=this.buildAgentConfig();this.privReco.agentConfig.set(v)}connect(o,d){i.marshalPromiseToCallbacks(this.privReco.connect(),o,d)}disconnect(o,d){i.marshalPromiseToCallbacks(this.privReco.disconnect(),o,d)}get authorizationToken(){return this.properties.getProperty(h.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(o){a.Contracts.throwIfNullOrWhitespace(o,"token"),this.properties.setProperty(h.PropertyId.SpeechServiceAuthorization_Token,o)}get properties(){return this.privProperties}get speechActivityTemplate(){return this.properties.getProperty(h.PropertyId.Conversation_Speech_Activity_Template)}set speechActivityTemplate(o){this.properties.setProperty(h.PropertyId.Conversation_Speech_Activity_Template,o)}listenOnceAsync(o,d){if(this.isTurnComplete){a.Contracts.throwIfDisposed(this.privIsDisposed);const u=(async()=>{await this.privReco.connect(),await this.implRecognizerStop(),this.isTurnComplete=!1;const v=new i.Deferred;await this.privReco.recognize(n.RecognitionMode.Conversation,v.resolve,v.reject);const l=await v.promise;return await this.implRecognizerStop(),l})();u.catch(()=>{this.dispose(!0).catch(()=>{})}),i.marshalPromiseToCallbacks(u.finally(()=>{this.isTurnComplete=!0}),o,d)}}sendActivityAsync(o,d,u){i.marshalPromiseToCallbacks(this.privReco.sendMessage(o),d,u)}close(o,d){a.Contracts.throwIfDisposed(this.privIsDisposed),i.marshalPromiseToCallbacks(this.dispose(!0),o,d)}async dispose(o){this.privIsDisposed||o&&(this.privIsDisposed=!0,await this.implRecognizerStop(),await super.dispose(o))}createRecognizerConfig(o){return new n.RecognizerConfig(o,this.privProperties)}createServiceRecognizer(o,d,u,v){const l=u;return new n.DialogServiceAdapter(o,d,l,v,this)}buildAgentConfig(){return{botInfo:{commType:this.properties.getProperty("Conversation_Communication_Type","Default"),commandsCulture:void 0,connectionId:this.properties.getProperty(h.PropertyId.Conversation_Agent_Connection_Id),conversationId:this.properties.getProperty(h.PropertyId.Conversation_Conversation_Id,void 0),fromId:this.properties.getProperty(h.PropertyId.Conversation_From_Id,void 0),ttsAudioFormat:this.properties.getProperty(h.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)},version:.2}}}e.DialogServiceConnector=c},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DialogConnectionFactory=void 0;const p=t(60),n=t(2),i=t(79),a=t(134),s=t(2),h=t(54),c=t(135);class r extends a.ConnectionFactoryBase{create(d,u,v){const l=d.parameters.getProperty(i.PropertyId.Conversation_ApplicationId,""),g=d.parameters.getProperty(i.PropertyId.Conversation_DialogType),m=d.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Region),S=d.parameters.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),y=d.parameters.getProperty(i.PropertyId.Conversation_Request_Bot_Status_Messages,"true"),C={};C[h.HeaderNames.ConnectionId]=v,C[c.QueryParameterNames.Format]=d.parameters.getProperty(n.OutputFormatPropertyName,i.OutputFormat[i.OutputFormat.Simple]).toLowerCase(),C[c.QueryParameterNames.Language]=S,C[c.QueryParameterNames.RequestBotStatusMessages]=y,l&&(C[c.QueryParameterNames.BotId]=l,g===i.DialogServiceConfig.DialogTypes.CustomCommands&&(C[h.HeaderNames.CustomCommandsAppId]=l));const P=g===i.DialogServiceConfig.DialogTypes.CustomCommands?"commands/":"",R=g===i.DialogServiceConfig.DialogTypes.CustomCommands?"v1":g===i.DialogServiceConfig.DialogTypes.BotFramework?"v3":"v0",I={};u.token!=null&&u.token!==""&&(I[u.headerName]=u.token);let T=d.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Endpoint,"");if(!T){const E=a.ConnectionFactoryBase.getHostSuffix(m),A=d.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Host,`wss://${m}.${r.BaseUrl}${E}`);T=`${A.endsWith("/")?A:A+"/"}${P}${r.ApiKey}/${R}`}this.setCommonUrlParams(d,C,T);const w=d.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new p.WebsocketConnection(T,C,I,new s.WebsocketMessageFormatter,p.ProxyInfo.fromRecognizerConfig(d),w,v)}}e.DialogConnectionFactory=r,r.ApiKey="api",r.BaseUrl="convai.speech"},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionFactoryBase=void 0;const p=t(2),n=t(79),i=t(135);e.ConnectionFactoryBase=class{static getHostSuffix(a){if(a){if(a.toLowerCase().startsWith("china"))return".azure.cn";if(a.toLowerCase().startsWith("usgov"))return".azure.us"}return".microsoft.com"}setCommonUrlParams(a,s,h){new Map([[n.PropertyId.Speech_SegmentationSilenceTimeoutMs,i.QueryParameterNames.SegmentationSilenceTimeoutMs],[n.PropertyId.SpeechServiceConnection_EnableAudioLogging,i.QueryParameterNames.EnableAudioLogging],[n.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,i.QueryParameterNames.EndSilenceTimeoutMs],[n.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,i.QueryParameterNames.InitialSilenceTimeoutMs],[n.PropertyId.SpeechServiceResponse_PostProcessingOption,i.QueryParameterNames.Postprocessing],[n.PropertyId.SpeechServiceResponse_ProfanityOption,i.QueryParameterNames.Profanity],[n.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,i.QueryParameterNames.EnableWordLevelTimestamps],[n.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,i.QueryParameterNames.StableIntermediateThreshold]]).forEach((r,o)=>{this.setUrlParameter(o,r,a,s,h)});const c=JSON.parse(a.parameters.getProperty(p.ServicePropertiesPropertyName,"{}"));Object.keys(c).forEach(r=>{s[r]=c[r]})}setUrlParameter(a,s,h,c,r){const o=h.parameters.getProperty(a,void 0);!o||r&&r.search(s)!==-1||(c[s]=o.toLocaleLowerCase())}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.QueryParameterNames=void 0;class t{}e.QueryParameterNames=t,t.BotId="botid",t.CustomSpeechDeploymentId="cid",t.CustomVoiceDeploymentId="deploymentId",t.EnableAudioLogging="storeAudio",t.EnableLanguageId="lidEnabled",t.EnableWordLevelTimestamps="wordLevelTimestamps",t.EndSilenceTimeoutMs="endSilenceTimeoutMs",t.SegmentationSilenceTimeoutMs="segmentationSilenceTimeoutMs",t.Format="format",t.InitialSilenceTimeoutMs="initialSilenceTimeoutMs",t.Language="language",t.Profanity="profanity",t.RequestBotStatusMessages="enableBotMessageStatus",t.StableIntermediateThreshold="stableIntermediateThreshold",t.StableTranslation="stableTranslation",t.TestHooks="testhooks",t.Postprocessing="postprocessing",t.CtsMeetingId="meetingId",t.CtsDeviceId="deviceId",t.CtsIsParticipant="isParticipant",t.EnableAvatar="enableTalkingAvatar"},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ActivityReceivedEventArgs=void 0,e.ActivityReceivedEventArgs=class{constructor(t,p){this.privActivity=t,this.privAudioStream=p}get activity(){return this.privActivity}get audioStream(){return this.privAudioStream}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TurnStatusReceivedEventArgs=void 0;const p=t(138);e.TurnStatusReceivedEventArgs=class{constructor(n){this.privTurnStatus=p.TurnStatusResponsePayload.fromJSON(n)}get interactionId(){return this.privTurnStatus.interactionId}get conversationId(){return this.privTurnStatus.conversationId}get statusCode(){return this.privTurnStatus.statusCode}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TurnStatusResponsePayload=void 0;class t{constructor(n){this.privMessageStatusResponse=JSON.parse(n)}static fromJSON(n){return new t(n)}get interactionId(){return this.privMessageStatusResponse.interactionId}get conversationId(){return this.privMessageStatusResponse.conversationId}get statusCode(){switch(this.privMessageStatusResponse.statusCode){case"Success":return 200;case"Failed":return 400;case"TimedOut":return 429;default:return this.privMessageStatusResponse.statusCode}}}e.TurnStatusResponsePayload=t},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ServicePropertyChannel=void 0,function(t){t[t.UriQueryParameter=0]="UriQueryParameter"}(e.ServicePropertyChannel||(e.ServicePropertyChannel={}))},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ProfanityOption=void 0,function(t){t[t.Masked=0]="Masked",t[t.Removed=1]="Removed",t[t.Raw=2]="Raw"}(e.ProfanityOption||(e.ProfanityOption={}))},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BaseAudioPlayer=void 0;const p=t(26),n=t(79),i=t(67);e.BaseAudioPlayer=class{constructor(a){this.audioContext=null,this.gainNode=null,this.autoUpdateBufferTimer=0,a===void 0&&(a=n.AudioStreamFormat.getDefaultInputFormat()),this.init(a)}playAudioSample(a,s,h){try{this.ensureInitializedContext();const c=this.formatAudioData(a),r=new Float32Array(this.samples.length+c.length);r.set(this.samples,0),r.set(c,this.samples.length),this.samples=r,s&&s()}catch(c){h&&h(c)}}stopAudio(a,s){this.audioContext!==null&&(this.samples=new Float32Array,clearInterval(this.autoUpdateBufferTimer),this.audioContext.close().then(()=>{a&&a()},h=>{s&&s(h)}),this.audioContext=null)}init(a){this.audioFormat=a,this.samples=new Float32Array}ensureInitializedContext(){if(this.audioContext===null){this.createAudioContext();const a=200;this.autoUpdateBufferTimer=setInterval(()=>{this.updateAudioBuffer()},a)}}createAudioContext(){this.audioContext=i.AudioStreamFormatImpl.getAudioContext(),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioContext.destination),this.startTime=this.audioContext.currentTime}formatAudioData(a){switch(this.audioFormat.bitsPerSample){case 8:return this.formatArrayBuffer(new Int8Array(a),128);case 16:return this.formatArrayBuffer(new Int16Array(a),32768);case 32:return this.formatArrayBuffer(new Int32Array(a),2147483648);default:throw new p.InvalidOperationError("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}}formatArrayBuffer(a,s){const h=new Float32Array(a.length);for(let c=0;c<a.length;c++)h[c]=a[c]/s;return h}updateAudioBuffer(){if(this.samples.length===0)return;const a=this.audioFormat.channels,s=this.audioContext.createBufferSource(),h=this.samples.length/a,c=this.audioContext.createBuffer(a,h,this.audioFormat.samplesPerSec);for(let r=0;r<a;r++){let o=r;const d=c.getChannelData(r);for(let u=0;u<this.samples.length;u++,o+=a)d[u]=this.samples[o]}this.startTime<this.audioContext.currentTime&&(this.startTime=this.audioContext.currentTime),s.buffer=c,s.connect(this.gainNode),s.start(this.startTime),this.startTime+=c.duration,this.samples=new Float32Array}async playAudio(a){this.audioContext===null&&this.createAudioContext();const s=this.audioContext.createBufferSource(),h=this.audioContext.destination;await this.audioContext.decodeAudioData(a,c=>{s.buffer=c,s.connect(h),s.start(0)})}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionMessageEventArgs=void 0,e.ConnectionMessageEventArgs=class{constructor(t){this.privConnectionMessage=t}get message(){return this.privConnectionMessage}toString(){return"Message: "+this.privConnectionMessage.toString()}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VoiceProfile=void 0,e.VoiceProfile=class{constructor(t,p){this.privId=t,this.privProfileType=p}get profileId(){return this.privId}get profileType(){return this.privProfileType}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VoiceProfileEnrollmentCancellationDetails=e.VoiceProfileEnrollmentResult=void 0;const p=t(2),n=t(79);class i{constructor(h,c,r){this.privReason=h,this.privProperties=new n.PropertyCollection,this.privReason!==n.ResultReason.Canceled?c&&(this.privDetails=JSON.parse(c),this.privDetails.enrollmentStatus.toLowerCase()==="enrolling"&&(this.privReason=n.ResultReason.EnrollingVoiceProfile)):(this.privErrorDetails=r,this.privProperties.setProperty(p.CancellationErrorCodePropertyName,n.CancellationErrorCode[n.CancellationErrorCode.ServiceError]))}get reason(){return this.privReason}get enrollmentsCount(){return this.privDetails.enrollmentsCount}get enrollmentsLength(){return this.privDetails.enrollmentsLength}get properties(){return this.privProperties}get enrollmentResultDetails(){return this.privDetails}get errorDetails(){return this.privErrorDetails}static FromIdentificationProfileList(h){const c=[];for(const r of h.value){const o=r.enrollmentStatus.toLowerCase()==="enrolling"?n.ResultReason.EnrollingVoiceProfile:r.enrollmentStatus.toLowerCase()==="enrolled"?n.ResultReason.EnrolledVoiceProfile:n.ResultReason.Canceled,d=new i(o,null,null);d.privDetails=this.getIdentificationDetails(r),c.push(d)}return c}static FromVerificationProfileList(h){const c=[];for(const r of h.value){const o=r.enrollmentStatus.toLowerCase()==="enrolling"?n.ResultReason.EnrollingVoiceProfile:r.enrollmentStatus.toLowerCase()==="enrolled"?n.ResultReason.EnrolledVoiceProfile:n.ResultReason.Canceled,d=new i(o,null,null);d.privDetails=this.getVerificationDetails(r),c.push(d)}return c}static getIdentificationDetails(h){return{audioLength:h.audioLength?parseFloat(h.audioLength):0,audioSpeechLength:h.audioSpeechLength?parseFloat(h.audioSpeechLength):0,enrollmentStatus:h.enrollmentStatus,enrollmentsCount:h.enrollmentsCount||0,enrollmentsLength:h.enrollmentsLength?parseFloat(h.enrollmentsLength):0,enrollmentsSpeechLength:h.enrollmentsSpeechLength?parseFloat(h.enrollmentsSpeechLength):0,profileId:h.profileId||h.identificationProfileId,remainingEnrollmentsSpeechLength:h.remainingEnrollmentsSpeechLength?parseFloat(h.remainingEnrollmentsSpeechLength):0}}static getVerificationDetails(h){return{audioLength:h.audioLength?parseFloat(h.audioLength):0,audioSpeechLength:h.audioSpeechLength?parseFloat(h.audioSpeechLength):0,enrollmentStatus:h.enrollmentStatus,enrollmentsCount:h.enrollmentsCount,enrollmentsLength:h.enrollmentsLength?parseFloat(h.enrollmentsLength):0,enrollmentsSpeechLength:h.enrollmentsSpeechLength?parseFloat(h.enrollmentsSpeechLength):0,profileId:h.profileId||h.verificationProfileId,remainingEnrollmentsCount:h.remainingEnrollments||h.remainingEnrollmentsCount,remainingEnrollmentsSpeechLength:h.remainingEnrollmentsSpeechLength?parseFloat(h.remainingEnrollmentsSpeechLength):0}}}e.VoiceProfileEnrollmentResult=i;class a extends n.CancellationDetailsBase{constructor(h,c,r){super(h,c,r)}static fromResult(h){const c=n.CancellationReason.Error;let r=n.CancellationErrorCode.NoError;return h.properties&&(r=n.CancellationErrorCode[h.properties.getProperty(p.CancellationErrorCodePropertyName,n.CancellationErrorCode[n.CancellationErrorCode.NoError])]),new a(c,h.errorDetails,r)}}e.VoiceProfileEnrollmentCancellationDetails=a},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VoiceProfileCancellationDetails=e.VoiceProfileResult=void 0;const p=t(2),n=t(64),i=t(79);e.VoiceProfileResult=class{constructor(s,h){this.privReason=s,this.privProperties=new i.PropertyCollection,s===i.ResultReason.Canceled&&(n.Contracts.throwIfNullOrUndefined(h,"statusText"),this.privErrorDetails=h,this.privProperties.setProperty(p.CancellationErrorCodePropertyName,i.CancellationErrorCode[i.CancellationErrorCode.ServiceError]))}get reason(){return this.privReason}get properties(){return this.privProperties}get errorDetails(){return this.privErrorDetails}};class a extends i.CancellationDetailsBase{constructor(h,c,r){super(h,c,r)}static fromResult(h){const c=i.CancellationReason.Error;let r=i.CancellationErrorCode.NoError;return h.properties&&(r=i.CancellationErrorCode[h.properties.getProperty(p.CancellationErrorCodePropertyName,i.CancellationErrorCode[i.CancellationErrorCode.NoError])]),new a(c,h.errorDetails,r)}}e.VoiceProfileCancellationDetails=a},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VoiceProfilePhraseResult=void 0;const p=t(64),n=t(79);class i extends n.VoiceProfileResult{constructor(s,h,c,r){super(s,h),this.privPhrases=[],p.Contracts.throwIfNullOrUndefined(r,"phrase array"),this.privType=c,r&&r[0]&&(this.privPhrases=r)}get phrases(){return this.privPhrases}get type(){return this.privType}}e.VoiceProfilePhraseResult=i},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VoiceProfileClient=void 0;const p=t(2),n=t(80),i=t(64),a=t(79);class s extends a.Recognizer{constructor(c){i.Contracts.throwIfNullOrUndefined(c,"speechConfig");const r=c;i.Contracts.throwIfNull(r,"speechConfig"),super(n.AudioConfig.fromStreamInput(a.AudioInputStream.createPushStream()),r.properties,new p.VoiceProfileConnectionFactory),this.privProperties=r.properties.clone(),this.privVoiceAdapter=this.privReco,this.privDisposedVoiceAdapter=!1}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(a.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(c){i.Contracts.throwIfNullOrWhitespace(c,"token"),this.properties.setProperty(a.PropertyId.SpeechServiceAuthorization_Token,c)}async createProfileAsync(c,r){const o=await this.privVoiceAdapter.createProfile(c,r);return new a.VoiceProfile(o[0],c)}async retrieveEnrollmentResultAsync(c){return this.privVoiceAdapter.retrieveEnrollmentResult(c)}async getAllProfilesAsync(c){return this.privVoiceAdapter.getAllProfiles(c)}async getActivationPhrasesAsync(c,r){return this.privVoiceAdapter.getActivationPhrases(c,r)}async enrollProfileAsync(c,r){const o=r;return i.Contracts.throwIfNullOrUndefined(o,"audioConfig"),this.audioConfig=r,this.privVoiceAdapter.SpeakerAudioSource=o,this.privVoiceAdapter.enrollProfile(c)}async deleteProfileAsync(c){return this.privVoiceAdapter.deleteProfile(c)}async resetProfileAsync(c){return this.privVoiceAdapter.resetProfile(c)}async close(){await this.dispose(!0)}createServiceRecognizer(c,r,o,d){const u=o;return new p.VoiceServiceRecognizer(c,r,u,d,this)}async dispose(c){this.privDisposedVoiceAdapter||(this.privDisposedVoiceAdapter=!0,c&&await super.dispose(c))}createRecognizerConfig(c){return new p.RecognizerConfig(c,this.properties)}getResult(c,r){return new a.VoiceProfileResult(c.ok?r:a.ResultReason.Canceled,c.statusText)}}e.VoiceProfileClient=s},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeakerRecognizer=void 0;const p=t(2),n=t(64),i=t(79);class a extends i.Recognizer{constructor(h,c){n.Contracts.throwIfNullOrUndefined(h,"speechConfig");const r=h;n.Contracts.throwIfNullOrUndefined(r,"speechConfig"),super(c,r.properties,new p.SpeakerRecognitionConnectionFactory),this.privAudioConfigImpl=c,n.Contracts.throwIfNull(this.privAudioConfigImpl,"audioConfig"),this.privDisposedSpeakerRecognizer=!1,this.privProperties=r.properties}get authorizationToken(){return this.properties.getProperty(i.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(h){n.Contracts.throwIfNullOrWhitespace(h,"token"),this.properties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,h)}get properties(){return this.privProperties}async recognizeOnceAsync(h){return n.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),this.recognizeSpeakerOnceAsyncImpl(h)}async close(){n.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),await this.dispose(!0)}async recognizeSpeakerOnceAsyncImpl(h){n.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),await this.implRecognizerStop();const c=await this.privReco.recognizeSpeaker(h);return await this.implRecognizerStop(),c}async implRecognizerStop(){this.privReco&&await this.privReco.stopRecognizing()}createRecognizerConfig(h){return new p.RecognizerConfig(h,this.privProperties)}createServiceRecognizer(h,c,r,o){const d=r;return new p.SpeakerServiceRecognizer(h,c,d,o,this)}async dispose(h){this.privDisposedSpeakerRecognizer||h&&(this.privDisposedSpeakerRecognizer=!0,await super.dispose(h))}}e.SpeakerRecognizer=a},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeakerIdentificationModel=void 0;const p=t(64),n=t(79);class i{constructor(s){if(this.privVoiceProfiles=[],this.privProfileIds=[],p.Contracts.throwIfNullOrUndefined(s,"VoiceProfiles"),s.length===0)throw new Error("Empty Voice Profiles array");for(const h of s){if(h.profileType!==n.VoiceProfileType.TextIndependentIdentification)throw new Error("Identification model can only be created from Identification profile: "+h.profileId);this.privVoiceProfiles.push(h),this.privProfileIds.push(h.profileId)}}static fromProfiles(s){return new i(s)}get voiceProfileIds(){return this.privProfileIds.join(",")}get profileIds(){return this.privProfileIds}get scenario(){return"TextIndependentIdentification"}}e.SpeakerIdentificationModel=i},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeakerVerificationModel=void 0;const p=t(64),n=t(79);class i{constructor(s){if(p.Contracts.throwIfNullOrUndefined(s,"VoiceProfile"),s.profileType===n.VoiceProfileType.TextIndependentIdentification)throw new Error("Verification model cannot be created from Identification profile");this.privVoiceProfile=s}static fromProfile(s){return new i(s)}get voiceProfile(){return this.privVoiceProfile}get profileIds(){return[this.voiceProfile.profileId]}get scenario(){return this.voiceProfile.profileType===n.VoiceProfileType.TextDependentVerification?"TextDependentVerification":"TextIndependentVerification"}}e.SpeakerVerificationModel=i},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AutoDetectSourceLanguageConfig=void 0;const p=t(2),n=t(64),i=t(79),a=t(152);class s{constructor(){this.privProperties=new i.PropertyCollection,this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart"),this.privLanguageIdMode=a.LanguageIdMode.AtStart}static fromOpenRange(){const c=new s;return c.properties.setProperty(i.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,p.AutoDetectSourceLanguagesOpenRangeOptionName),c}static fromLanguages(c){n.Contracts.throwIfArrayEmptyOrWhitespace(c,"languages");const r=new s;return r.properties.setProperty(i.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,c.join()),r}static fromSourceLanguageConfigs(c){if(c.length<1)throw new Error("Expected non-empty SourceLanguageConfig array.");const r=new s,o=[];return c.forEach(d=>{if(o.push(d.language),d.endpointId!==void 0&&d.endpointId!==""){const u=d.language+i.PropertyId.SpeechServiceConnection_EndpointId.toString();r.properties.setProperty(u,d.endpointId)}}),r.properties.setProperty(i.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,o.join()),r}get properties(){return this.privProperties}set mode(c){c===a.LanguageIdMode.Continuous?(this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_LanguageIdMode,"Continuous")):(this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"1"),this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart")),this.privLanguageIdMode=c}}e.AutoDetectSourceLanguageConfig=s},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LanguageIdMode=void 0,function(t){t[t.AtStart=0]="AtStart",t[t.Continuous=1]="Continuous"}(e.LanguageIdMode||(e.LanguageIdMode={}))},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AutoDetectSourceLanguageResult=void 0;const p=t(64);class n{constructor(a,s){p.Contracts.throwIfNullOrUndefined(a,"language"),p.Contracts.throwIfNullOrUndefined(s,"languageDetectionConfidence"),this.privLanguage=a,this.privLanguageDetectionConfidence=s}static fromResult(a){return new n(a.language,a.languageDetectionConfidence)}static fromConversationTranscriptionResult(a){return new n(a.language,a.languageDetectionConfidence)}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}}e.AutoDetectSourceLanguageResult=n},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SourceLanguageConfig=void 0;const p=t(64);class n{constructor(a,s){p.Contracts.throwIfNullOrUndefined(a,"language"),this.privLanguage=a,this.privEndpointId=s}static fromLanguage(a,s){return new n(a,s)}get language(){return this.privLanguage}get endpointId(){return this.privEndpointId}}e.SourceLanguageConfig=n},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeakerRecognitionCancellationDetails=e.SpeakerRecognitionResult=e.SpeakerRecognitionResultType=void 0;const p=t(2),n=t(79);var i;(function(s){s[s.Verify=0]="Verify",s[s.Identify=1]="Identify"})(i=e.SpeakerRecognitionResultType||(e.SpeakerRecognitionResultType={})),e.SpeakerRecognitionResult=class{constructor(s,h=n.ResultReason.RecognizedSpeaker,c=n.CancellationErrorCode.NoError,r=""){this.privProperties=new n.PropertyCollection;const o=s.scenario==="TextIndependentIdentification"?i.Identify:i.Verify;this.privReason=h,this.privReason!==n.ResultReason.Canceled?o===i.Identify?(this.privProfileId=s.identificationResult.identifiedProfile.profileId,this.privScore=s.identificationResult.identifiedProfile.score,this.privReason=n.ResultReason.RecognizedSpeakers):(this.privScore=s.verificationResult.score,s.verificationResult.recognitionResult.toLowerCase()!=="accept"&&(this.privReason=n.ResultReason.NoMatch),s.verificationResult.profileId!==void 0&&s.verificationResult.profileId!==""&&(this.privProfileId=s.verificationResult.profileId)):(this.privErrorDetails=r,this.privProperties.setProperty(p.CancellationErrorCodePropertyName,n.CancellationErrorCode[c])),this.privProperties.setProperty(n.PropertyId.SpeechServiceResponse_JsonResult,JSON.stringify(s))}get properties(){return this.privProperties}get reason(){return this.privReason}get profileId(){return this.privProfileId}get errorDetails(){return this.privErrorDetails}get score(){return this.privScore}};class a extends n.CancellationDetailsBase{constructor(h,c,r){super(h,c,r)}static fromResult(h){const c=n.CancellationReason.Error;let r=n.CancellationErrorCode.NoError;return h.properties&&(r=n.CancellationErrorCode[h.properties.getProperty(p.CancellationErrorCodePropertyName,n.CancellationErrorCode[n.CancellationErrorCode.NoError])]),new a(c,h.errorDetails,r)}}e.SpeakerRecognitionCancellationDetails=a},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var p=t(157);Object.defineProperty(e,"Conversation",{enumerable:!0,get:function(){return p.Conversation}}),Object.defineProperty(e,"ConversationImpl",{enumerable:!0,get:function(){return p.ConversationImpl}});var n=t(158);Object.defineProperty(e,"ConversationCommon",{enumerable:!0,get:function(){return n.ConversationCommon}});var i=t(159);Object.defineProperty(e,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return i.ConversationExpirationEventArgs}});var a=t(160);Object.defineProperty(e,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return a.ConversationParticipantsChangedEventArgs}});var s=t(161);Object.defineProperty(e,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return s.ConversationTranslationCanceledEventArgs}});var h=t(162);Object.defineProperty(e,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return h.ConversationTranslationEventArgs}});var c=t(163);Object.defineProperty(e,"ConversationTranslationResult",{enumerable:!0,get:function(){return c.ConversationTranslationResult}});var r=t(164);Object.defineProperty(e,"ConversationTranslator",{enumerable:!0,get:function(){return r.ConversationTranslator}});var o=t(167);Object.defineProperty(e,"ConversationTranscriber",{enumerable:!0,get:function(){return o.ConversationTranscriber}});var d=t(168);Object.defineProperty(e,"Participant",{enumerable:!0,get:function(){return d.Participant}}),Object.defineProperty(e,"User",{enumerable:!0,get:function(){return d.User}});var u=t(169);Object.defineProperty(e,"ParticipantChangedReason",{enumerable:!0,get:function(){return u.ParticipantChangedReason}});var v=t(170);Object.defineProperty(e,"Meeting",{enumerable:!0,get:function(){return v.Meeting}}),Object.defineProperty(e,"MeetingImpl",{enumerable:!0,get:function(){return v.MeetingImpl}});var l=t(171);Object.defineProperty(e,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return l.MeetingTranscriptionCanceledEventArgs}});var g=t(172);Object.defineProperty(e,"MeetingTranscriber",{enumerable:!0,get:function(){return g.MeetingTranscriber}});var m=t(173);Object.defineProperty(e,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return m.ConversationTranscriptionResult}})},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationImpl=e.Conversation=void 0;const p=t(2),n=t(4),i=t(64),a=t(79);class s{constructor(){}static createConversationAsync(r,o,d,u){let v,l,g;return i.Contracts.throwIfNullOrUndefined(r,p.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),i.Contracts.throwIfNullOrUndefined(r.region,p.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),r.subscriptionKey||r.getProperty(a.PropertyId[a.PropertyId.SpeechServiceAuthorization_Token])||i.Contracts.throwIfNullOrUndefined(r.subscriptionKey,p.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key")),typeof o=="string"?(v=new h(r,o),n.marshalPromiseToCallbacks((async()=>{})(),d,u)):(v=new h(r),l=o,g=d,v.createConversationAsync(()=>{l&&l()},m=>{g&&g(m)})),v}}e.Conversation=s;class h extends s{constructor(r,o){if(super(),this.privErrors=p.ConversationConnectionConfig.restErrors,this.onConnected=u=>{this.privIsConnected=!0;try{this.privConversationTranslator?.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,u)}catch{}},this.onDisconnected=u=>{try{this.privConversationTranslator?.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,u)}catch{}finally{this.close(!1)}},this.onCanceled=(u,v)=>{try{this.privConversationTranslator?.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,v)}catch{}},this.onParticipantUpdateCommandReceived=(u,v)=>{try{const l=this.privParticipants.getParticipant(v.id);if(l!==void 0){switch(v.key){case p.ConversationTranslatorCommandTypes.changeNickname:l.displayName=v.value;break;case p.ConversationTranslatorCommandTypes.setUseTTS:l.isUsingTts=v.value;break;case p.ConversationTranslatorCommandTypes.setProfanityFiltering:l.profanity=v.value;break;case p.ConversationTranslatorCommandTypes.setMute:l.isMuted=v.value;break;case p.ConversationTranslatorCommandTypes.setTranslateToLanguages:l.translateToLanguages=v.value}this.privParticipants.addOrUpdateParticipant(l),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new a.ConversationParticipantsChangedEventArgs(a.ParticipantChangedReason.Updated,[this.toParticipant(l)],v.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(u,v)=>{try{this.privParticipants.participants.forEach(l=>l.isMuted=!l.isHost&&v.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new a.ConversationParticipantsChangedEventArgs(a.ParticipantChangedReason.Updated,this.toParticipants(!1),v.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(u,v)=>{try{const l=this.privParticipants.addOrUpdateParticipant(v.participant);l!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new a.ConversationParticipantsChangedEventArgs(a.ParticipantChangedReason.JoinedConversation,[this.toParticipant(l)],v.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(u,v)=>{try{const l=this.privParticipants.getParticipant(v.participant.id);l!==void 0&&(this.privParticipants.deleteParticipant(v.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new a.ConversationParticipantsChangedEventArgs(a.ParticipantChangedReason.LeftConversation,[this.toParticipant(l)],v.sessionId)))}catch{}},this.onTranslationReceived=(u,v)=>{try{switch(v.command){case p.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new a.ConversationTranslationEventArgs(v.payload,void 0,v.sessionId));break;case p.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new a.ConversationTranslationEventArgs(v.payload,void 0,v.sessionId));break;case p.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new a.ConversationTranslationEventArgs(v.payload,void 0,v.sessionId))}}catch{}},this.onParticipantsListReceived=(u,v)=>{try{if(v.sessionToken!==void 0&&v.sessionToken!==null&&(this.privRoom.token=v.sessionToken),this.privParticipants.participants=[...v.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new a.ConversationParticipantsChangedEventArgs(a.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),v.sessionId)),this.me.isHost){const l=this.privConversationTranslator?.properties.getProperty(a.PropertyId.ConversationTranslator_Name);l!==void 0&&l.length>0&&l!==this.me.displayName&&this.changeNicknameAsync(l)}}catch{}},this.onConversationExpiration=(u,v)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,v)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new a.PropertyCollection,this.privManager=new p.ConversationManager,r.getProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_RecoLanguage])||r.setProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_RecoLanguage],p.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=r.getProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_RecoLanguage]),o)this.privConversationId=o;else{r.targetLanguages.length===0&&r.addTargetLanguage(this.privLanguage),r.getProperty(a.PropertyId[a.PropertyId.SpeechServiceResponse_ProfanityOption])||r.setProfanity(a.ProfanityOption.Masked);let u=r.getProperty(a.PropertyId[a.PropertyId.ConversationTranslator_Name]);u==null&&(u="Host"),i.Contracts.throwIfNullOrTooLong(u,"nickname",50),i.Contracts.throwIfNullOrTooShort(u,"nickname",2),r.setProperty(a.PropertyId[a.PropertyId.ConversationTranslator_Name],u)}this.privConfig=r;const d=r;i.Contracts.throwIfNull(d,"speechConfig"),this.privProperties=d.properties.clone(),this.privIsConnected=!1,this.privParticipants=new p.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get conversationId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){return!this.privParticipants.me?.isHost&&this.privParticipants.me?.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get conversationInfo(){const r=this.conversationId,o=this.participants.map(u=>({id:u.id,preferredLanguage:u.preferredLanguage,voice:u.voice})),d={};for(const u of p.ConversationConnectionConfig.transcriptionEventKeys){const v=this.properties.getProperty(u,"");v!==""&&(d[u]=v)}return{id:r,participants:o,conversationProperties:d}}get canSend(){return this.privIsConnected&&!this.privParticipants.me?.isMuted}get canSendAsHost(){return this.privIsConnected&&this.privParticipants.me?.isHost}get authorizationToken(){return this.privToken}set authorizationToken(r){i.Contracts.throwIfNullOrWhitespace(r,"authorizationToken"),this.privToken=r}set conversationTranslator(r){this.privConversationTranslator=r}onToken(r){this.privConversationTranslator.onToken(r)}createConversationAsync(r,o){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),o),this.privManager.createOrJoin(this.privProperties,void 0,d=>{d||this.handleError(new Error(this.privErrors.permissionDeniedConnect),o),this.privRoom=d,this.handleCallback(r,o)},d=>{this.handleError(d,o)})}catch(d){this.handleError(d,o)}}startConversationAsync(r,o){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),o),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer=p.ConversationRecognizerFactory.fromConfig(this,this.privConfig),this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,()=>{this.handleCallback(r,o)},d=>{this.handleError(d,o)})}catch(d){this.handleError(d,o)}}addParticipantAsync(r,o,d){i.Contracts.throwIfNullOrUndefined(r,"Participant"),n.marshalPromiseToCallbacks(this.addParticipantImplAsync(r),o,d)}joinConversationAsync(r,o,d,u,v){try{i.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","conversationId")),i.Contracts.throwIfNullOrWhitespace(o,this.privErrors.invalidArgs.replace("{arg}","nickname")),i.Contracts.throwIfNullOrWhitespace(d,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,r,l=>{i.Contracts.throwIfNullOrUndefined(l,this.privErrors.permissionDeniedConnect),this.privRoom=l,this.privConfig.authorizationToken=l.cognitiveSpeechAuthToken,u&&u(l.cognitiveSpeechAuthToken)},l=>{this.handleError(l,v)})}catch(l){this.handleError(l,v)}}deleteConversationAsync(r,o){n.marshalPromiseToCallbacks(this.deleteConversationImplAsync(),r,o)}async deleteConversationImplAsync(){i.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),i.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endConversationAsync(r,o){n.marshalPromiseToCallbacks(this.endConversationImplAsync(),r,o)}endConversationImplAsync(){return this.close(!0)}lockConversationAsync(r,o){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),o),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),()=>{this.handleCallback(r,o)},d=>{this.handleError(d,o)})}catch(d){this.handleError(d,o)}}muteAllParticipantsAsync(r,o){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),o),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),()=>{this.handleCallback(r,o)},d=>{this.handleError(d,o)})}catch(d){this.handleError(d,o)}}muteParticipantAsync(r,o,d){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","userId")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),d),this.me.isHost||this.me.id===r||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),d),this.privParticipants.getParticipantIndex(r)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),d),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(r,!0),()=>{this.handleCallback(o,d)},u=>{this.handleError(u,d)})}catch(u){this.handleError(u,d)}}removeParticipantAsync(r,o,d){try{if(i.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&r.hasOwnProperty("id"))n.marshalPromiseToCallbacks(this.removeParticipantImplAsync(r),o,d);else{i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),d);let u="";typeof r=="string"?u=r:r.hasOwnProperty("id")?u=r.id:r.hasOwnProperty("userId")&&(u=r.userId),i.Contracts.throwIfNullOrWhitespace(u,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(v=>v.id===u)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),d),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(u),()=>{this.handleCallback(o,d)},v=>{this.handleError(v,d)})}}catch(u){this.handleError(u,d)}}unlockConversationAsync(r,o){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),o),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),()=>{this.handleCallback(r,o)},d=>{this.handleError(d,o)})}catch(d){this.handleError(d,o)}}unmuteAllParticipantsAsync(r,o){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),o),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),()=>{this.handleCallback(r,o)},d=>{this.handleError(d,o)})}catch(d){this.handleError(d,o)}}unmuteParticipantAsync(r,o,d){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","userId")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),d),this.me.isHost||this.me.id===r||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),d),this.privParticipants.getParticipantIndex(r)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),d),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(r,!1),()=>{this.handleCallback(o,d)},u=>{this.handleError(u,d)})}catch(u){this.handleError(u,d)}}sendTextMessageAsync(r,o,d){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","message")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),d),r.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),d),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(r),()=>{this.handleCallback(o,d)},u=>{this.handleError(u,d)})}catch(u){this.handleError(u,d)}}setTranslatedLanguagesAsync(r,o,d){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfArrayEmptyOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","languages")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),d),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(r),()=>{this.handleCallback(o,d)},u=>{this.handleError(u,d)})}catch(u){this.handleError(u,d)}}changeNicknameAsync(r,o,d){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","nickname")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),d),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(r),()=>{this.handleCallback(o,d)},u=>{this.handleError(u,d)})}catch(u){this.handleError(u,d)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(r){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await r.enforceAudioGating(),this.privTranscriberRecognizer=r,this.privTranscriberRecognizer.conversation=this}getKeepAlive(){const r=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:r,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:p.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(r){if(this.privParticipants.addOrUpdateParticipant(r)!==void 0&&this.privTranscriberRecognizer){const o=this.conversationInfo;return o.participants=[r],this.privTranscriberRecognizer.pushConversationEvent(o,"join")}}removeParticipantImplAsync(r){this.privParticipants.deleteParticipant(r.id);const o=this.conversationInfo;return o.participants=[r],this.privTranscriberRecognizer.pushConversationEvent(o,"leave")}async close(r){try{this.privIsConnected=!1,await this.privConversationRecognizer?.close(),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(o){throw o}r&&this.dispose()}handleCallback(r,o){if(r){try{r()}catch(d){o&&o(d)}r=void 0}}handleError(r,o){if(o)if(r instanceof Error){const d=r;o(d.name+": "+d.message)}else o(r)}toParticipants(r){const o=this.privParticipants.participants.map(d=>this.toParticipant(d));return r?o:o.filter(d=>d.isHost===!1)}toParticipant(r){return new a.Participant(r.id,r.avatar,r.displayName,r.isHost,r.isMuted,r.isUsingTts,r.preferredLanguage,r.voice)}getMuteAllCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:p.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:p.ConversationTranslatorMessageTypes.participantCommand,value:r})}getMuteCommand(r,o){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(r,"participantId"),JSON.stringify({command:p.ConversationTranslatorCommandTypes.setMute,participantId:r,roomid:this.privRoom.roomId,type:p.ConversationTranslatorMessageTypes.participantCommand,value:o})}getLockCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:p.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:p.ConversationTranslatorMessageTypes.participantCommand,value:r})}getEjectCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(r,"participantId"),JSON.stringify({command:p.ConversationTranslatorCommandTypes.ejectParticipant,participantId:r,roomid:this.privRoom.roomId,type:p.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:p.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:p.ConversationTranslatorMessageTypes.participantCommand,value:r})}getChangeNicknameCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(r,"nickname"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:p.ConversationTranslatorCommandTypes.changeNickname,nickname:r,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:p.ConversationTranslatorMessageTypes.participantCommand,value:r})}getMessageCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),i.Contracts.throwIfNullOrWhitespace(r,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:r,type:p.ConversationTranslatorMessageTypes.instantMessage})}}e.ConversationImpl=h},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationCommon=void 0,e.ConversationCommon=class{constructor(t){this.privAudioConfig=t}handleCallback(t,p){if(t){try{t()}catch(n){p&&p(n)}t=void 0}}handleError(t,p){if(p)if(t instanceof Error){const n=t;p(n.name+": "+n.message)}else p(t)}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationExpirationEventArgs=void 0;const p=t(79);class n extends p.SessionEventArgs{constructor(a,s){super(s),this.privExpirationTime=a}get expirationTime(){return this.privExpirationTime}}e.ConversationExpirationEventArgs=n},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationParticipantsChangedEventArgs=void 0;const p=t(79);class n extends p.SessionEventArgs{constructor(a,s,h){super(h),this.privReason=a,this.privParticipant=s}get reason(){return this.privReason}get participants(){return this.privParticipant}}e.ConversationParticipantsChangedEventArgs=n},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationTranslationCanceledEventArgs=void 0;const p=t(101);class n extends p.CancellationEventArgsBase{}e.ConversationTranslationCanceledEventArgs=n},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationTranslationEventArgs=void 0;const p=t(79);class n extends p.RecognitionEventArgs{constructor(a,s,h){super(s,h),this.privResult=a}get result(){return this.privResult}}e.ConversationTranslationEventArgs=n},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationTranslationResult=void 0;const p=t(104);class n extends p.TranslationRecognitionResult{constructor(a,s,h,c,r,o,d,u,v,l,g){super(s,c,r,o,d,u,void 0,void 0,v,l,g),this.privId=a,this.privOrigLang=h}get participantId(){return this.privId}get originalLang(){return this.privOrigLang}}e.ConversationTranslationResult=n},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationTranslator=e.SpeechState=void 0;const p=t(2),n=t(165),i=t(4),a=t(64),s=t(79),h=t(157),c=t(156);var r;(function(u){u[u.Inactive=0]="Inactive",u[u.Connecting=1]="Connecting",u[u.Connected=2]="Connected"})(r=e.SpeechState||(e.SpeechState={}));class o extends s.TranslationRecognizer{constructor(v,l,g,m){super(v,l,new n.ConversationTranslatorConnectionFactory(m)),this.privSpeechState=r.Inactive,g&&(this.privTranslator=g,this.sessionStarted=()=>{this.privSpeechState=r.Connected},this.sessionStopped=()=>{this.privSpeechState=r.Inactive},this.recognizing=(S,y)=>{this.privTranslator.recognizing&&this.privTranslator.recognizing(this.privTranslator,y)},this.recognized=async(S,y)=>{y.result?.errorDetails?(await this.cancelSpeech(),this.fireCancelEvent(y.result.errorDetails)):this.privTranslator.recognized&&this.privTranslator.recognized(this.privTranslator,y)},this.canceled=async()=>{if(this.privSpeechState!==r.Inactive)try{await this.cancelSpeech()}catch{this.privSpeechState=r.Inactive}})}get state(){return this.privSpeechState}set state(v){this.privSpeechState=v}set authentication(v){this.privReco.authentication=v}onConnection(){this.privSpeechState=r.Connected}async onCancelSpeech(){this.privSpeechState=r.Inactive,await this.cancelSpeech()}fireCancelEvent(v){try{if(this.privTranslator.canceled){const l=new c.ConversationTranslationCanceledEventArgs(s.CancellationReason.Error,v,s.CancellationErrorCode.RuntimeError);this.privTranslator.canceled(this.privTranslator,l)}}catch{}}async cancelSpeech(){try{this.stopContinuousRecognitionAsync(),await this.privReco?.disconnect(),this.privSpeechState=r.Inactive}catch{}}}class d extends c.ConversationCommon{constructor(v){super(v),this.privErrors=p.ConversationConnectionConfig.restErrors,this.privIsDisposed=!1,this.privIsSpeaking=!1,this.privPlaceholderKey="abcdefghijklmnopqrstuvwxyz012345",this.privPlaceholderRegion="westus",this.privProperties=new s.PropertyCollection}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get participants(){return this.privConversation?.participants}get canSpeak(){return!(!this.privConversation.isConnected||!this.privCTRecognizer)&&!this.privIsSpeaking&&this.privCTRecognizer.state!==r.Connected&&this.privCTRecognizer.state!==r.Connecting&&!this.privConversation.isMutedByHost}onToken(v){this.privCTRecognizer.authentication=v}setServiceProperty(v,l){const g=JSON.parse(this.privProperties.getProperty(p.ServicePropertiesPropertyName,"{}"));g[v]=l,this.privProperties.setProperty(p.ServicePropertiesPropertyName,JSON.stringify(g))}joinConversationAsync(v,l,g,m,S){try{if(typeof v=="string"){a.Contracts.throwIfNullOrUndefined(v,this.privErrors.invalidArgs.replace("{arg}","conversation id")),a.Contracts.throwIfNullOrWhitespace(l,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privConversation&&this.handleError(new Error(this.privErrors.permissionDeniedStart),S);let y=g;y!=null&&y!==""||(y=p.ConversationConnectionConfig.defaultLanguageCode),this.privSpeechTranslationConfig=s.SpeechTranslationConfig.fromSubscription(this.privPlaceholderKey,this.privPlaceholderRegion),this.privSpeechTranslationConfig.setProfanity(s.ProfanityOption.Masked),this.privSpeechTranslationConfig.addTargetLanguage(y),this.privSpeechTranslationConfig.setProperty(s.PropertyId[s.PropertyId.SpeechServiceConnection_RecoLanguage],y),this.privSpeechTranslationConfig.setProperty(s.PropertyId[s.PropertyId.ConversationTranslator_Name],l);const C=[s.PropertyId.SpeechServiceConnection_Host,s.PropertyId.ConversationTranslator_Host,s.PropertyId.SpeechServiceConnection_Endpoint,s.PropertyId.SpeechServiceConnection_ProxyHostName,s.PropertyId.SpeechServiceConnection_ProxyPassword,s.PropertyId.SpeechServiceConnection_ProxyPort,s.PropertyId.SpeechServiceConnection_ProxyUserName,"ConversationTranslator_MultiChannelAudio","ConversationTranslator_Region"];for(const R of C){const I=this.privProperties.getProperty(R);if(I){const T=typeof R=="string"?R:s.PropertyId[R];this.privSpeechTranslationConfig.setProperty(T,I)}}const P=JSON.parse(this.privProperties.getProperty(p.ServicePropertiesPropertyName,"{}"));for(const R of Object.keys(P))this.privSpeechTranslationConfig.setServiceProperty(R,P[R],s.ServicePropertyChannel.UriQueryParameter);this.privConversation=new h.ConversationImpl(this.privSpeechTranslationConfig),this.privConversation.conversationTranslator=this,this.privConversation.joinConversationAsync(v,l,y,R=>{R||this.handleError(new Error(this.privErrors.permissionDeniedConnect),S),this.privSpeechTranslationConfig.authorizationToken=R,this.privConversation.room.isHost=!1,this.privConversation.startConversationAsync(()=>{this.handleCallback(m,S)},I=>{this.handleError(I,S)})},R=>{this.handleError(R,S)})}else typeof v=="object"?(a.Contracts.throwIfNullOrUndefined(v,this.privErrors.invalidArgs.replace("{arg}","conversation id")),a.Contracts.throwIfNullOrWhitespace(l,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privProperties.setProperty(s.PropertyId.ConversationTranslator_Name,l),this.privConversation=v,this.privConversation.conversationTranslator=this,this.privConversation.room.isHost=!0,a.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedConnect),a.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privSpeechTranslationConfig=v.config,this.handleCallback(g,m)):this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","invalid conversation type")),m)}catch(y){this.handleError(y,typeof g=="string"?S:m)}}leaveConversationAsync(v,l){i.marshalPromiseToCallbacks((async()=>{await this.cancelSpeech(),await this.privConversation.endConversationImplAsync(),await this.privConversation.deleteConversationImplAsync(),this.dispose()})(),v,l)}sendTextMessageAsync(v,l,g){try{a.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),a.Contracts.throwIfNullOrWhitespace(v,this.privErrors.invalidArgs.replace("{arg}",v)),this.privConversation.sendTextMessageAsync(v,l,g)}catch(m){this.handleError(m,g)}}startTranscribingAsync(v,l){i.marshalPromiseToCallbacks((async()=>{try{a.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),a.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privCTRecognizer===void 0&&await this.connectTranslatorRecognizer(),a.Contracts.throwIfNullOrUndefined(this.privCTRecognizer,this.privErrors.permissionDeniedSend),this.canSpeak||this.handleError(new Error(this.privErrors.permissionDeniedSend),l),await this.startContinuousRecognition(),this.privIsSpeaking=!0}catch(g){throw this.privIsSpeaking=!1,await this.cancelSpeech(),g}})(),v,l)}stopTranscribingAsync(v,l){i.marshalPromiseToCallbacks((async()=>{try{if(!this.privIsSpeaking)return void await this.cancelSpeech();this.privIsSpeaking=!1,await new Promise((g,m)=>{this.privCTRecognizer.stopContinuousRecognitionAsync(g,m)})}catch{await this.cancelSpeech()}})(),v,l)}isDisposed(){return this.privIsDisposed}dispose(v,l,g){i.marshalPromiseToCallbacks((async()=>{this.isDisposed&&!this.privIsSpeaking||(await this.cancelSpeech(),this.privIsDisposed=!0,this.privSpeechTranslationConfig.close(),this.privSpeechRecognitionLanguage=void 0,this.privProperties=void 0,this.privAudioConfig=void 0,this.privSpeechTranslationConfig=void 0,this.privConversation.dispose(),this.privConversation=void 0)})(),l,g)}async cancelSpeech(){try{this.privIsSpeaking=!1,await this.privCTRecognizer?.onCancelSpeech(),this.privCTRecognizer=void 0}catch{}}async connectTranslatorRecognizer(){try{this.privAudioConfig===void 0&&(this.privAudioConfig=s.AudioConfig.fromDefaultMicrophoneInput()),this.privSpeechTranslationConfig.getProperty(s.PropertyId[s.PropertyId.SpeechServiceConnection_Key])===this.privPlaceholderKey&&this.privSpeechTranslationConfig.setProperty(s.PropertyId[s.PropertyId.SpeechServiceConnection_Key],"");const v=()=>this.privConversation;this.privCTRecognizer=new o(this.privSpeechTranslationConfig,this.privAudioConfig,this,v)}catch(v){throw await this.cancelSpeech(),v}}startContinuousRecognition(){return new Promise((v,l)=>{this.privCTRecognizer.startContinuousRecognitionAsync(v,l)})}}e.ConversationTranslator=d},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationTranslatorConnectionFactory=void 0;const p=t(60),n=t(166),i=t(64),a=t(79),s=t(54),h=t(135),c=t(134),r=t(2);class o extends c.ConnectionFactoryBase{constructor(u){super(),i.Contracts.throwIfNullOrUndefined(u,"convGetter"),this.privConvGetter=u}create(u,v,l){const g=u.parameters.getProperty("ConversationTranslator_MultiChannelAudio","").toUpperCase()==="TRUE",m=this.privConvGetter().room,S=m.cognitiveSpeechRegion||u.parameters.getProperty(a.PropertyId.SpeechServiceConnection_Region,""),y={hostSuffix:c.ConnectionFactoryBase.getHostSuffix(S),path:o.CTS_VIRT_MIC_PATH,region:encodeURIComponent(S)};y[h.QueryParameterNames.Language]=encodeURIComponent(u.parameters.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage,"")),y[h.QueryParameterNames.CtsMeetingId]=encodeURIComponent(m.roomId),y[h.QueryParameterNames.CtsDeviceId]=encodeURIComponent(m.participantId),y[h.QueryParameterNames.CtsIsParticipant]=m.isHost?"":"&"+h.QueryParameterNames.CtsIsParticipant;let C="";const P={},R={};if(g){C=u.parameters.getProperty(a.PropertyId.SpeechServiceConnection_Endpoint),!C&&(C="wss://"+u.parameters.getProperty(a.PropertyId.SpeechServiceConnection_Host,"transcribe.{region}.cts.speech{hostSuffix}")+"{path}"),C=n.StringUtils.formatString(C,y);const T=new URL(C);T.searchParams.forEach((w,E)=>{P[E]=w}),new r.TranscriberConnectionFactory().setQueryParams(P,u,C),P[h.QueryParameterNames.CtsMeetingId]=y[h.QueryParameterNames.CtsMeetingId],P[h.QueryParameterNames.CtsDeviceId]=y[h.QueryParameterNames.CtsDeviceId],m.isHost||(P[h.QueryParameterNames.CtsIsParticipant]=""),h.QueryParameterNames.Format in P||(P[h.QueryParameterNames.Format]="simple"),T.searchParams.forEach((w,E)=>{T.searchParams.set(E,P[E]),delete P[E]}),C=T.toString()}else{const T=new r.TranslationConnectionFactory;C=T.getEndpointUrl(u,!0),C=n.StringUtils.formatString(C,y),T.setQueryParams(P,u,C)}R[s.HeaderNames.ConnectionId]=l,R[p.RestConfigBase.configParams.token]=m.token,v.token&&(R[v.headerName]=v.token);const I=u.parameters.getProperty("SPEECH-EnableWebsocketCompression","").toUpperCase()==="TRUE";return new p.WebsocketConnection(C,P,R,new r.WebsocketMessageFormatter,p.ProxyInfo.fromRecognizerConfig(u),I,l)}}e.ConversationTranslatorConnectionFactory=o,o.CTS_VIRT_MIC_PATH="/speech/recognition/dynamicaudio"},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StringUtils=void 0,e.StringUtils=class{static formatString(t,p){if(!t)return"";if(!p)return t;let n="",i="";const a=c=>{n+=c},s=c=>{i+=c};let h=a;for(let c=0;c<t.length;c++){const r=t[c],o=c+1<t.length?t[c+1]:"";switch(r){case"{":o==="{"?(h("{"),c++):h=s;break;case"}":o==="}"?(h("}"),c++):(p.hasOwnProperty(i)&&(n+=p[i]),h=a,i="");break;default:h(r)}}return n}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationTranscriber=void 0;const p=t(2),n=t(4),i=t(64),a=t(79);class s extends a.Recognizer{constructor(c,r){const o=c;i.Contracts.throwIfNull(o,"speechConfig"),i.Contracts.throwIfNullOrWhitespace(o.properties.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage),a.PropertyId[a.PropertyId.SpeechServiceConnection_RecoLanguage]),super(r,o.properties,new p.ConversationTranscriberConnectionFactory),this.privProperties.setProperty(a.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privDisposedRecognizer=!1}static FromConfig(c,r,o){const d=c;return r.properties.mergeTo(d.properties),new s(c,o)}get endpointId(){return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(a.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(c){i.Contracts.throwIfNullOrWhitespace(c,"token"),this.properties.setProperty(a.PropertyId.SpeechServiceAuthorization_Token,c)}get speechRecognitionLanguage(){return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(p.OutputFormatPropertyName,a.OutputFormat[a.OutputFormat.Simple])===a.OutputFormat[a.OutputFormat.Simple]?a.OutputFormat.Simple:a.OutputFormat.Detailed}get properties(){return this.privProperties}startTranscribingAsync(c,r){n.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(p.RecognitionMode.Conversation),c,r)}stopTranscribingAsync(c,r){n.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),c,r)}close(c,r){i.Contracts.throwIfDisposed(this.privDisposedRecognizer),n.marshalPromiseToCallbacks(this.dispose(!0),c,r)}async dispose(c){this.privDisposedRecognizer||(c&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(c))}createRecognizerConfig(c){return new p.RecognizerConfig(c,this.privProperties)}createServiceRecognizer(c,r,o,d){const u=o;return d.isSpeakerDiarizationEnabled=!0,new p.ConversationTranscriptionServiceRecognizer(c,r,u,d,this)}}e.ConversationTranscriber=s},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Participant=e.User=void 0;const p=t(79);e.User=class{constructor(i){this.privUserId=i}get userId(){return this.privUserId}};class n{constructor(a,s,h,c,r,o,d,u){this.privId=a,this.privAvatar=s,this.privDisplayName=h,this.privIsHost=c,this.privIsMuted=r,this.privIsUsingTts=o,this.privPreferredLanguage=d,this.privVoice=u,this.privProperties=new p.PropertyCollection}get avatar(){return this.privAvatar}get displayName(){return this.privDisplayName}get id(){return this.privId}get preferredLanguage(){return this.privPreferredLanguage}get isHost(){return this.privIsHost}get isMuted(){return this.privIsMuted}get isUsingTts(){return this.privIsUsingTts}get voice(){return this.privVoice}get properties(){return this.privProperties}static From(a,s,h){return new n(a,"",a,!1,!1,!1,s,h)}}e.Participant=n},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ParticipantChangedReason=void 0,function(t){t[t.JoinedConversation=0]="JoinedConversation",t[t.LeftConversation=1]="LeftConversation",t[t.Updated=2]="Updated"}(e.ParticipantChangedReason||(e.ParticipantChangedReason={}))},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MeetingImpl=e.Meeting=void 0;const p=t(2),n=t(4),i=t(64),a=t(79);class s{constructor(){}static createMeetingAsync(r,o,d,u){if(i.Contracts.throwIfNullOrUndefined(r,p.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),i.Contracts.throwIfNullOrUndefined(r.region,p.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),i.Contracts.throwIfNull(o,"meetingId"),o.length===0)throw new Error("meetingId cannot be empty");r.subscriptionKey||r.getProperty(a.PropertyId[a.PropertyId.SpeechServiceAuthorization_Token])||i.Contracts.throwIfNullOrUndefined(r.subscriptionKey,p.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));const v=new h(r,o);return n.marshalPromiseToCallbacks((async()=>{})(),d,u),v}}e.Meeting=s;class h extends s{constructor(r,o){super(),this.privErrors=p.ConversationConnectionConfig.restErrors,this.onConnected=u=>{this.privIsConnected=!0;try{this.privConversationTranslator?.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,u)}catch{}},this.onDisconnected=u=>{try{this.privConversationTranslator?.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,u)}catch{}finally{this.close(!1)}},this.onCanceled=(u,v)=>{try{this.privConversationTranslator?.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,v)}catch{}},this.onParticipantUpdateCommandReceived=(u,v)=>{try{const l=this.privParticipants.getParticipant(v.id);if(l!==void 0){switch(v.key){case p.ConversationTranslatorCommandTypes.changeNickname:l.displayName=v.value;break;case p.ConversationTranslatorCommandTypes.setUseTTS:l.isUsingTts=v.value;break;case p.ConversationTranslatorCommandTypes.setProfanityFiltering:l.profanity=v.value;break;case p.ConversationTranslatorCommandTypes.setMute:l.isMuted=v.value;break;case p.ConversationTranslatorCommandTypes.setTranslateToLanguages:l.translateToLanguages=v.value}this.privParticipants.addOrUpdateParticipant(l),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new a.ConversationParticipantsChangedEventArgs(a.ParticipantChangedReason.Updated,[this.toParticipant(l)],v.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(u,v)=>{try{this.privParticipants.participants.forEach(l=>l.isMuted=!l.isHost&&v.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new a.ConversationParticipantsChangedEventArgs(a.ParticipantChangedReason.Updated,this.toParticipants(!1),v.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(u,v)=>{try{const l=this.privParticipants.addOrUpdateParticipant(v.participant);l!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new a.ConversationParticipantsChangedEventArgs(a.ParticipantChangedReason.JoinedConversation,[this.toParticipant(l)],v.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(u,v)=>{try{const l=this.privParticipants.getParticipant(v.participant.id);l!==void 0&&(this.privParticipants.deleteParticipant(v.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new a.ConversationParticipantsChangedEventArgs(a.ParticipantChangedReason.LeftConversation,[this.toParticipant(l)],v.sessionId)))}catch{}},this.onTranslationReceived=(u,v)=>{try{switch(v.command){case p.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new a.ConversationTranslationEventArgs(v.payload,void 0,v.sessionId));break;case p.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new a.ConversationTranslationEventArgs(v.payload,void 0,v.sessionId));break;case p.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new a.ConversationTranslationEventArgs(v.payload,void 0,v.sessionId))}}catch{}},this.onParticipantsListReceived=(u,v)=>{try{if(v.sessionToken!==void 0&&v.sessionToken!==null&&(this.privRoom.token=v.sessionToken),this.privParticipants.participants=[...v.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new a.ConversationParticipantsChangedEventArgs(a.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),v.sessionId)),this.me.isHost){const l=this.privConversationTranslator?.properties.getProperty(a.PropertyId.ConversationTranslator_Name);l!==void 0&&l.length>0&&l!==this.me.displayName&&this.changeNicknameAsync(l)}}catch{}},this.onConversationExpiration=(u,v)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,v)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new a.PropertyCollection,this.privManager=new p.ConversationManager,r.getProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_RecoLanguage])||r.setProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_RecoLanguage],p.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=r.getProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_RecoLanguage]),this.privConversationId=o,this.privConfig=r;const d=r;i.Contracts.throwIfNull(d,"speechConfig"),this.privProperties=d.properties.clone(),this.privIsConnected=!1,this.privParticipants=new p.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get meetingId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){return!this.privParticipants.me?.isHost&&this.privParticipants.me?.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get meetingInfo(){const r=this.meetingId,o=this.participants.map(u=>({id:u.id,preferredLanguage:u.preferredLanguage,voice:u.voice})),d={};for(const u of p.ConversationConnectionConfig.transcriptionEventKeys){const v=this.properties.getProperty(u,"");v!==""&&(d[u]=v)}return{id:r,participants:o,meetingProperties:d}}get canSend(){return this.privIsConnected&&!this.privParticipants.me?.isMuted}get canSendAsHost(){return this.privIsConnected&&this.privParticipants.me?.isHost}get authorizationToken(){return this.privToken}set authorizationToken(r){i.Contracts.throwIfNullOrWhitespace(r,"authorizationToken"),this.privToken=r}createMeetingAsync(r,o){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),o),this.privManager.createOrJoin(this.privProperties,void 0,d=>{d||this.handleError(new Error(this.privErrors.permissionDeniedConnect),o),this.privRoom=d,this.handleCallback(r,o)},d=>{this.handleError(d,o)})}catch(d){this.handleError(d,o)}}startMeetingAsync(r,o){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),o),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,()=>{this.handleCallback(r,o)},d=>{this.handleError(d,o)})}catch(d){this.handleError(d,o)}}addParticipantAsync(r,o,d){i.Contracts.throwIfNullOrUndefined(r,"Participant"),n.marshalPromiseToCallbacks(this.addParticipantImplAsync(r),o,d)}joinMeetingAsync(r,o,d,u,v){try{i.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","conversationId")),i.Contracts.throwIfNullOrWhitespace(o,this.privErrors.invalidArgs.replace("{arg}","nickname")),i.Contracts.throwIfNullOrWhitespace(d,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,r,l=>{i.Contracts.throwIfNullOrUndefined(l,this.privErrors.permissionDeniedConnect),this.privRoom=l,this.privConfig.authorizationToken=l.cognitiveSpeechAuthToken,u&&u(l.cognitiveSpeechAuthToken)},l=>{this.handleError(l,v)})}catch(l){this.handleError(l,v)}}deleteMeetingAsync(r,o){n.marshalPromiseToCallbacks(this.deleteMeetingImplAsync(),r,o)}async deleteMeetingImplAsync(){i.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),i.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endMeetingAsync(r,o){n.marshalPromiseToCallbacks(this.endMeetingImplAsync(),r,o)}endMeetingImplAsync(){return this.close(!0)}lockMeetingAsync(r,o){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),o),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),()=>{this.handleCallback(r,o)},d=>{this.handleError(d,o)})}catch(d){this.handleError(d,o)}}muteAllParticipantsAsync(r,o){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),o),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),()=>{this.handleCallback(r,o)},d=>{this.handleError(d,o)})}catch(d){this.handleError(d,o)}}muteParticipantAsync(r,o,d){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","userId")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),d),this.me.isHost||this.me.id===r||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),d),this.privParticipants.getParticipantIndex(r)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),d),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(r,!0),()=>{this.handleCallback(o,d)},u=>{this.handleError(u,d)})}catch(u){this.handleError(u,d)}}removeParticipantAsync(r,o,d){try{if(i.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&r.hasOwnProperty("id"))n.marshalPromiseToCallbacks(this.removeParticipantImplAsync(r),o,d);else{i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),d);let u="";typeof r=="string"?u=r:r.hasOwnProperty("id")?u=r.id:r.hasOwnProperty("userId")&&(u=r.userId),i.Contracts.throwIfNullOrWhitespace(u,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(v=>v.id===u)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),d),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(u),()=>{this.handleCallback(o,d)},v=>{this.handleError(v,d)})}}catch(u){this.handleError(u,d)}}unlockMeetingAsync(r,o){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),o),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),()=>{this.handleCallback(r,o)},d=>{this.handleError(d,o)})}catch(d){this.handleError(d,o)}}unmuteAllParticipantsAsync(r,o){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),o),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),()=>{this.handleCallback(r,o)},d=>{this.handleError(d,o)})}catch(d){this.handleError(d,o)}}unmuteParticipantAsync(r,o,d){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","userId")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),d),this.me.isHost||this.me.id===r||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),d),this.privParticipants.getParticipantIndex(r)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),d),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(r,!1),()=>{this.handleCallback(o,d)},u=>{this.handleError(u,d)})}catch(u){this.handleError(u,d)}}sendTextMessageAsync(r,o,d){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","message")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),d),r.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),d),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(r),()=>{this.handleCallback(o,d)},u=>{this.handleError(u,d)})}catch(u){this.handleError(u,d)}}setTranslatedLanguagesAsync(r,o,d){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfArrayEmptyOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","languages")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),d),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(r),()=>{this.handleCallback(o,d)},u=>{this.handleError(u,d)})}catch(u){this.handleError(u,d)}}changeNicknameAsync(r,o,d){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","nickname")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),d),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(r),()=>{this.handleCallback(o,d)},u=>{this.handleError(u,d)})}catch(u){this.handleError(u,d)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(r){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await r.enforceAudioGating(),this.privTranscriberRecognizer=r,this.privTranscriberRecognizer.meeting=this}getKeepAlive(){const r=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:r,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:p.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(r){if(this.privParticipants.addOrUpdateParticipant(r)!==void 0&&this.privTranscriberRecognizer){const o=this.meetingInfo;return o.participants=[r],this.privTranscriberRecognizer.pushMeetingEvent(o,"join")}}removeParticipantImplAsync(r){this.privParticipants.deleteParticipant(r.id);const o=this.meetingInfo;return o.participants=[r],this.privTranscriberRecognizer.pushMeetingEvent(o,"leave")}async close(r){try{this.privIsConnected=!1,await this.privConversationRecognizer?.close(),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(o){throw o}r&&this.dispose()}handleCallback(r,o){if(r){try{r()}catch(d){o&&o(d)}r=void 0}}handleError(r,o){if(o)if(r instanceof Error){const d=r;o(d.name+": "+d.message)}else o(r)}toParticipants(r){const o=this.privParticipants.participants.map(d=>this.toParticipant(d));return r?o:o.filter(d=>d.isHost===!1)}toParticipant(r){return new a.Participant(r.id,r.avatar,r.displayName,r.isHost,r.isMuted,r.isUsingTts,r.preferredLanguage,r.voice)}getMuteAllCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingd"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:p.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:p.ConversationTranslatorMessageTypes.participantCommand,value:r})}getMuteCommand(r,o){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(r,"participantId"),JSON.stringify({command:p.ConversationTranslatorCommandTypes.setMute,participantId:r,roomid:this.privRoom.roomId,type:p.ConversationTranslatorMessageTypes.participantCommand,value:o})}getLockCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:p.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:p.ConversationTranslatorMessageTypes.participantCommand,value:r})}getEjectCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),i.Contracts.throwIfNullOrWhitespace(r,"participantId"),JSON.stringify({command:p.ConversationTranslatorCommandTypes.ejectParticipant,participantId:r,roomid:this.privRoom.roomId,type:p.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:p.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:p.ConversationTranslatorMessageTypes.participantCommand,value:r})}getChangeNicknameCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),i.Contracts.throwIfNullOrWhitespace(r,"nickname"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:p.ConversationTranslatorCommandTypes.changeNickname,nickname:r,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:p.ConversationTranslatorMessageTypes.participantCommand,value:r})}getMessageCommand(r){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),i.Contracts.throwIfNullOrWhitespace(r,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:r,type:p.ConversationTranslatorMessageTypes.instantMessage})}}e.MeetingImpl=h},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MeetingTranscriptionCanceledEventArgs=void 0;const p=t(101);class n extends p.CancellationEventArgsBase{}e.MeetingTranscriptionCanceledEventArgs=n},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MeetingTranscriber=void 0;const p=t(2),n=t(4),i=t(64),a=t(79),s=t(156);e.MeetingTranscriber=class{constructor(h){this.privAudioConfig=h,this.privProperties=new a.PropertyCollection,this.privRecognizer=void 0,this.privDisposedRecognizer=!1}get speechRecognitionLanguage(){return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get internalData(){return this.privRecognizer.internalData}get connection(){return a.Connection.fromRecognizer(this.privRecognizer)}get authorizationToken(){return this.properties.getProperty(a.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(h){i.Contracts.throwIfNullOrWhitespace(h,"token"),this.properties.setProperty(a.PropertyId.SpeechServiceAuthorization_Token,h)}joinMeetingAsync(h,c,r){const o=h;i.Contracts.throwIfNullOrUndefined(s.MeetingImpl,"Meeting"),this.privRecognizer=new p.TranscriberRecognizer(h.config,this.privAudioConfig),i.Contracts.throwIfNullOrUndefined(this.privRecognizer,"Recognizer"),this.privRecognizer.connectMeetingCallbacks(this),n.marshalPromiseToCallbacks(o.connectTranscriberRecognizer(this.privRecognizer),c,r)}startTranscribingAsync(h,c){this.privRecognizer.startContinuousRecognitionAsync(h,c)}stopTranscribingAsync(h,c){this.privRecognizer.stopContinuousRecognitionAsync(h,c)}leaveMeetingAsync(h,c){this.privRecognizer.disconnectCallbacks(),n.marshalPromiseToCallbacks((async()=>{})(),h,c)}close(h,c){i.Contracts.throwIfDisposed(this.privDisposedRecognizer),n.marshalPromiseToCallbacks(this.dispose(!0),h,c)}async dispose(h){this.privDisposedRecognizer||(this.privRecognizer&&(await this.privRecognizer.close(),this.privRecognizer=void 0),h&&(this.privDisposedRecognizer=!0))}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationTranscriptionResult=void 0;const p=t(79);class n extends p.RecognitionResult{constructor(a,s,h,c,r,o,d,u,v,l,g){super(a,s,h,c,r,o,d,v,l,g),this.privSpeakerId=u}get speakerId(){return this.privSpeakerId}}e.ConversationTranscriptionResult=n},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SynthesisRequest=e.Synthesizer=void 0;const p=t(2),n=t(4),i=t(64),a=t(79);class s{constructor(c){const r=c;i.Contracts.throwIfNull(r,"speechConfig"),this.privProperties=r.properties.clone(),this.privDisposed=!1,this.privSynthesizing=!1,this.synthesisRequestQueue=new n.Queue}get authorizationToken(){return this.properties.getProperty(a.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(c){i.Contracts.throwIfNullOrWhitespace(c,"token"),this.properties.setProperty(a.PropertyId.SpeechServiceAuthorization_Token,c)}get properties(){return this.privProperties}get autoDetectSourceLanguage(){return this.properties.getProperty(a.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)===p.AutoDetectSourceLanguagesOpenRangeOptionName}buildSsml(c){const r={"af-ZA":"af-ZA-AdriNeural","am-ET":"am-ET-AmehaNeural","ar-AE":"ar-AE-FatimaNeural","ar-BH":"ar-BH-AliNeural","ar-DZ":"ar-DZ-AminaNeural","ar-EG":"ar-EG-SalmaNeural","ar-IQ":"ar-IQ-BasselNeural","ar-JO":"ar-JO-SanaNeural","ar-KW":"ar-KW-FahedNeural","ar-LY":"ar-LY-ImanNeural","ar-MA":"ar-MA-JamalNeural","ar-QA":"ar-QA-AmalNeural","ar-SA":"ar-SA-HamedNeural","ar-SY":"ar-SY-AmanyNeural","ar-TN":"ar-TN-HediNeural","ar-YE":"ar-YE-MaryamNeural","bg-BG":"bg-BG-BorislavNeural","bn-BD":"bn-BD-NabanitaNeural","bn-IN":"bn-IN-BashkarNeural","ca-ES":"ca-ES-JoanaNeural","cs-CZ":"cs-CZ-AntoninNeural","cy-GB":"cy-GB-AledNeural","da-DK":"da-DK-ChristelNeural","de-AT":"de-AT-IngridNeural","de-CH":"de-CH-JanNeural","de-DE":"de-DE-KatjaNeural","el-GR":"el-GR-AthinaNeural","en-AU":"en-AU-NatashaNeural","en-CA":"en-CA-ClaraNeural","en-GB":"en-GB-LibbyNeural","en-HK":"en-HK-SamNeural","en-IE":"en-IE-ConnorNeural","en-IN":"en-IN-NeerjaNeural","en-KE":"en-KE-AsiliaNeural","en-NG":"en-NG-AbeoNeural","en-NZ":"en-NZ-MitchellNeural","en-PH":"en-PH-JamesNeural","en-SG":"en-SG-LunaNeural","en-TZ":"en-TZ-ElimuNeural","en-US":"en-US-AvaMultilingualNeural","en-ZA":"en-ZA-LeahNeural","es-AR":"es-AR-ElenaNeural","es-BO":"es-BO-MarceloNeural","es-CL":"es-CL-CatalinaNeural","es-CO":"es-CO-GonzaloNeural","es-CR":"es-CR-JuanNeural","es-CU":"es-CU-BelkysNeural","es-DO":"es-DO-EmilioNeural","es-EC":"es-EC-AndreaNeural","es-ES":"es-ES-AlvaroNeural","es-GQ":"es-GQ-JavierNeural","es-GT":"es-GT-AndresNeural","es-HN":"es-HN-CarlosNeural","es-MX":"es-MX-DaliaNeural","es-NI":"es-NI-FedericoNeural","es-PA":"es-PA-MargaritaNeural","es-PE":"es-PE-AlexNeural","es-PR":"es-PR-KarinaNeural","es-PY":"es-PY-MarioNeural","es-SV":"es-SV-LorenaNeural","es-US":"es-US-AlonsoNeural","es-UY":"es-UY-MateoNeural","es-VE":"es-VE-PaolaNeural","et-EE":"et-EE-AnuNeural","fa-IR":"fa-IR-DilaraNeural","fi-FI":"fi-FI-SelmaNeural","fil-PH":"fil-PH-AngeloNeural","fr-BE":"fr-BE-CharlineNeural","fr-CA":"fr-CA-SylvieNeural","fr-CH":"fr-CH-ArianeNeural","fr-FR":"fr-FR-DeniseNeural","ga-IE":"ga-IE-ColmNeural","gl-ES":"gl-ES-RoiNeural","gu-IN":"gu-IN-DhwaniNeural","he-IL":"he-IL-AvriNeural","hi-IN":"hi-IN-MadhurNeural","hr-HR":"hr-HR-GabrijelaNeural","hu-HU":"hu-HU-NoemiNeural","id-ID":"id-ID-ArdiNeural","is-IS":"is-IS-GudrunNeural","it-IT":"it-IT-IsabellaNeural","ja-JP":"ja-JP-NanamiNeural","jv-ID":"jv-ID-DimasNeural","kk-KZ":"kk-KZ-AigulNeural","km-KH":"km-KH-PisethNeural","kn-IN":"kn-IN-GaganNeural","ko-KR":"ko-KR-SunHiNeural","lo-LA":"lo-LA-ChanthavongNeural","lt-LT":"lt-LT-LeonasNeural","lv-LV":"lv-LV-EveritaNeural","mk-MK":"mk-MK-AleksandarNeural","ml-IN":"ml-IN-MidhunNeural","mr-IN":"mr-IN-AarohiNeural","ms-MY":"ms-MY-OsmanNeural","mt-MT":"mt-MT-GraceNeural","my-MM":"my-MM-NilarNeural","nb-NO":"nb-NO-PernilleNeural","nl-BE":"nl-BE-ArnaudNeural","nl-NL":"nl-NL-ColetteNeural","pl-PL":"pl-PL-AgnieszkaNeural","ps-AF":"ps-AF-GulNawazNeural","pt-BR":"pt-BR-FranciscaNeural","pt-PT":"pt-PT-DuarteNeural","ro-RO":"ro-RO-AlinaNeural","ru-RU":"ru-RU-SvetlanaNeural","si-LK":"si-LK-SameeraNeural","sk-SK":"sk-SK-LukasNeural","sl-SI":"sl-SI-PetraNeural","so-SO":"so-SO-MuuseNeural","sr-RS":"sr-RS-NicholasNeural","su-ID":"su-ID-JajangNeural","sv-SE":"sv-SE-SofieNeural","sw-KE":"sw-KE-RafikiNeural","sw-TZ":"sw-TZ-DaudiNeural","ta-IN":"ta-IN-PallaviNeural","ta-LK":"ta-LK-KumarNeural","ta-SG":"ta-SG-AnbuNeural","te-IN":"te-IN-MohanNeural","th-TH":"th-TH-PremwadeeNeural","tr-TR":"tr-TR-AhmetNeural","uk-UA":"uk-UA-OstapNeural","ur-IN":"ur-IN-GulNeural","ur-PK":"ur-PK-AsadNeural","uz-UZ":"uz-UZ-MadinaNeural","vi-VN":"vi-VN-HoaiMyNeural","zh-CN":"zh-CN-XiaoxiaoNeural","zh-HK":"zh-HK-HiuMaanNeural","zh-TW":"zh-TW-HsiaoChenNeural","zu-ZA":"zu-ZA-ThandoNeural"};let o=this.properties.getProperty(a.PropertyId.SpeechServiceConnection_SynthLanguage,"en-US"),d=this.properties.getProperty(a.PropertyId.SpeechServiceConnection_SynthVoice,""),u=s.XMLEncode(c);return this.autoDetectSourceLanguage?o="en-US":d=d||r[o],d&&(u=`<voice name='${d}'>${u}</voice>`),u=`<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts' xmlns:emo='http://www.w3.org/2009/10/emotionml' xml:lang='${o}'>${u}</speak>`,u}async dispose(c){this.privDisposed||(c&&this.privAdapter&&await this.privAdapter.dispose(),this.privDisposed=!0)}async adapterSpeak(){if(!this.privDisposed&&!this.privSynthesizing){this.privSynthesizing=!0;const c=await this.synthesisRequestQueue.dequeue();return this.privAdapter.Speak(c.text,c.isSSML,c.requestId,c.cb,c.err,c.dataStream)}}createSynthesizerConfig(c){return new p.SynthesizerConfig(c,this.privProperties)}implCommonSynthesizeSetup(){let c=typeof window<"u"?"Browser":"Node",r="unknown",o="unknown";typeof navigator<"u"&&(c=c+"/"+navigator.platform,r=navigator.userAgent,o=navigator.appVersion);const d=this.createSynthesizerConfig(new p.SpeechServiceConfig(new p.Context(new p.OS(c,r,o)))),u=this.privProperties.getProperty(a.PropertyId.SpeechServiceConnection_Key,void 0),v=u&&u!==""?new p.CognitiveSubscriptionKeyAuthentication(u):new p.CognitiveTokenAuthentication(()=>{const l=this.privProperties.getProperty(a.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(l)},()=>{const l=this.privProperties.getProperty(a.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(l)});this.privAdapter=this.createSynthesisAdapter(v,this.privConnectionFactory,d),this.privRestAdapter=this.createRestSynthesisAdapter(v,d)}static XMLEncode(c){return c.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}}e.Synthesizer=s,e.SynthesisRequest=class{constructor(h,c,r,o,d,u){this.requestId=h,this.text=c,this.isSSML=r,this.cb=o,this.err=d,this.dataStream=u}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechSynthesizer=void 0;const p=t(2),n=t(4),i=t(81),a=t(85),s=t(84),h=t(64),c=t(79),r=t(174);class o extends c.Synthesizer{constructor(u,v){super(u),v!==null&&(this.audioConfig=v===void 0?typeof window>"u"?void 0:c.AudioConfig.fromDefaultSpeakerOutput():v),this.privConnectionFactory=new p.SpeechSynthesisConnectionFactory,this.implCommonSynthesizeSetup()}static FromConfig(u,v,l){const g=u;return v.properties.mergeTo(g.properties),new o(u,l)}speakTextAsync(u,v,l,g){this.speakImpl(u,!1,v,l,g)}speakSsmlAsync(u,v,l,g){this.speakImpl(u,!0,v,l,g)}async getVoicesAsync(u=""){return this.getVoices(u)}close(u,v){h.Contracts.throwIfDisposed(this.privDisposed),n.marshalPromiseToCallbacks(this.dispose(!0),u,v)}get internalData(){return this.privAdapter}createSynthesisAdapter(u,v,l){return new p.SpeechSynthesisAdapter(u,v,l,this,this.audioConfig)}createRestSynthesisAdapter(u,v){return new p.SynthesisRestAdapter(v,u)}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=a.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(c.SpeechSynthesisOutputFormat[this.properties.getProperty(c.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)])}speakImpl(u,v,l,g,m){try{h.Contracts.throwIfDisposed(this.privDisposed);const S=n.createNoDashGuid();let y;y=m instanceof c.PushAudioOutputStreamCallback?new s.PushAudioOutputStreamImpl(m):m instanceof c.PullAudioOutputStream?m:m!==void 0?new i.AudioFileWriter(m):void 0,this.synthesisRequestQueue.enqueue(new r.SynthesisRequest(S,u,v,C=>{if(this.privSynthesizing=!1,l)try{l(C)}catch(P){g&&g(P)}l=void 0,this.adapterSpeak().catch(()=>{})},C=>{g&&g(C)},y)),this.adapterSpeak().catch(()=>{})}catch(S){if(g)if(S instanceof Error){const y=S;g(y.name+": "+y.message)}else g(S);this.dispose(!0).catch(()=>{})}}async getVoices(u){const v=n.createNoDashGuid(),l=await this.privRestAdapter.getVoicesList(v);if(l.ok&&Array.isArray(l.json)){let g=l.json;return u&&u.length>0&&(g=g.filter(m=>!!m.Locale&&m.Locale.toLowerCase()===u.toLowerCase())),new c.SynthesisVoicesResult(v,g,void 0)}return new c.SynthesisVoicesResult(v,void 0,`Error: ${l.status}: ${l.statusText}`)}}e.SpeechSynthesizer=o},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SynthesisResult=void 0,e.SynthesisResult=class{constructor(t,p,n,i){this.privResultId=t,this.privReason=p,this.privErrorDetails=n,this.privProperties=i}get resultId(){return this.privResultId}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get properties(){return this.privProperties}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechSynthesisResult=void 0;const p=t(79);class n extends p.SynthesisResult{constructor(a,s,h,c,r,o){super(a,s,c,r),this.privAudioData=h,this.privAudioDuration=o}get audioData(){return this.privAudioData}get audioDuration(){return this.privAudioDuration}}e.SpeechSynthesisResult=n},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechSynthesisEventArgs=void 0,e.SpeechSynthesisEventArgs=class{constructor(t){this.privResult=t}get result(){return this.privResult}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechSynthesisWordBoundaryEventArgs=void 0,e.SpeechSynthesisWordBoundaryEventArgs=class{constructor(t,p,n,i,a,s){this.privAudioOffset=t,this.privDuration=p,this.privText=n,this.privWordLength=i,this.privTextOffset=a,this.privBoundaryType=s}get audioOffset(){return this.privAudioOffset}get duration(){return this.privDuration}get text(){return this.privText}get wordLength(){return this.privWordLength}get textOffset(){return this.privTextOffset}get boundaryType(){return this.privBoundaryType}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechSynthesisBookmarkEventArgs=void 0,e.SpeechSynthesisBookmarkEventArgs=class{constructor(t,p){this.privAudioOffset=t,this.privText=p}get audioOffset(){return this.privAudioOffset}get text(){return this.privText}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechSynthesisVisemeEventArgs=void 0,e.SpeechSynthesisVisemeEventArgs=class{constructor(t,p,n){this.privAudioOffset=t,this.privVisemeId=p,this.privAnimation=n}get audioOffset(){return this.privAudioOffset}get visemeId(){return this.privVisemeId}get animation(){return this.privAnimation}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechSynthesisBoundaryType=void 0,function(t){t.Word="WordBoundary",t.Punctuation="PunctuationBoundary",t.Sentence="SentenceBoundary"}(e.SpeechSynthesisBoundaryType||(e.SpeechSynthesisBoundaryType={}))},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SynthesisVoicesResult=void 0;const p=t(79);class n extends p.SynthesisResult{constructor(a,s,h){if(Array.isArray(s)){super(a,p.ResultReason.VoicesListRetrieved,void 0,new p.PropertyCollection),this.privVoices=[];for(const c of s)this.privVoices.push(new p.VoiceInfo(c))}else super(a,p.ResultReason.Canceled,h||"Error information unavailable",new p.PropertyCollection)}get voices(){return this.privVoices}}e.SynthesisVoicesResult=n},(f,e)=>{"use strict";var t,p;Object.defineProperty(e,"__esModule",{value:!0}),e.VoiceInfo=e.SynthesisVoiceType=e.SynthesisVoiceGender=void 0,function(i){i[i.Unknown=0]="Unknown",i[i.Female=1]="Female",i[i.Male=2]="Male",i[i.Neutral=3]="Neutral"}(t=e.SynthesisVoiceGender||(e.SynthesisVoiceGender={})),function(i){i[i.OnlineNeural=1]="OnlineNeural",i[i.OnlineStandard=2]="OnlineStandard",i[i.OfflineNeural=3]="OfflineNeural",i[i.OfflineStandard=4]="OfflineStandard"}(p=e.SynthesisVoiceType||(e.SynthesisVoiceType={}));const n={[t[t.Neutral]]:t.Neutral,[t[t.Male]]:t.Male,[t[t.Female]]:t.Female};e.VoiceInfo=class{constructor(i){if(this.privStyleList=[],i){if(this.privName=i.Name,this.privLocale=i.Locale,this.privShortName=i.ShortName,this.privLocaleName=i.LocaleName,this.privDisplayName=i.DisplayName,this.privLocalName=i.LocalName,this.privVoiceType=i.VoiceType.endsWith("Standard")?p.OnlineStandard:p.OnlineNeural,this.privGender=n[i.Gender]||t.Unknown,i.StyleList&&Array.isArray(i.StyleList))for(const a of i.StyleList)this.privStyleList.push(a);this.privSampleRateHertz=i.SampleRateHertz,this.privStatus=i.Status,i.ExtendedPropertyMap&&(this.privExtendedPropertyMap=i.ExtendedPropertyMap),this.privWordsPerMinute=i.WordsPerMinute,Array.isArray(i.SecondaryLocaleList)&&(this.privSecondaryLocaleList=[...i.SecondaryLocaleList]),Array.isArray(i.RolePlayList)&&(this.privRolePlayList=[...i.RolePlayList])}}get name(){return this.privName}get locale(){return this.privLocale}get shortName(){return this.privShortName}get displayName(){return this.privDisplayName}get localName(){return this.privLocalName}get localeName(){return this.privLocaleName}get gender(){return this.privGender}get voiceType(){return this.privVoiceType}get styleList(){return this.privStyleList}get sampleRateHertz(){return this.privSampleRateHertz}get status(){return this.privStatus}get extendedPropertyMap(){return this.privExtendedPropertyMap}get wordsPerMinute(){return this.privWordsPerMinute}get secondaryLocaleList(){return this.privSecondaryLocaleList}get rolePlayList(){return this.privRolePlayList}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeakerAudioDestination=void 0;const p=t(4),n=t(84),i=t(67),a={[i.AudioFormatTag.PCM]:"audio/wav",[i.AudioFormatTag.MuLaw]:"audio/x-wav",[i.AudioFormatTag.MP3]:"audio/mpeg",[i.AudioFormatTag.OGG_OPUS]:"audio/ogg",[i.AudioFormatTag.WEBM_OPUS]:"audio/webm; codecs=opus",[i.AudioFormatTag.ALaw]:"audio/x-wav",[i.AudioFormatTag.FLAC]:"audio/flac",[i.AudioFormatTag.AMR_WB]:"audio/amr-wb",[i.AudioFormatTag.G722]:"audio/G722"};e.SpeakerAudioDestination=class{constructor(s){this.privPlaybackStarted=!1,this.privAppendingToBuffer=!1,this.privMediaSourceOpened=!1,this.privBytesReceived=0,this.privId=s||p.createNoDashGuid(),this.privIsPaused=!1,this.privIsClosed=!1}id(){return this.privId}write(s,h,c){this.privAudioBuffer!==void 0?(this.privAudioBuffer.push(s),this.updateSourceBuffer().then(()=>{h&&h()},r=>{c&&c(r)})):this.privAudioOutputStream!==void 0&&(this.privAudioOutputStream.write(s),this.privBytesReceived+=s.byteLength)}close(s,h){if(this.privIsClosed=!0,this.privSourceBuffer!==void 0)this.handleSourceBufferUpdateEnd().then(()=>{s&&s()},c=>{h&&h(c)});else if(this.privAudioOutputStream!==void 0&&typeof window<"u")if(this.privFormat.formatTag!==i.AudioFormatTag.PCM&&this.privFormat.formatTag!==i.AudioFormatTag.MuLaw&&this.privFormat.formatTag!==i.AudioFormatTag.ALaw||this.privFormat.hasHeader!==!1){let c=new ArrayBuffer(this.privBytesReceived);this.privAudioOutputStream.read(c).then(()=>{c=this.privFormat.addHeader(c);const r=new Blob([c],{type:a[this.privFormat.formatTag]});this.privAudio.src=window.URL.createObjectURL(r),this.notifyPlayback().then(()=>{s&&s()},o=>{h&&h(o)})},r=>{h&&h(r)})}else console.warn("Play back is not supported for raw PCM, mulaw or alaw format without header."),this.onAudioEnd&&this.onAudioEnd(this);else this.onAudioEnd&&this.onAudioEnd(this)}set format(s){if(typeof AudioContext<"u"||typeof window<"u"&&window.webkitAudioContext!==void 0){this.privFormat=s;const h=a[this.privFormat.formatTag];h===void 0?console.warn(`Unknown mimeType for format ${i.AudioFormatTag[this.privFormat.formatTag]}; playback is not supported.`):typeof MediaSource<"u"&&MediaSource.isTypeSupported(h)?(this.privAudio=new Audio,this.privAudioBuffer=[],this.privMediaSource=new MediaSource,this.privAudio.src=URL.createObjectURL(this.privMediaSource),this.privAudio.load(),this.privMediaSource.onsourceopen=()=>{this.privMediaSourceOpened=!0,this.privMediaSource.duration=1800,this.privSourceBuffer=this.privMediaSource.addSourceBuffer(h),this.privSourceBuffer.onupdate=()=>{this.updateSourceBuffer().catch(c=>{p.Events.instance.onEvent(new p.BackgroundEvent(c))})},this.privSourceBuffer.onupdateend=()=>{this.handleSourceBufferUpdateEnd().catch(c=>{p.Events.instance.onEvent(new p.BackgroundEvent(c))})},this.privSourceBuffer.onupdatestart=()=>{this.privAppendingToBuffer=!1}},this.updateSourceBuffer().catch(c=>{p.Events.instance.onEvent(new p.BackgroundEvent(c))})):(console.warn(`Format ${i.AudioFormatTag[this.privFormat.formatTag]} could not be played by MSE, streaming playback is not enabled.`),this.privAudioOutputStream=new n.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privFormat,this.privAudio=new Audio)}}get volume(){return this.privAudio?.volume??-1}set volume(s){this.privAudio&&(this.privAudio.volume=s)}mute(){this.privAudio&&(this.privAudio.muted=!0)}unmute(){this.privAudio&&(this.privAudio.muted=!1)}get isClosed(){return this.privIsClosed}get currentTime(){return this.privAudio!==void 0?this.privAudio.currentTime:-1}pause(){this.privIsPaused||this.privAudio===void 0||(this.privAudio.pause(),this.privIsPaused=!0)}resume(s,h){this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.play().then(()=>{s&&s()},c=>{h&&h(c)}),this.privIsPaused=!1)}get internalAudio(){return this.privAudio}async updateSourceBuffer(){if(this.privAudioBuffer!==void 0&&this.privAudioBuffer.length>0&&this.sourceBufferAvailable()){this.privAppendingToBuffer=!0;const s=this.privAudioBuffer.shift();try{this.privSourceBuffer.appendBuffer(s)}catch{return this.privAudioBuffer.unshift(s),void console.log("buffer filled, pausing addition of binaries until space is made")}await this.notifyPlayback()}else this.canEndStream()&&await this.handleSourceBufferUpdateEnd()}async handleSourceBufferUpdateEnd(){this.canEndStream()&&this.sourceBufferAvailable()&&(this.privMediaSource.endOfStream(),await this.notifyPlayback())}async notifyPlayback(){this.privPlaybackStarted||this.privAudio===void 0||(this.privPlaybackStarted=!0,this.onAudioStart&&this.onAudioStart(this),this.privAudio.onended=()=>{this.onAudioEnd&&this.onAudioEnd(this)},this.privIsPaused||await this.privAudio.play())}canEndStream(){return this.isClosed&&this.privSourceBuffer!==void 0&&this.privAudioBuffer.length===0&&this.privMediaSourceOpened&&!this.privAppendingToBuffer&&this.privMediaSource.readyState==="open"}sourceBufferAvailable(){return this.privSourceBuffer!==void 0&&!this.privSourceBuffer.updating}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationTranscriptionCanceledEventArgs=void 0;const p=t(101);class n extends p.CancellationEventArgsBase{}e.ConversationTranscriptionCanceledEventArgs=n},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MeetingTranscriptionCanceledEventArgs=void 0;const p=t(101);class n extends p.CancellationEventArgsBase{}e.MeetingTranscriptionCanceledEventArgs=n},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PronunciationAssessmentGradingSystem=void 0,function(t){t[t.FivePoint=1]="FivePoint",t[t.HundredMark=2]="HundredMark"}(e.PronunciationAssessmentGradingSystem||(e.PronunciationAssessmentGradingSystem={}))},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PronunciationAssessmentGranularity=void 0,function(t){t[t.Phoneme=1]="Phoneme",t[t.Word=2]="Word",t[t.FullText=3]="FullText"}(e.PronunciationAssessmentGranularity||(e.PronunciationAssessmentGranularity={}))},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PronunciationAssessmentConfig=void 0;const p=t(64),n=t(79);class i{constructor(s,h=n.PronunciationAssessmentGradingSystem.FivePoint,c=n.PronunciationAssessmentGranularity.Phoneme,r=!1){p.Contracts.throwIfNullOrUndefined(s,"referenceText"),this.privProperties=new n.PropertyCollection,this.privProperties.setProperty(n.PropertyId.PronunciationAssessment_ReferenceText,s),this.privProperties.setProperty(n.PropertyId.PronunciationAssessment_GradingSystem,n.PronunciationAssessmentGradingSystem[h]),this.privProperties.setProperty(n.PropertyId.PronunciationAssessment_Granularity,n.PronunciationAssessmentGranularity[c]),this.privProperties.setProperty(n.PropertyId.PronunciationAssessment_EnableMiscue,String(r))}static fromJSON(s){p.Contracts.throwIfNullOrUndefined(s,"json");const h=new i("");return h.privProperties=new n.PropertyCollection,h.properties.setProperty(n.PropertyId.PronunciationAssessment_Json,s),h}toJSON(){return this.updateJson(),this.privProperties.getProperty(n.PropertyId.PronunciationAssessment_Params)}applyTo(s){this.updateJson();const h=s.internalData;h.expectContentAssessmentResponse=!!this.privContentAssessmentTopic,h.speechContext.setPronunciationAssessmentParams(this.properties.getProperty(n.PropertyId.PronunciationAssessment_Params),this.privContentAssessmentTopic,h.isSpeakerDiarizationEnabled)}get referenceText(){return this.properties.getProperty(n.PropertyId.PronunciationAssessment_ReferenceText)}set referenceText(s){p.Contracts.throwIfNullOrWhitespace(s,"referenceText"),this.properties.setProperty(n.PropertyId.PronunciationAssessment_ReferenceText,s)}set phonemeAlphabet(s){p.Contracts.throwIfNullOrWhitespace(s,"phonemeAlphabet"),this.privPhonemeAlphabet=s}set enableMiscue(s){const h=s?"true":"false";this.properties.setProperty(n.PropertyId.PronunciationAssessment_EnableMiscue,h)}get enableMiscue(){return this.properties.getProperty(n.PropertyId.PronunciationAssessment_EnableMiscue,"false").toLowerCase()==="true"}set nbestPhonemeCount(s){this.privNBestPhonemeCount=s}set enableProsodyAssessment(s){this.privEnableProsodyAssessment=s}enableContentAssessmentWithTopic(s){this.privContentAssessmentTopic=s}get properties(){return this.privProperties}updateJson(){const s=this.privProperties.getProperty(n.PropertyId.PronunciationAssessment_Json,"{}"),h=JSON.parse(s),c=this.privProperties.getProperty(n.PropertyId.PronunciationAssessment_ReferenceText);c&&(h.referenceText=c);const r=this.privProperties.getProperty(n.PropertyId.PronunciationAssessment_GradingSystem);r&&(h.gradingSystem=r);const o=this.privProperties.getProperty(n.PropertyId.PronunciationAssessment_Granularity);o&&(h.granularity=o),this.privPhonemeAlphabet&&(h.phonemeAlphabet=this.privPhonemeAlphabet),this.privNBestPhonemeCount&&(h.nbestPhonemeCount=this.privNBestPhonemeCount),h.enableProsodyAssessment=this.privEnableProsodyAssessment,h.dimension="Comprehensive",this.privProperties.getProperty(n.PropertyId.PronunciationAssessment_EnableMiscue)&&(h.enableMiscue=this.enableMiscue),this.privProperties.setProperty(n.PropertyId.PronunciationAssessment_Params,JSON.stringify(h))}}e.PronunciationAssessmentConfig=i},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PronunciationAssessmentResult=e.ContentAssessmentResult=void 0;const p=t(64),n=t(79);class i{constructor(h){this.privPronJson=h}get grammarScore(){return this.privPronJson.ContentAssessment.GrammarScore}get vocabularyScore(){return this.privPronJson.ContentAssessment.VocabularyScore}get topicScore(){return this.privPronJson.ContentAssessment.TopicScore}}e.ContentAssessmentResult=i;class a{constructor(h){const c=JSON.parse(h);p.Contracts.throwIfNullOrUndefined(c.NBest[0],"NBest"),this.privPronJson=c.NBest[0]}static fromResult(h){p.Contracts.throwIfNullOrUndefined(h,"result");const c=h.properties.getProperty(n.PropertyId.SpeechServiceResponse_JsonResult);return p.Contracts.throwIfNullOrUndefined(c,"json"),new a(c)}get detailResult(){return this.privPronJson}get accuracyScore(){return this.detailResult.PronunciationAssessment?.AccuracyScore}get pronunciationScore(){return this.detailResult.PronunciationAssessment?.PronScore}get completenessScore(){return this.detailResult.PronunciationAssessment?.CompletenessScore}get fluencyScore(){return this.detailResult.PronunciationAssessment?.FluencyScore}get prosodyScore(){return this.detailResult.PronunciationAssessment?.ProsodyScore}get contentAssessmentResult(){if(this.detailResult.ContentAssessment!==void 0)return new i(this.detailResult)}}e.PronunciationAssessmentResult=a},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AvatarConfig=void 0;const p=t(64),n=t(79);e.AvatarConfig=class{constructor(i,a,s){this.privCustomized=!1,p.Contracts.throwIfNullOrWhitespace(i,"character"),this.character=i,this.style=a,s===void 0&&(s=new n.AvatarVideoFormat),this.videoFormat=s}get customized(){return this.privCustomized}set customized(i){this.privCustomized=i}get backgroundColor(){return this.privBackgroundColor}set backgroundColor(i){this.privBackgroundColor=i}get backgroundImage(){return this.privBackgroundImage}set backgroundImage(i){this.privBackgroundImage=i}get remoteIceServers(){return this.privRemoteIceServers}set remoteIceServers(i){this.privRemoteIceServers=i}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AvatarEventArgs=e.AvatarEventTypes=void 0,function(t){t.SwitchedToSpeaking="SwitchedToSpeaking",t.SwitchedToIdle="SwitchedToIdle",t.SessionClosed="SessionClosed"}(e.AvatarEventTypes||(e.AvatarEventTypes={})),e.AvatarEventArgs=class{constructor(t,p){this.privOffset=t,this.privDescription=p}get type(){return this.privType}get offset(){return this.privOffset}get description(){return this.privDescription}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AvatarSynthesizer=void 0;const p=t(195),n=t(2),i=t(4),a=t(85),s=t(79),h=t(64),c=t(174);class r extends s.Synthesizer{constructor(d,u){super(d),h.Contracts.throwIfNullOrUndefined(u,"avatarConfig"),this.privConnectionFactory=new p.SpeechSynthesisConnectionFactory,this.privAvatarConfig=u,this.implCommonSynthesizeSetup()}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=a.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(s.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm)}async startAvatarAsync(d){h.Contracts.throwIfNullOrUndefined(d,"peerConnection"),this.privIceServers=d.getConfiguration().iceServers,h.Contracts.throwIfNullOrUndefined(this.privIceServers,"Ice servers must be set.");const u=new i.Deferred;d.onicegatheringstatechange=()=>{i.Events.instance.onEvent(new i.PlatformEvent("peer connection: ice gathering state: "+d.iceGatheringState,i.EventType.Debug)),d.iceGatheringState==="complete"&&(i.Events.instance.onEvent(new i.PlatformEvent("peer connection: ice gathering complete.",i.EventType.Info)),u.resolve())},d.onicecandidate=S=>{S.candidate?i.Events.instance.onEvent(new i.PlatformEvent("peer connection: ice candidate: "+S.candidate.candidate,i.EventType.Debug)):(i.Events.instance.onEvent(new i.PlatformEvent("peer connection: ice candidate: complete",i.EventType.Debug)),u.resolve())},setTimeout(()=>{d.iceGatheringState!=="complete"&&(i.Events.instance.onEvent(new i.PlatformEvent("peer connection: ice gathering timeout.",i.EventType.Warning)),u.resolve())},2e3);const v=await d.createOffer();await d.setLocalDescription(v),await u.promise,i.Events.instance.onEvent(new i.PlatformEvent("peer connection: got local SDP.",i.EventType.Info)),this.privProperties.setProperty(s.PropertyId.TalkingAvatarService_WebRTC_SDP,JSON.stringify(d.localDescription));const l=await this.speak("",!1);if(l.reason!==s.ResultReason.SynthesizingAudioCompleted)return new s.SynthesisResult(l.resultId,l.reason,l.errorDetails,l.properties);const g=atob(l.properties.getProperty(s.PropertyId.TalkingAvatarService_WebRTC_SDP)),m=new RTCSessionDescription(JSON.parse(g));return await d.setRemoteDescription(m),new s.SynthesisResult(l.resultId,l.reason,void 0,l.properties)}async speakTextAsync(d){const u=await this.speak(d,!1);return new s.SynthesisResult(u.resultId,u.reason,u.errorDetails,u.properties)}async speakSsmlAsync(d){const u=await this.speak(d,!0);return new s.SynthesisResult(u.resultId,u.reason,u.errorDetails,u.properties)}async stopSpeakingAsync(){for(;this.synthesisRequestQueue.length()>0;)(await this.synthesisRequestQueue.dequeue()).err("Synthesis is canceled by user.");return this.privAdapter.stopSpeaking()}async stopAvatarAsync(){return h.Contracts.throwIfDisposed(this.privDisposed),this.dispose(!0)}async close(){if(!this.privDisposed)return this.dispose(!0)}get iceServers(){return this.privIceServers}createSynthesisAdapter(d,u,v){return new n.AvatarSynthesisAdapter(d,u,v,this,this.privAvatarConfig)}createRestSynthesisAdapter(d,u){}createSynthesizerConfig(d){const u=super.createSynthesizerConfig(d);return u.avatarEnabled=!0,u}async speak(d,u){const v=i.createNoDashGuid(),l=new i.Deferred;return this.synthesisRequestQueue.enqueue(new c.SynthesisRequest(v,d,u,g=>{l.resolve(g),this.privSynthesizing=!1,this.adapterSpeak()},g=>{l.reject(g),this.privSynthesizing=!1})),this.adapterSpeak(),l.promise}}e.AvatarSynthesizer=r},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechSynthesisConnectionFactory=void 0;const p=t(60),n=t(79),i=t(134),a=t(2),s=t(54),h=t(135);e.SpeechSynthesisConnectionFactory=class{constructor(){this.synthesisUri="/cognitiveservices/websocket/v1"}create(c,r,o){let d=c.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Endpoint,void 0);const u=c.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Region,void 0),v=i.ConnectionFactoryBase.getHostSuffix(u),l=c.parameters.getProperty(n.PropertyId.SpeechServiceConnection_EndpointId,void 0),g=l===void 0?"tts":"voice",m=c.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Host,"wss://"+u+"."+g+".speech"+v),S={},y={};r.token!==void 0&&r.token!==""&&(y[r.headerName]=r.token),y[s.HeaderNames.ConnectionId]=o,l!==void 0&&l!==""&&(d&&d.search(h.QueryParameterNames.CustomVoiceDeploymentId)!==-1||(S[h.QueryParameterNames.CustomVoiceDeploymentId]=l)),c.avatarEnabled&&(d&&d.search(h.QueryParameterNames.EnableAvatar)!==-1||(S[h.QueryParameterNames.EnableAvatar]="true")),d||(d=m+this.synthesisUri),c.parameters.setProperty(n.PropertyId.SpeechServiceConnection_Url,d);const C=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new p.WebsocketConnection(d,S,y,new a.WebsocketMessageFormatter,p.ProxyInfo.fromParameters(c.parameters),C,o)}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AvatarVideoFormat=e.Coordinate=void 0,e.Coordinate=class{constructor(t,p){this.x=t,this.y=p}},e.AvatarVideoFormat=class{constructor(t="H264",p=2e6,n=1920,i=1080){this.codec=t,this.bitrate=p,this.width=n,this.height=i}setCropRange(t,p){this.cropRange={bottomRight:p,topLeft:t}}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AvatarWebRTCConnectionResult=void 0;const p=t(79);class n extends p.SynthesisResult{constructor(a,s,h,c,r){super(s,h,c,r),this.privSDPAnswer=a}get SDPAnswer(){return this.privSDPAnswer}}e.AvatarWebRTCConnectionResult=n},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Diagnostics=void 0;const p=t(60),n=t(4);class i{static SetLoggingLevel(s){this.privListener=new p.ConsoleLoggingListener(s),n.Events.instance.attachConsoleListener(this.privListener)}static StartConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!0)}static StopConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!1)}static SetLogOutputPath(s){if(typeof window<"u")throw new Error("File system logging not available in browser.");this.privListener&&(this.privListener.logPath=s)}static set onLogOutput(s){this.privListener&&(this.privListener.logCallback=s)}}e.Diagnostics=i,i.privListener=void 0},function(f,e,t){"use strict";var p=this&&this.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(e,"__esModule",{value:!0}),e.RestMessageAdapter=e.RestRequestType=void 0;const n=p(t(200)),i=t(4);var a;(function(s){s.Get="GET",s.Post="POST",s.Delete="DELETE",s.File="file"})(a=e.RestRequestType||(e.RestRequestType={})),e.RestMessageAdapter=class{constructor(s){if(!s)throw new i.ArgumentNullError("configParams");this.privHeaders=s.headers,this.privIgnoreCache=s.ignoreCache}static extractHeaderValue(s,h){let c="";try{const r=h.trim().split(/[\r\n]+/),o={};r.forEach(d=>{const u=d.split(": "),v=u.shift().toLowerCase(),l=u.join(": ");o[v]=l}),c=o[s.toLowerCase()]}catch{}return c}set options(s){this.privHeaders=s.headers,this.privIgnoreCache=s.ignoreCache}setHeaders(s,h){this.privHeaders[s]=h}request(s,h,c={},r=null){const o=new i.Deferred,d=s===a.File?"POST":s,u=(v,l={})=>{const g=v;return{data:JSON.stringify(l),headers:JSON.stringify(v.headers),json:l,ok:v.statusCode>=200&&v.statusCode<300,status:v.statusCode,statusText:l.error?l.error.message:g.statusText?g.statusText:g.statusMessage}};return this.privIgnoreCache&&(this.privHeaders["Cache-Control"]="no-cache"),s===a.Post&&r&&(this.privHeaders["content-type"]="application/json",this.privHeaders["Content-Type"]="application/json"),(v=>{n.default(h,d,this.privHeaders,200,201,202,204,400,401,402,403,404)(this.queryParams(c)===""?"":`?${this.queryParams(c)}`,v).then(async l=>{if(s===a.Delete||l.statusCode===204)o.resolve(u(l));else try{const g=await l.json();o.resolve(u(l,g))}catch{o.resolve(u(l))}}).catch(l=>{o.reject(l)})})(r),o.promise}queryParams(s={}){return Object.keys(s).map(h=>encodeURIComponent(h)+"="+encodeURIComponent(s[h])).join("&")}}},(f,e,t)=>{"use strict";const p=t(201);class n extends Error{constructor(a,...s){let h;super(...s),Error.captureStackTrace&&Error.captureStackTrace(this,n),this.name="StatusError",this.message=a.statusMessage,this.statusCode=a.status,this.res=a,this.json=a.json.bind(a),this.text=a.text.bind(a),this.arrayBuffer=a.arrayBuffer.bind(a),Object.defineProperty(this,"responseBody",{get:()=>(h||(h=this.arrayBuffer()),h)}),this.headers={};for(const[c,r]of a.headers.entries())this.headers[c.toLowerCase()]=r}}f.exports=p((i,a,s,h,c)=>async(r,o,d={})=>{r=c+(r||"");let u=new URL(r);if(h||(h={}),u.username&&(h.Authorization="Basic "+btoa(u.username+":"+u.password),u=new URL(u.protocol+"//"+u.host+u.pathname+u.search)),u.protocol!=="https:"&&u.protocol!=="http:")throw new Error(`Unknown protocol, ${u.protocol}`);if(o&&!(o instanceof ArrayBuffer||ArrayBuffer.isView(o)||typeof o=="string")){if(typeof o!="object")throw new Error("Unknown body type.");o=JSON.stringify(o),h["Content-Type"]="application/json"}d=new Headers({...h||{},...d});const v=await fetch(u,{method:a,headers:d,body:o});if(v.statusCode=v.status,!i.has(v.status))throw new n(v);return s==="json"?v.json():s==="buffer"?v.arrayBuffer():s==="string"?v.text():v})},f=>{"use strict";const e=new Set(["json","buffer","string"]);f.exports=t=>(...p)=>{const n=new Set;let i,a,s,h="";return p.forEach(c=>{if(typeof c=="string")if(c.toUpperCase()===c){if(i)throw new Error(`Can't set method to ${c}, already set to ${i}.`);i=c}else if(c.startsWith("http:")||c.startsWith("https:"))h=c;else{if(!e.has(c))throw new Error(`Unknown encoding, ${c}`);a=c}else if(typeof c=="number")n.add(c);else{if(typeof c!="object")throw new Error("Unknown type: "+typeof c);if(Array.isArray(c)||c instanceof Set)c.forEach(r=>n.add(r));else{if(s)throw new Error("Cannot set headers twice.");s=c}}}),i||(i="GET"),n.size===0&&n.add(200),t(n,i,a,s,h)}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RestConfigBase=void 0;class t{static get requestOptions(){return t.privDefaultRequestOptions}static get configParams(){return t.privDefaultParams}static get restErrors(){return t.privRestErrors}}e.RestConfigBase=t,t.privDefaultRequestOptions={headers:{Accept:"application/json"},ignoreCache:!1,timeout:1e4},t.privRestErrors={authInvalidSubscriptionKey:"You must specify either an authentication token to use, or a Cognitive Speech subscription key.",authInvalidSubscriptionRegion:"You must specify the Cognitive Speech region to use.",invalidArgs:"Required input not found: {arg}.",invalidCreateJoinConversationResponse:"Creating/Joining conversation failed with HTTP {status}.",invalidParticipantRequest:"The requested participant was not found.",permissionDeniedConnect:"Required credentials not found.",permissionDeniedConversation:"Invalid operation: only the host can {command} the conversation.",permissionDeniedParticipant:"Invalid operation: only the host can {command} a participant.",permissionDeniedSend:"Invalid operation: the conversation is not in a connected state.",permissionDeniedStart:"Invalid operation: there is already an active conversation."},t.privDefaultParams={apiVersion:"api-version",authorization:"Authorization",clientAppId:"X-ClientAppId",contentTypeKey:"Content-Type",correlationId:"X-CorrelationId",languageCode:"language",nickname:"nickname",profanity:"profanity",requestId:"X-RequestId",roomId:"roomid",sessionToken:"token",subscriptionKey:"Ocp-Apim-Subscription-Key",subscriptionRegion:"Ocp-Apim-Subscription-Region",token:"X-CapitoToken"}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VoiceProfileConnectionFactory=e.SpeakerRecognitionConnectionFactory=void 0;const p=t(60),n=t(79),i=t(134),a=t(2),s=t(54);class h extends i.ConnectionFactoryBase{create(r,o,d,u){let v=r.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Endpoint);if(!v){const S=r.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Region),y=i.ConnectionFactoryBase.getHostSuffix(S),C=r.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Host,`wss://${S}.spr-frontend.speech${y}`),P=r.parameters.getProperty(n.PropertyId.SpeechServiceConnection_SpeakerIdMode,"TextIndependentIdentification");v=`${C}/speaker/ws/${this.scenarioToPath(P)}/${d}`}const l={format:"simple",language:r.parameters.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(r,l,v);const g={};o.token!==void 0&&o.token!==""&&(g[o.headerName]=o.token),g[s.HeaderNames.ConnectionId]=u,g[s.HeaderNames.SpIDAuthKey]=r.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Key),r.parameters.setProperty(n.PropertyId.SpeechServiceConnection_Url,v);const m=r.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new p.WebsocketConnection(v,l,g,new a.WebsocketMessageFormatter,p.ProxyInfo.fromRecognizerConfig(r),m,u)}scenarioToPath(r){switch(r){case"TextIndependentVerification":case"2":return"verification/text-independent";case"TextDependentVerification":case"1":return"verification/text-dependent";default:return"identification/text-independent"}}}e.SpeakerRecognitionConnectionFactory=class extends h{create(c,r,o){return super.create(c,r,"recognition",o)}},e.VoiceProfileConnectionFactory=class extends h{create(c,r,o){return super.create(c,r,"profile",o)}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RecognitionEndedEvent=e.RecognitionCompletionStatus=e.RecognitionStartedEvent=e.ConnectingToServiceEvent=e.ListeningStartedEvent=e.RecognitionTriggeredEvent=e.SpeechRecognitionEvent=void 0;const p=t(4);class n extends p.PlatformEvent{constructor(s,h,c,r=p.EventType.Info){super(s,r),this.privRequestId=h,this.privSessionId=c}get requestId(){return this.privRequestId}get sessionId(){return this.privSessionId}}e.SpeechRecognitionEvent=n,e.RecognitionTriggeredEvent=class extends n{constructor(a,s,h,c){super("RecognitionTriggeredEvent",a,s),this.privAudioSourceId=h,this.privAudioNodeId=c}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}},e.ListeningStartedEvent=class extends n{constructor(a,s,h,c){super("ListeningStartedEvent",a,s),this.privAudioSourceId=h,this.privAudioNodeId=c}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}},e.ConnectingToServiceEvent=class extends n{constructor(a,s,h){super("ConnectingToServiceEvent",a,h),this.privAuthFetchEventid=s}get authFetchEventid(){return this.privAuthFetchEventid}};var i;e.RecognitionStartedEvent=class extends n{constructor(a,s,h,c,r){super("RecognitionStartedEvent",a,r),this.privAudioSourceId=s,this.privAudioNodeId=h,this.privAuthFetchEventId=c}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}},function(a){a[a.Success=0]="Success",a[a.AudioSourceError=1]="AudioSourceError",a[a.AudioSourceTimeout=2]="AudioSourceTimeout",a[a.AuthTokenFetchError=3]="AuthTokenFetchError",a[a.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",a[a.UnAuthorized=5]="UnAuthorized",a[a.ConnectTimeout=6]="ConnectTimeout",a[a.ConnectError=7]="ConnectError",a[a.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",a[a.UnknownError=9]="UnknownError"}(i=e.RecognitionCompletionStatus||(e.RecognitionCompletionStatus={})),e.RecognitionEndedEvent=class extends n{constructor(a,s,h,c,r,o,d,u){super("RecognitionEndedEvent",a,r,d===i.Success?p.EventType.Info:p.EventType.Error),this.privAudioSourceId=s,this.privAudioNodeId=h,this.privAuthFetchEventId=c,this.privStatus=d,this.privError=u,this.privServiceTag=o}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}get serviceTag(){return this.privServiceTag}get status(){return this.privStatus}get error(){return this.privError}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ServiceRecognizerBase=void 0;const p=t(60),n=t(4),i=t(79),a=t(2),s=t(206);class h{constructor(r,o,d,u,v){if(this.privConnectionConfigurationPromise=void 0,this.privConnectionPromise=void 0,this.privSetTimeout=setTimeout,this.privIsLiveAudio=!1,this.privAverageBytesPerMs=0,this.privEnableSpeakerId=!1,this.privExpectContentAssessmentResponse=!1,this.recognizeOverride=void 0,this.recognizeSpeaker=void 0,this.disconnectOverride=void 0,this.receiveMessageOverride=void 0,this.sendPrePayloadJSONOverride=void 0,this.postConnectImplOverride=void 0,this.configConnectionOverride=void 0,this.handleSpeechPhraseMessage=void 0,this.handleSpeechHypothesisMessage=void 0,!r)throw new n.ArgumentNullError("authentication");if(!o)throw new n.ArgumentNullError("connectionFactory");if(!d)throw new n.ArgumentNullError("audioSource");if(!u)throw new n.ArgumentNullError("recognizerConfig");this.privEnableSpeakerId=u.isSpeakerDiarizationEnabled,this.privMustReportEndOfStream=!1,this.privAuthentication=r,this.privConnectionFactory=o,this.privAudioSource=d,this.privRecognizerConfig=u,this.privIsDisposed=!1,this.privRecognizer=v,this.privRequestSession=new a.RequestSession(this.privAudioSource.id()),this.privConnectionEvents=new n.EventSource,this.privServiceEvents=new n.EventSource,this.privDynamicGrammar=new a.DynamicGrammarBuilder,this.privSpeechContext=new a.SpeechContext(this.privDynamicGrammar),this.privAgentConfig=new a.AgentConfig,this.privRecognizerConfig.parameters.getProperty(i.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?this.privSetTimeout=n.Timeout.setTimeout:(typeof window<"u"&&(this.privSetTimeout=window.setTimeout.bind(window)),typeof globalThis<"u"&&(this.privSetTimeout=globalThis.setTimeout.bind(globalThis))),this.connectionEvents.attach(l=>{if(l.name==="ConnectionClosedEvent"){const g=l;(g.statusCode===1003||g.statusCode===1007||g.statusCode===1002||g.statusCode===4e3||this.privRequestSession.numConnectionAttempts>this.privRecognizerConfig.maxRetryCount)&&this.cancelRecognitionLocal(i.CancellationReason.Error,g.statusCode===1007?i.CancellationErrorCode.BadRequestParameters:i.CancellationErrorCode.ConnectionFailure,`${g.reason} websocket error code: ${g.statusCode}`)}}),this.privEnableSpeakerId&&(this.privDiarizationSessionId=n.createNoDashGuid()),this.setLanguageIdJson(),this.setOutputDetailLevelJson()}setTranslationJson(){const r=this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0);if(r!==void 0){const o=r.split(","),d=this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationVoice,void 0),u=d!==void 0?"Synthesize":"None";if(this.privSpeechContext.setSection("translation",{onSuccess:{action:u},output:{interimResults:{mode:"Always"}},targetLanguages:o}),d!==void 0){const v={};for(const l of o)v[l]=d;this.privSpeechContext.setSection("synthesis",{defaultVoices:v})}}}setSpeechSegmentationTimeoutJson(){const r=this.privRecognizerConfig.parameters.getProperty(i.PropertyId.Speech_SegmentationSilenceTimeoutMs,void 0);if(r!==void 0){const o=this.recognitionMode===a.RecognitionMode.Conversation?"CONVERSATION":this.recognitionMode===a.RecognitionMode.Dictation?"DICTATION":"INTERACTIVE",d=parseInt(r,10),u=this.privSpeechContext.getSection("phraseDetection");u.mode=o,u[o]={segmentation:{mode:"Custom",segmentationSilenceTimeoutMs:d}},this.privSpeechContext.setSection("phraseDetection",u)}}setLanguageIdJson(){const r=this.privSpeechContext.getSection("phraseDetection");if(this.privRecognizerConfig.autoDetectSourceLanguages!==void 0){const o=this.privRecognizerConfig.autoDetectSourceLanguages.split(",");let d;d=this.privRecognizerConfig.languageIdMode==="Continuous"?"DetectContinuous":"DetectAtAudioStart",this.privSpeechContext.setSection("languageId",{Priority:"PrioritizeLatency",languages:o,mode:d,onSuccess:{action:"Recognize"},onUnknown:{action:"None"}}),this.privSpeechContext.setSection("phraseOutput",{interimResults:{resultType:"Auto"},phraseResults:{resultType:"Always"}});const u=this.privRecognizerConfig.sourceLanguageModels;u!==void 0&&(r.customModels=u,r.onInterim={action:"None"},r.onSuccess={action:"None"})}this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0&&(r.onInterim={action:"Translate"},r.onSuccess={action:"Translate"},this.privSpeechContext.setSection("phraseOutput",{interimResults:{resultType:"None"},phraseResults:{resultType:"None"}})),this.privSpeechContext.setSection("phraseDetection",r)}setOutputDetailLevelJson(){this.privEnableSpeakerId&&(this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true"?this.privSpeechContext.setWordLevelTimings():this.privRecognizerConfig.parameters.getProperty(a.OutputFormatPropertyName,i.OutputFormat[i.OutputFormat.Simple]).toLowerCase()===i.OutputFormat[i.OutputFormat.Detailed].toLocaleLowerCase()&&this.privSpeechContext.setDetailedOutputFormat())}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}get audioSource(){return this.privAudioSource}get speechContext(){return this.privSpeechContext}get dynamicGrammar(){return this.privDynamicGrammar}get agentConfig(){return this.privAgentConfig}set conversationTranslatorToken(r){this.privRecognizerConfig.parameters.setProperty(i.PropertyId.ConversationTranslator_Token,r)}set voiceProfileType(r){this.privRecognizerConfig.parameters.setProperty(i.PropertyId.SpeechServiceConnection_SpeakerIdMode,r)}set authentication(r){this.privAuthentication=r}isDisposed(){return this.privIsDisposed}async dispose(r){if(this.privIsDisposed=!0,this.privConnectionConfigurationPromise!==void 0)try{await(await this.privConnectionConfigurationPromise).dispose(r)}catch{return}}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}get recognitionMode(){return this.privRecognizerConfig.recognitionMode}async recognize(r,o,d){if(this.recognizeOverride!==void 0)return void await this.recognizeOverride(r,o,d);this.privConnectionConfigurationPromise=void 0,this.privRecognizerConfig.recognitionMode=r,this.setSpeechSegmentationTimeoutJson(),this.setTranslationJson(),this.privSuccessCallback=o,this.privErrorCallback=d,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events);const u=this.connectImpl();let v;try{const g=await this.audioSource.attach(this.privRequestSession.audioNodeId),m=await this.audioSource.format,S=await this.audioSource.deviceInfo;this.privIsLiveAudio=S.type&&S.type===a.type.Microphones,v=new p.ReplayableAudioNode(g,m.avgBytesPerSec),await this.privRequestSession.onAudioSourceAttachCompleted(v,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:S}}catch(g){throw await this.privRequestSession.onStopRecognizing(),g}try{await u}catch(g){return void await this.cancelRecognitionLocal(i.CancellationReason.Error,i.CancellationErrorCode.ConnectionFailure,g)}const l=new i.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,l),this.receiveMessage(),this.sendAudio(v).catch(async g=>{await this.cancelRecognitionLocal(i.CancellationReason.Error,i.CancellationErrorCode.RuntimeError,g)})}async stopRecognizing(){if(this.privRequestSession.isRecognizing)try{await this.audioSource.turnOff(),await this.sendFinalAudio(),await this.privRequestSession.onStopRecognizing(),await this.privRequestSession.turnCompletionPromise}finally{await this.privRequestSession.dispose()}}async connect(){return await this.connectImpl(),Promise.resolve()}connectAsync(r,o){this.connectImpl().then(()=>{try{r&&r()}catch(d){o&&o(d)}},d=>{try{o&&o(d)}catch{}})}async disconnect(){if(await this.cancelRecognitionLocal(i.CancellationReason.Error,i.CancellationErrorCode.NoError,"Disconnecting"),this.disconnectOverride!==void 0&&await this.disconnectOverride(),this.privConnectionPromise!==void 0)try{await(await this.privConnectionPromise).dispose()}catch{}this.privConnectionPromise=void 0}sendMessage(r){}async sendNetworkMessage(r,o){const d=typeof o=="string"?n.MessageType.Text:n.MessageType.Binary,u=typeof o=="string"?"application/json":"";return(await this.fetchConnection()).send(new s.SpeechConnectionMessage(d,r,this.privRequestSession.requestId,u,o))}set activityTemplate(r){this.privActivityTemplate=r}get activityTemplate(){return this.privActivityTemplate}set expectContentAssessmentResponse(r){this.privExpectContentAssessmentResponse=r}async sendTelemetryData(){const r=this.privRequestSession.getTelemetry();if(h.telemetryDataEnabled!==!0||this.privIsDisposed||r===null)return;if(h.telemetryData)try{h.telemetryData(r)}catch{}await(await this.fetchConnection()).send(new s.SpeechConnectionMessage(n.MessageType.Text,"telemetry",this.privRequestSession.requestId,"application/json",r))}async cancelRecognitionLocal(r,o,d){this.privRequestSession.isRecognizing&&(await this.privRequestSession.onStopRecognizing(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,r,o,d))}async receiveMessage(){try{if(this.privIsDisposed)return;let r=await this.fetchConnection();const o=await r.read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(!o)return this.receiveMessage();this.privServiceHasSentMessage=!0;const d=s.SpeechConnectionMessage.fromConnectionMessage(o);if(d.requestId.toLowerCase()===this.privRequestSession.requestId.toLowerCase())switch(d.path.toLowerCase()){case"turn.start":this.privMustReportEndOfStream=!0,this.privRequestSession.onServiceTurnStartResponse();break;case"speech.startdetected":const u=a.SpeechDetected.fromJSON(d.textBody),v=new i.RecognitionEventArgs(u.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,v);break;case"speech.enddetected":let l;l=d.textBody.length>0?d.textBody:"{ Offset: 0 }";const g=a.SpeechDetected.fromJSON(l),m=new i.RecognitionEventArgs(g.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,m);break;case"turn.end":await this.sendTelemetryData(),this.privRequestSession.isSpeechEnded&&this.privMustReportEndOfStream&&(this.privMustReportEndOfStream=!1,await this.cancelRecognitionLocal(i.CancellationReason.EndOfStream,i.CancellationErrorCode.NoError,void 0));const S=new i.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition),!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing)return void(this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,S));r=await this.fetchConnection(),await this.sendPrePayloadJSON(r);break;default:await this.processTypeSpecificMessages(d)||this.privServiceEvents&&this.serviceEvents.onEvent(new n.ServiceEvent(d.path.toLowerCase(),d.textBody))}return this.receiveMessage()}catch{return null}}updateSpeakerDiarizationAudioOffset(){const r=this.privRequestSession.recognitionBytesSent/this.privAverageBytesPerMs;this.privSpeechContext.setSpeakerDiarizationAudioOffsetMs(r)}sendSpeechContext(r,o){this.privEnableSpeakerId&&this.updateSpeakerDiarizationAudioOffset();const d=this.speechContext.toJSON();if(o&&this.privRequestSession.onSpeechContext(),d)return r.send(new s.SpeechConnectionMessage(n.MessageType.Text,"speech.context",this.privRequestSession.requestId,"application/json",d))}noOp(){}async sendPrePayloadJSON(r,o=!0){if(this.sendPrePayloadJSONOverride!==void 0)return this.sendPrePayloadJSONOverride(r);await this.sendSpeechContext(r,o),await this.sendWaveHeader(r)}async sendWaveHeader(r){const o=await this.audioSource.format;return r.send(new s.SpeechConnectionMessage(n.MessageType.Binary,"audio",this.privRequestSession.requestId,"audio/x-wav",o.header))}connectImpl(){return this.privConnectionPromise!==void 0?this.privConnectionPromise.then(r=>r.state()===n.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl())):(this.privConnectionPromise=this.retryableConnect(),this.privConnectionPromise.catch(()=>{}),this.postConnectImplOverride!==void 0?this.postConnectImplOverride(this.privConnectionPromise):this.privConnectionPromise)}sendSpeechServiceConfig(r,o,d){if(o.onSpeechContext(),h.telemetryDataEnabled!==!0){const u={context:{system:JSON.parse(d).context.system}};d=JSON.stringify(u)}if(this.privRecognizerConfig.parameters.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()==="true"){const u=JSON.parse(d);u.context.DisableReferenceChannel="True",u.context.MicSpec="1_0_0",d=JSON.stringify(u)}if(d)return r.send(new s.SpeechConnectionMessage(n.MessageType.Text,"speech.config",o.requestId,"application/json",d))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(r=>r.state()===n.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async sendAudio(r){const o=await this.audioSource.format;this.privAverageBytesPerMs=o.avgBytesPerSec/1e3;let d=Date.now();const u=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),v=o.avgBytesPerSec/1e3*parseInt(u,10),l=this.privRequestSession.recogNumber,g=async()=>{if(!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===l){const m=await this.fetchConnection(),S=await r.read();if(this.privRequestSession.isSpeechEnded)return;let y,C;if(!S||S.isEnd?(y=null,C=0):(y=S.buffer,this.privRequestSession.onAudioSent(y.byteLength),C=v>=this.privRequestSession.bytesSent?0:Math.max(0,d-Date.now())),C!==0&&await this.delay(C),y!==null&&(d=Date.now()+1e3*y.byteLength/(2*o.avgBytesPerSec)),!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===l){if(m.send(new s.SpeechConnectionMessage(n.MessageType.Binary,"audio",this.privRequestSession.requestId,null,y)).catch(()=>{this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition).catch(()=>{})}),!S?.isEnd)return g();this.privIsLiveAudio||this.privRequestSession.onSpeechEnded()}}};return g()}async retryableConnect(){let r=!1;this.privAuthFetchEventId=n.createNoDashGuid();const o=this.privRequestSession.sessionId;this.privConnectionId=o!==void 0?o:n.createNoDashGuid(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);let d=0,u="";for(;this.privRequestSession.numConnectionAttempts<=this.privRecognizerConfig.maxRetryCount;){const v=r?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId),l=await v;await this.privRequestSession.onAuthCompleted(!1);const g=this.privConnectionFactory.create(this.privRecognizerConfig,l,this.privConnectionId);this.privRequestSession.listenForServiceTelemetry(g.events),g.events.attach(S=>{this.connectionEvents.onEvent(S)});const m=await g.open();if(m.statusCode===200)return await this.privRequestSession.onConnectionEstablishCompleted(m.statusCode),Promise.resolve(g);m.statusCode===1006&&(r=!0),d=m.statusCode,u=m.reason,this.privRequestSession.onRetryConnection()}return await this.privRequestSession.onConnectionEstablishCompleted(d,u),Promise.reject(`Unable to contact server. StatusCode: ${d}, ${this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Endpoint)} Reason: ${u}`)}delay(r){return new Promise(o=>this.privSetTimeout(o,r))}writeBufferToConsole(r){let o="Buffer Size: ";if(r===null)o+="null";else{const d=new Uint8Array(r);o+=`${r.byteLength}\r
`;for(let u=0;u<r.byteLength;u++)o+=d[u].toString(16).padStart(2,"0")+" ",(u+1)%16==0&&(console.info(o),o="")}console.info(o)}async sendFinalAudio(){await(await this.fetchConnection()).send(new s.SpeechConnectionMessage(n.MessageType.Binary,"audio",this.privRequestSession.requestId,null,null))}async configureConnection(){const r=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(r):(await this.sendSpeechServiceConfig(r,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendPrePayloadJSON(r,!1),r)}}e.ServiceRecognizerBase=h,h.telemetryDataEnabled=!0},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechConnectionMessage=void 0;const p=t(4),n=t(54);class i extends p.ConnectionMessage{constructor(s,h,c,r,o,d,u,v){if(!h)throw new p.ArgumentNullError("path");if(!c)throw new p.ArgumentNullError("requestId");const l={};if(l[n.HeaderNames.Path]=h,l[n.HeaderNames.RequestId]=c,l[n.HeaderNames.RequestTimestamp]=new Date().toISOString(),r&&(l[n.HeaderNames.ContentType]=r),d&&(l[n.HeaderNames.RequestStreamId]=d),u)for(const g in u)g&&(l[g]=u[g]);v?super(s,o,l,v):super(s,o,l),this.privPath=h,this.privRequestId=c,this.privContentType=r,this.privStreamId=d,this.privAdditionalHeaders=u}get path(){return this.privPath}get requestId(){return this.privRequestId}get contentType(){return this.privContentType}get streamId(){return this.privStreamId}get additionalHeaders(){return this.privAdditionalHeaders}static fromConnectionMessage(s){let h=null,c=null,r=null,o=null;const d={};if(s.headers)for(const u in s.headers)u&&(u.toLowerCase()===n.HeaderNames.Path.toLowerCase()?h=s.headers[u]:u.toLowerCase()===n.HeaderNames.RequestId.toLowerCase()?c=s.headers[u]:u.toLowerCase()===n.HeaderNames.ContentType.toLowerCase()?r=s.headers[u]:u.toLowerCase()===n.HeaderNames.RequestStreamId.toLowerCase()?o=s.headers[u]:d[u]=s.headers[u]);return new i(s.messageType,h,c,r,s.body,o,d,s.id)}}e.SpeechConnectionMessage=i},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationServiceRecognizer=void 0;const p=t(79),n=t(2);class i extends n.ServiceRecognizerBase{constructor(s,h,c,r,o){super(s,h,c,r,o),this.handleSpeechPhraseMessage=async d=>this.handleSpeechPhrase(d),this.handleSpeechHypothesisMessage=d=>this.handleSpeechHypothesis(d)}processTypeSpecificMessages(s){}handleRecognizedCallback(s,h,c){}handleRecognizingCallback(s,h,c){}async processSpeechMessages(s){let h=!1;switch(s.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":this.handleSpeechHypothesisMessage&&this.handleSpeechHypothesisMessage(s.textBody),h=!0;break;case"speech.phrase":this.handleSpeechPhraseMessage&&await this.handleSpeechPhraseMessage(s.textBody),h=!0}return h}cancelRecognition(s,h,c,r,o){}async handleSpeechPhrase(s){const h=n.SimpleSpeechPhrase.fromJSON(s),c=n.EnumTranslation.implTranslateRecognitionResult(h.RecognitionStatus);let r;const o=new p.PropertyCollection;o.setProperty(p.PropertyId.SpeechServiceResponse_JsonResult,s);const d=h.Offset+this.privRequestSession.currentTurnAudioOffset;let u=d;if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+h.Offset+h.Duration),p.ResultReason.Canceled===c){const v=n.EnumTranslation.implTranslateCancelResult(h.RecognitionStatus),l=n.EnumTranslation.implTranslateCancelErrorCode(h.RecognitionStatus);await this.cancelRecognitionLocal(v,l,n.EnumTranslation.implTranslateErrorDetails(l))}else if(!this.privRequestSession.isSpeechEnded||c!==p.ResultReason.NoMatch||h.RecognitionStatus===n.RecognitionStatus.InitialSilenceTimeout){if(this.privRecognizerConfig.parameters.getProperty(n.OutputFormatPropertyName)===p.OutputFormat[p.OutputFormat.Simple])r=new p.SpeechRecognitionResult(this.privRequestSession.requestId,c,h.DisplayText,h.Duration,d,h.Language,h.LanguageDetectionConfidence,h.SpeakerId,void 0,s,o);else{const v=n.DetailedSpeechPhrase.fromJSON(s),l=v.Offset+this.privRequestSession.currentTurnAudioOffset,g=v.getJsonWithCorrectedOffsets(l);r=new p.SpeechRecognitionResult(this.privRequestSession.requestId,c,v.Text,v.Duration,l,v.Language,v.LanguageDetectionConfidence,v.SpeakerId,void 0,g,o),u=r.offset}this.handleRecognizedCallback(r,u,this.privRequestSession.sessionId)}}handleSpeechHypothesis(s){const h=n.SpeechHypothesis.fromJSON(s),c=h.Offset+this.privRequestSession.currentTurnAudioOffset,r=new p.PropertyCollection;r.setProperty(p.PropertyId.SpeechServiceResponse_JsonResult,s);const o=new p.SpeechRecognitionResult(this.privRequestSession.requestId,p.ResultReason.RecognizingSpeech,h.Text,h.Duration,c,h.Language,h.LanguageDetectionConfidence,h.SpeakerId,void 0,s,r);this.privRequestSession.onHypothesis(c),this.handleRecognizingCallback(o,h.Duration,this.privRequestSession.sessionId)}}e.ConversationServiceRecognizer=i},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RecognizerConfig=e.SpeechResultFormat=e.RecognitionMode=void 0;const p=t(79),n=t(2);var i;(function(a){a[a.Interactive=0]="Interactive",a[a.Conversation=1]="Conversation",a[a.Dictation=2]="Dictation"})(i=e.RecognitionMode||(e.RecognitionMode={})),function(a){a[a.Simple=0]="Simple",a[a.Detailed=1]="Detailed"}(e.SpeechResultFormat||(e.SpeechResultFormat={})),e.RecognizerConfig=class{constructor(a,s){this.privSpeechServiceConfig=a||new n.SpeechServiceConfig(new n.Context(null)),this.privParameters=s,this.privMaxRetryCount=parseInt(s.getProperty("SPEECH-Error-MaxRetryCount","4"),10),this.privLanguageIdMode=s.getProperty(p.PropertyId.SpeechServiceConnection_LanguageIdMode,void 0),this.privEnableSpeakerId=!1}get parameters(){return this.privParameters}get recognitionMode(){return this.privRecognitionMode}set recognitionMode(a){this.privRecognitionMode=a,this.privRecognitionActivityTimeout=a===i.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=i[a]}get SpeechServiceConfig(){return this.privSpeechServiceConfig}get recognitionActivityTimeout(){return this.privRecognitionActivityTimeout}get isContinuousRecognition(){return this.privRecognitionMode!==i.Interactive}get languageIdMode(){return this.privLanguageIdMode}get autoDetectSourceLanguages(){return this.parameters.getProperty(p.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)}get recognitionEndpointVersion(){return this.parameters.getProperty(p.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,void 0)}get sourceLanguageModels(){const a=[];let s=!1;if(this.autoDetectSourceLanguages!==void 0)for(const h of this.autoDetectSourceLanguages.split(",")){const c=h+p.PropertyId.SpeechServiceConnection_EndpointId.toString(),r=this.parameters.getProperty(c,void 0);r!==void 0?(a.push({language:h,endpoint:r}),s=!0):a.push({language:h,endpoint:""})}return s?a:void 0}get maxRetryCount(){return this.privMaxRetryCount}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}set isSpeakerDiarizationEnabled(a){this.privEnableSpeakerId=a}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WebsocketMessageFormatter=void 0;const p=t(4);e.WebsocketMessageFormatter=class{toConnectionMessage(n){const i=new p.Deferred;try{if(n.messageType===p.MessageType.Text){const a=n.textContent;let s={},h=null;if(a){const c=a.split(`\r
\r
`);c&&c.length>0&&(s=this.parseHeaders(c[0]),c.length>1&&(h=c[1]))}i.resolve(new p.ConnectionMessage(n.messageType,h,s,n.id))}else if(n.messageType===p.MessageType.Binary){const a=n.binaryContent;let s={},h=null;if(!a||a.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");const c=new DataView(a),r=c.getInt16(0);if(a.byteLength<r+2)throw new Error("Invalid binary message format. Header content missing.");let o="";for(let d=0;d<r;d++)o+=String.fromCharCode(c.getInt8(d+2));s=this.parseHeaders(o),a.byteLength>r+2&&(h=a.slice(2+r)),i.resolve(new p.ConnectionMessage(n.messageType,h,s,n.id))}}catch(a){i.reject(`Error formatting the message. Error: ${a}`)}return i.promise}fromConnectionMessage(n){const i=new p.Deferred;try{if(n.messageType===p.MessageType.Text){const a=`${this.makeHeaders(n)}\r
${n.textBody?n.textBody:""}`;i.resolve(new p.RawWebsocketMessage(p.MessageType.Text,a,n.id))}else if(n.messageType===p.MessageType.Binary){const a=this.makeHeaders(n),s=n.binaryBody,h=this.stringToArrayBuffer(a),c=new Int8Array(h),r=c.byteLength,o=new Int8Array(2+r+(s?s.byteLength:0));if(o[0]=r>>8&255,o[1]=255&r,o.set(c,2),s){const u=new Int8Array(s);o.set(u,2+r)}const d=o.buffer;i.resolve(new p.RawWebsocketMessage(p.MessageType.Binary,d,n.id))}}catch(a){i.reject(`Error formatting the message. ${a}`)}return i.promise}makeHeaders(n){let i="";if(n.headers)for(const a in n.headers)a&&(i+=`${a}: ${n.headers[a]}\r
`);return i}parseHeaders(n){const i={};if(n){const a=n.match(/[^\r\n]+/g);if(i){for(const s of a)if(s){const h=s.indexOf(":"),c=h>0?s.substr(0,h).trim().toLowerCase():s,r=h>0&&s.length>h+1?s.substr(h+1).trim():"";i[c]=r}}}return i}stringToArrayBuffer(n){const i=new ArrayBuffer(n.length),a=new DataView(i);for(let s=0;s<n.length;s++)a.setUint8(s,n.charCodeAt(s));return i}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechConnectionFactory=void 0;const p=t(60),n=t(2),i=t(79),a=t(134),s=t(2),h=t(54),c=t(135);class r extends a.ConnectionFactoryBase{constructor(){super(...arguments),this.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",this.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",this.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",this.universalUri="/speech/universal/v"}create(d,u,v){let l=d.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Endpoint,void 0);const g=d.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Region,void 0),m=a.ConnectionFactoryBase.getHostSuffix(g),S=d.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Host,"wss://"+g+".stt.speech"+m),y={},C=d.parameters.getProperty(i.PropertyId.SpeechServiceConnection_EndpointId,void 0),P=d.parameters.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(C?l&&l.search(c.QueryParameterNames.CustomSpeechDeploymentId)!==-1||(y[c.QueryParameterNames.CustomSpeechDeploymentId]=C):P&&(l&&l.search(c.QueryParameterNames.Language)!==-1||(y[c.QueryParameterNames.Language]=P)),l&&l.search(c.QueryParameterNames.Format)!==-1||(y[c.QueryParameterNames.Format]=d.parameters.getProperty(n.OutputFormatPropertyName,i.OutputFormat[i.OutputFormat.Simple]).toLowerCase()),d.autoDetectSourceLanguages!==void 0&&(y[c.QueryParameterNames.EnableLanguageId]="true"),this.setCommonUrlParams(d,y,l),!l)switch(d.recognitionMode){case s.RecognitionMode.Conversation:l=d.parameters.getProperty(n.ForceDictationPropertyName,"false")==="true"?S+this.dictationRelativeUri:d.recognitionEndpointVersion!==void 0&&parseInt(d.recognitionEndpointVersion,10)>1?`${S}${this.universalUri}${d.recognitionEndpointVersion}`:S+this.conversationRelativeUri;break;case s.RecognitionMode.Dictation:l=S+this.dictationRelativeUri;break;default:l=d.recognitionEndpointVersion!==void 0&&parseInt(d.recognitionEndpointVersion,10)>1?`${S}${this.universalUri}${d.recognitionEndpointVersion}`:S+this.interactiveRelativeUri}const R={};u.token!==void 0&&u.token!==""&&(R[u.headerName]=u.token),R[h.HeaderNames.ConnectionId]=v;const I=d.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",T=new p.WebsocketConnection(l,y,R,new s.WebsocketMessageFormatter,p.ProxyInfo.fromRecognizerConfig(d),I,v),w=T.uri;return d.parameters.setProperty(i.PropertyId.SpeechServiceConnection_Url,w),T}}e.SpeechConnectionFactory=r},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationTranscriberConnectionFactory=void 0;const p=t(60),n=t(79),i=t(2),a=t(134),s=t(2),h=t(54),c=t(135);class r extends a.ConnectionFactoryBase{constructor(){super(...arguments),this.universalUri="/speech/universal/v2"}create(d,u,v){let l=d.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Endpoint,void 0);const g=d.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Region,void 0),m=a.ConnectionFactoryBase.getHostSuffix(g),S=d.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Host,"wss://"+g+".stt.speech"+m),y={},C=d.parameters.getProperty(n.PropertyId.SpeechServiceConnection_EndpointId,void 0),P=d.parameters.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);C?l&&l.search(c.QueryParameterNames.CustomSpeechDeploymentId)!==-1||(y[c.QueryParameterNames.CustomSpeechDeploymentId]=C):P&&(l&&l.search(c.QueryParameterNames.Language)!==-1||(y[c.QueryParameterNames.Language]=P)),d.autoDetectSourceLanguages!==void 0&&(y[c.QueryParameterNames.EnableLanguageId]="true"),this.setV2UrlParams(d,y,l),l||(l=`${S}${this.universalUri}`);const R={};u.token!==void 0&&u.token!==""&&(R[u.headerName]=u.token),R[h.HeaderNames.ConnectionId]=v;const I=d.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",T=new p.WebsocketConnection(l,y,R,new s.WebsocketMessageFormatter,p.ProxyInfo.fromRecognizerConfig(d),I,v),w=T.uri;return d.parameters.setProperty(n.PropertyId.SpeechServiceConnection_Url,w),T}setV2UrlParams(d,u,v){new Map([[n.PropertyId.Speech_SegmentationSilenceTimeoutMs,c.QueryParameterNames.SegmentationSilenceTimeoutMs],[n.PropertyId.SpeechServiceConnection_EnableAudioLogging,c.QueryParameterNames.EnableAudioLogging],[n.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,c.QueryParameterNames.EndSilenceTimeoutMs],[n.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,c.QueryParameterNames.InitialSilenceTimeoutMs],[n.PropertyId.SpeechServiceResponse_PostProcessingOption,c.QueryParameterNames.Postprocessing],[n.PropertyId.SpeechServiceResponse_ProfanityOption,c.QueryParameterNames.Profanity],[n.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,c.QueryParameterNames.StableIntermediateThreshold]]).forEach((g,m)=>{this.setUrlParameter(m,g,d,u,v)});const l=JSON.parse(d.parameters.getProperty(i.ServicePropertiesPropertyName,"{}"));Object.keys(l).forEach(g=>{u[g]=l[g]})}}e.ConversationTranscriberConnectionFactory=r},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TranscriberConnectionFactory=void 0;const p=t(60),n=t(79),i=t(134),a=t(2),s=t(54),h=t(135);class c extends i.ConnectionFactoryBase{constructor(){super(...arguments),this.multiaudioRelativeUri="/speech/recognition/multiaudio"}create(o,d,u){let v=o.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Endpoint,void 0);const l=o.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Region,"centralus"),g="wss://transcribe."+l+".cts.speech"+i.ConnectionFactoryBase.getHostSuffix(l)+this.multiaudioRelativeUri,m=o.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Host,g),S={};this.setQueryParams(S,o,v),v||(v=m);const y={};d.token!==void 0&&d.token!==""&&(y[d.headerName]=d.token),y[s.HeaderNames.ConnectionId]=u,o.parameters.setProperty(n.PropertyId.SpeechServiceConnection_Url,v);const C=o.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new p.WebsocketConnection(v,S,y,new a.WebsocketMessageFormatter,p.ProxyInfo.fromRecognizerConfig(o),C,u)}setQueryParams(o,d,u){const v=d.parameters.getProperty(n.PropertyId.SpeechServiceConnection_EndpointId,void 0),l=d.parameters.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);v&&!(h.QueryParameterNames.CustomSpeechDeploymentId in o)&&(o[h.QueryParameterNames.CustomSpeechDeploymentId]=v),l&&!(h.QueryParameterNames.Language in o)&&(o[h.QueryParameterNames.Language]=l);const g=d.parameters.getProperty(n.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true",m=d.parameters.getProperty(a.OutputFormatPropertyName,n.OutputFormat[n.OutputFormat.Simple])!==n.OutputFormat[n.OutputFormat.Simple];(g||m)&&(o[h.QueryParameterNames.Format]=n.OutputFormat[n.OutputFormat.Detailed].toLowerCase()),this.setCommonUrlParams(d,o,u)}}e.TranscriberConnectionFactory=c},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TranslationConnectionFactory=void 0;const p=t(60),n=t(166),i=t(79),a=t(134),s=t(2),h=t(54),c=t(135);class r extends a.ConnectionFactoryBase{create(d,u,v){const l=this.getEndpointUrl(d),g={};d.autoDetectSourceLanguages!==void 0&&(g[c.QueryParameterNames.EnableLanguageId]="true"),this.setQueryParams(g,d,l);const m={};u.token!==void 0&&u.token!==""&&(m[u.headerName]=u.token),m[h.HeaderNames.ConnectionId]=v,d.parameters.setProperty(i.PropertyId.SpeechServiceConnection_Url,l);const S=d.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new p.WebsocketConnection(l,g,m,new s.WebsocketMessageFormatter,p.ProxyInfo.fromRecognizerConfig(d),S,v)}getEndpointUrl(d,u){const v=d.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Region),l=a.ConnectionFactoryBase.getHostSuffix(v);let g=d.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Endpoint,void 0);return g||(d.autoDetectSourceLanguages!==void 0?g=d.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Host,"wss://{region}.stt.speech"+l)+"/speech/universal/v2":g=d.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Host,"wss://{region}.s2s.speech"+l)+"/speech/translation/cognitiveservices/v1"),u===!0?g:n.StringUtils.formatString(g,{region:v})}setQueryParams(d,u,v){d.from=u.parameters.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage),d.to=u.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationToLanguages),d.scenario=u.recognitionMode===s.RecognitionMode.Interactive?"interactive":u.recognitionMode===s.RecognitionMode.Conversation?"conversation":"",this.setCommonUrlParams(u,d,v),this.setUrlParameter(i.PropertyId.SpeechServiceResponse_TranslationRequestStablePartialResult,c.QueryParameterNames.StableTranslation,u,d,v);const l=u.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationVoice,void 0);l!==void 0&&(d.voice=l,d.features="texttospeech")}}e.TranslationConnectionFactory=r},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EnumTranslation=void 0;const p=t(79),n=t(2);e.EnumTranslation=class{static implTranslateRecognitionResult(i,a=!1){let s=p.ResultReason.Canceled;switch(i){case n.RecognitionStatus.Success:s=p.ResultReason.RecognizedSpeech;break;case n.RecognitionStatus.EndOfDictation:s=a?p.ResultReason.RecognizedSpeech:p.ResultReason.NoMatch;break;case n.RecognitionStatus.NoMatch:case n.RecognitionStatus.InitialSilenceTimeout:case n.RecognitionStatus.BabbleTimeout:s=p.ResultReason.NoMatch;break;case n.RecognitionStatus.Error:case n.RecognitionStatus.BadRequest:case n.RecognitionStatus.Forbidden:default:s=p.ResultReason.Canceled}return s}static implTranslateCancelResult(i){let a=p.CancellationReason.EndOfStream;switch(i){case n.RecognitionStatus.Success:case n.RecognitionStatus.EndOfDictation:case n.RecognitionStatus.NoMatch:a=p.CancellationReason.EndOfStream;break;case n.RecognitionStatus.InitialSilenceTimeout:case n.RecognitionStatus.BabbleTimeout:case n.RecognitionStatus.Error:case n.RecognitionStatus.BadRequest:case n.RecognitionStatus.Forbidden:default:a=p.CancellationReason.Error}return a}static implTranslateCancelErrorCode(i){let a=p.CancellationErrorCode.NoError;switch(i){case n.RecognitionStatus.Error:a=p.CancellationErrorCode.ServiceError;break;case n.RecognitionStatus.TooManyRequests:a=p.CancellationErrorCode.TooManyRequests;break;case n.RecognitionStatus.BadRequest:a=p.CancellationErrorCode.BadRequestParameters;break;case n.RecognitionStatus.Forbidden:a=p.CancellationErrorCode.Forbidden;break;default:a=p.CancellationErrorCode.NoError}return a}static implTranslateErrorDetails(i){let a="The speech service encountered an internal error and could not continue.";switch(i){case p.CancellationErrorCode.Forbidden:a="The recognizer is using a free subscription that ran out of quota.";break;case p.CancellationErrorCode.BadRequestParameters:a="Invalid parameter or unsupported audio format in the request.";break;case p.CancellationErrorCode.TooManyRequests:a="The number of parallel requests exceeded the number of allowed concurrent transcriptions."}return a}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RecognitionStatus=e.SynthesisStatus=void 0,function(t){t[t.Success=0]="Success",t[t.SynthesisEnd=1]="SynthesisEnd",t[t.Error=2]="Error"}(e.SynthesisStatus||(e.SynthesisStatus={})),function(t){t[t.Success=0]="Success",t[t.NoMatch=1]="NoMatch",t[t.InitialSilenceTimeout=2]="InitialSilenceTimeout",t[t.BabbleTimeout=3]="BabbleTimeout",t[t.Error=4]="Error",t[t.EndOfDictation=5]="EndOfDictation",t[t.TooManyRequests=6]="TooManyRequests",t[t.BadRequest=7]="BadRequest",t[t.Forbidden=8]="Forbidden"}(e.RecognitionStatus||(e.RecognitionStatus={}))},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TranslationSynthesisEnd=void 0;const p=t(2);class n{constructor(a){this.privSynthesisEnd=JSON.parse(a),this.privSynthesisEnd.SynthesisStatus&&(this.privSynthesisEnd.SynthesisStatus=p.SynthesisStatus[this.privSynthesisEnd.SynthesisStatus]),this.privSynthesisEnd.Status&&(this.privSynthesisEnd.SynthesisStatus=p.SynthesisStatus[this.privSynthesisEnd.Status])}static fromJSON(a){return new n(a)}get SynthesisStatus(){return this.privSynthesisEnd.SynthesisStatus}get FailureReason(){return this.privSynthesisEnd.FailureReason}}e.TranslationSynthesisEnd=n},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TranslationHypothesis=void 0;const p=t(64),n=t(48);class i{constructor(s){this.privTranslationHypothesis=s,this.privTranslationHypothesis.Translation.TranslationStatus=n.TranslationStatus[this.privTranslationHypothesis.Translation.TranslationStatus]}static fromJSON(s){return new i(JSON.parse(s))}static fromTranslationResponse(s){p.Contracts.throwIfNullOrUndefined(s,"translationHypothesis");const h=s.SpeechHypothesis;return s.SpeechHypothesis=void 0,h.Translation=s,new i(h)}get Duration(){return this.privTranslationHypothesis.Duration}get Offset(){return this.privTranslationHypothesis.Offset}get Text(){return this.privTranslationHypothesis.Text}get Translation(){return this.privTranslationHypothesis.Translation}get Language(){return this.privTranslationHypothesis.PrimaryLanguage?.Language}}e.TranslationHypothesis=i},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TranslationPhrase=void 0;const p=t(64),n=t(2),i=t(48);class a{constructor(h){this.privTranslationPhrase=h,this.privTranslationPhrase.RecognitionStatus=n.RecognitionStatus[this.privTranslationPhrase.RecognitionStatus],this.privTranslationPhrase.Translation!==void 0&&(this.privTranslationPhrase.Translation.TranslationStatus=i.TranslationStatus[this.privTranslationPhrase.Translation.TranslationStatus])}static fromJSON(h){return new a(JSON.parse(h))}static fromTranslationResponse(h){p.Contracts.throwIfNullOrUndefined(h,"translationResponse");const c=h.SpeechPhrase;return h.SpeechPhrase=void 0,c.Translation=h,c.Text=c.DisplayText,new a(c)}get RecognitionStatus(){return this.privTranslationPhrase.RecognitionStatus}get Offset(){return this.privTranslationPhrase.Offset}get Duration(){return this.privTranslationPhrase.Duration}get Text(){return this.privTranslationPhrase.Text}get Language(){return this.privTranslationPhrase.PrimaryLanguage?.Language}get Confidence(){return this.privTranslationPhrase.PrimaryLanguage?.Confidence}get Translation(){return this.privTranslationPhrase.Translation}}e.TranslationPhrase=a},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TranslationServiceRecognizer=void 0;const p=t(4),n=t(79),i=t(2);class a extends i.ConversationServiceRecognizer{constructor(h,c,r,o,d){super(h,c,r,o,d),this.privTranslationRecognizer=d,this.connectionEvents.attach(u=>{u.name==="ConnectionEstablishedEvent"&&this.privTranslationRecognizer.onConnection()})}async processTypeSpecificMessages(h){const c=new n.PropertyCollection;let r=await this.processSpeechMessages(h);if(r)return!0;const o=async u=>{if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+u.Offset+u.Duration),u.RecognitionStatus===i.RecognitionStatus.Success){const v=this.fireEventForResult(u,c);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,v)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(v.result)}catch(l){this.privErrorCallback&&this.privErrorCallback(l)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}else{const v=i.EnumTranslation.implTranslateRecognitionResult(u.RecognitionStatus),l=new n.TranslationRecognitionResult(void 0,this.privRequestSession.requestId,v,u.Text,u.Duration,this.privRequestSession.currentTurnAudioOffset+u.Offset,u.Language,u.Confidence,void 0,h.textBody,c);if(v===n.ResultReason.Canceled){const g=i.EnumTranslation.implTranslateCancelResult(u.RecognitionStatus),m=i.EnumTranslation.implTranslateCancelErrorCode(u.RecognitionStatus);await this.cancelRecognitionLocal(g,m,i.EnumTranslation.implTranslateErrorDetails(m))}else{if(!this.privRequestSession.isSpeechEnded||v!==n.ResultReason.NoMatch||u.RecognitionStatus===i.RecognitionStatus.InitialSilenceTimeout){const g=new n.TranslationRecognitionEventArgs(l,l.offset,this.privRequestSession.sessionId);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,g)}catch{}}if(this.privSuccessCallback){try{this.privSuccessCallback(l)}catch(g){this.privErrorCallback&&this.privErrorCallback(g)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}r=!0}},d=(u,v)=>{const l=this.fireEventForResult(u,v);if(this.privRequestSession.onHypothesis(this.privRequestSession.currentTurnAudioOffset+l.offset),this.privTranslationRecognizer.recognizing)try{this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,l)}catch{}r=!0};switch(h.messageType===p.MessageType.Text&&c.setProperty(n.PropertyId.SpeechServiceResponse_JsonResult,h.textBody),h.path.toLowerCase()){case"translation.hypothesis":d(i.TranslationHypothesis.fromJSON(h.textBody),c);break;case"translation.response":const u=JSON.parse(h.textBody);if(u.SpeechPhrase)await o(i.TranslationPhrase.fromTranslationResponse(u));else{const l=JSON.parse(h.textBody);l.SpeechHypothesis&&d(i.TranslationHypothesis.fromTranslationResponse(l),c)}break;case"translation.phrase":await o(i.TranslationPhrase.fromJSON(h.textBody));break;case"translation.synthesis":this.sendSynthesisAudio(h.binaryBody,this.privRequestSession.sessionId),r=!0;break;case"audio.end":case"translation.synthesis.end":const v=i.TranslationSynthesisEnd.fromJSON(h.textBody);switch(v.SynthesisStatus){case i.SynthesisStatus.Error:if(this.privTranslationRecognizer.synthesizing){const l=new n.TranslationSynthesisResult(n.ResultReason.Canceled,void 0),g=new n.TranslationSynthesisEventArgs(l,this.privRequestSession.sessionId);try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,g)}catch{}}if(this.privTranslationRecognizer.canceled){const l=new n.TranslationRecognitionCanceledEventArgs(this.privRequestSession.sessionId,n.CancellationReason.Error,v.FailureReason,n.CancellationErrorCode.ServiceError,null);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,l)}catch{}}break;case i.SynthesisStatus.Success:this.sendSynthesisAudio(void 0,this.privRequestSession.sessionId)}r=!0}return r}cancelRecognition(h,c,r,o,d){const u=new n.PropertyCollection;if(u.setProperty(i.CancellationErrorCodePropertyName,n.CancellationErrorCode[o]),this.privTranslationRecognizer.canceled){const v=new n.TranslationRecognitionCanceledEventArgs(h,r,d,o,void 0);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,v)}catch{}}if(this.privSuccessCallback){const v=new n.TranslationRecognitionResult(void 0,c,n.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,d,void 0,u);try{this.privSuccessCallback(v),this.privSuccessCallback=void 0}catch{}}}handleRecognizingCallback(h,c,r){try{const o=new n.TranslationRecognitionEventArgs(n.TranslationRecognitionResult.fromSpeechRecognitionResult(h),c,r);this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,o)}catch{}}handleRecognizedCallback(h,c,r){try{const o=new n.TranslationRecognitionEventArgs(n.TranslationRecognitionResult.fromSpeechRecognitionResult(h),c,r);this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,o)}catch{}}fireEventForResult(h,c){let r,o,d;if(h.Translation.Translations!==void 0){r=new n.Translations;for(const g of h.Translation.Translations)r.set(g.Language,g.Text||g.DisplayText)}h instanceof i.TranslationPhrase?(o=h.Translation&&h.Translation.TranslationStatus===p.TranslationStatus.Success?n.ResultReason.TranslatedSpeech:n.ResultReason.RecognizedSpeech,d=h.Confidence):o=n.ResultReason.TranslatingSpeech;const u=h.Language,v=h.Offset+this.privRequestSession.currentTurnAudioOffset,l=new n.TranslationRecognitionResult(r,this.privRequestSession.requestId,o,h.Text,h.Duration,v,u,d,h.Translation.FailureReason,JSON.stringify(h),c);return new n.TranslationRecognitionEventArgs(l,v,this.privRequestSession.sessionId)}sendSynthesisAudio(h,c){const r=h===void 0?n.ResultReason.SynthesizingAudioCompleted:n.ResultReason.SynthesizingAudio,o=new n.TranslationSynthesisResult(r,h),d=new n.TranslationSynthesisEventArgs(o,c);if(this.privTranslationRecognizer.synthesizing)try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,d)}catch{}}}e.TranslationServiceRecognizer=a},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechDetected=void 0;class t{constructor(n){this.privSpeechStartDetected=JSON.parse(n)}static fromJSON(n){return new t(n)}get Offset(){return this.privSpeechStartDetected.Offset}}e.SpeechDetected=t},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechHypothesis=void 0;class t{constructor(n){this.privSpeechHypothesis=JSON.parse(n)}static fromJSON(n){return new t(n)}get Text(){return this.privSpeechHypothesis.Text}get Offset(){return this.privSpeechHypothesis.Offset}get Duration(){return this.privSpeechHypothesis.Duration}get Language(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSpeechHypothesis.SpeakerId}}e.SpeechHypothesis=t},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechKeyword=void 0;class t{constructor(n){this.privSpeechKeyword=JSON.parse(n)}static fromJSON(n){return new t(n)}get Status(){return this.privSpeechKeyword.Status}get Text(){return this.privSpeechKeyword.Text}get Offset(){return this.privSpeechKeyword.Offset}get Duration(){return this.privSpeechKeyword.Duration}}e.SpeechKeyword=t},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechServiceRecognizer=void 0;const p=t(79),n=t(2);class i extends n.ServiceRecognizerBase{constructor(s,h,c,r,o){super(s,h,c,r,o),this.privSpeechRecognizer=o}async processTypeSpecificMessages(s){let h;const c=new p.PropertyCollection;c.setProperty(p.PropertyId.SpeechServiceResponse_JsonResult,s.textBody);let r=!1;switch(s.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const o=n.SpeechHypothesis.fromJSON(s.textBody),d=o.Offset+this.privRequestSession.currentTurnAudioOffset;h=new p.SpeechRecognitionResult(this.privRequestSession.requestId,p.ResultReason.RecognizingSpeech,o.Text,o.Duration,d,o.Language,o.LanguageDetectionConfidence,void 0,void 0,s.textBody,c),this.privRequestSession.onHypothesis(d);const u=new p.SpeechRecognitionEventArgs(h,o.Duration,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,u)}catch{}r=!0;break;case"speech.phrase":const v=n.SimpleSpeechPhrase.fromJSON(s.textBody),l=n.EnumTranslation.implTranslateRecognitionResult(v.RecognitionStatus,this.privExpectContentAssessmentResponse);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+v.Offset+v.Duration),p.ResultReason.Canceled===l){const g=n.EnumTranslation.implTranslateCancelResult(v.RecognitionStatus),m=n.EnumTranslation.implTranslateCancelErrorCode(v.RecognitionStatus);await this.cancelRecognitionLocal(g,m,n.EnumTranslation.implTranslateErrorDetails(m))}else{if(!this.privRequestSession.isSpeechEnded||l!==p.ResultReason.NoMatch||v.RecognitionStatus===n.RecognitionStatus.InitialSilenceTimeout){if(this.privRecognizerConfig.parameters.getProperty(n.OutputFormatPropertyName)===p.OutputFormat[p.OutputFormat.Simple])h=new p.SpeechRecognitionResult(this.privRequestSession.requestId,l,v.DisplayText,v.Duration,v.Offset+this.privRequestSession.currentTurnAudioOffset,v.Language,v.LanguageDetectionConfidence,void 0,void 0,s.textBody,c);else{const m=n.DetailedSpeechPhrase.fromJSON(s.textBody),S=m.Offset+this.privRequestSession.currentTurnAudioOffset,y=m.getJsonWithCorrectedOffsets(S);h=new p.SpeechRecognitionResult(this.privRequestSession.requestId,l,m.RecognitionStatus===n.RecognitionStatus.Success?m.NBest[0].Display:void 0,m.Duration,S,m.Language,m.LanguageDetectionConfidence,void 0,void 0,y,c)}const g=new p.SpeechRecognitionEventArgs(h,h.offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognized)try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,g)}catch{}}if(this.privSuccessCallback){try{this.privSuccessCallback(h)}catch(g){this.privErrorCallback&&this.privErrorCallback(g)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}r=!0}return r}cancelRecognition(s,h,c,r,o){const d=new p.PropertyCollection;if(d.setProperty(n.CancellationErrorCodePropertyName,p.CancellationErrorCode[r]),this.privSpeechRecognizer.canceled){const u=new p.SpeechRecognitionCanceledEventArgs(c,o,r,void 0,s);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,u)}catch{}}if(this.privSuccessCallback){const u=new p.SpeechRecognitionResult(h,p.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,o,void 0,d);try{this.privSuccessCallback(u),this.privSuccessCallback=void 0}catch{}}}}e.SpeechServiceRecognizer=i},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationTranscriptionServiceRecognizer=void 0;const p=t(79),n=t(2);class i extends n.ServiceRecognizerBase{constructor(s,h,c,r,o){super(s,h,c,r,o),this.privConversationTranscriber=o,this.setSpeakerDiarizationJson()}setSpeakerDiarizationJson(){if(this.privEnableSpeakerId){const s=this.privSpeechContext.getSection("phraseDetection");s.mode="Conversation";const h={mode:"Anonymous"};h.audioSessionId=this.privDiarizationSessionId,h.audioOffsetMs=0,s.speakerDiarization=h,this.privSpeechContext.setSection("phraseDetection",s)}}async processTypeSpecificMessages(s){let h;const c=new p.PropertyCollection;c.setProperty(p.PropertyId.SpeechServiceResponse_JsonResult,s.textBody);let r=!1;switch(s.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const o=n.SpeechHypothesis.fromJSON(s.textBody),d=o.Offset+this.privRequestSession.currentTurnAudioOffset;h=new p.ConversationTranscriptionResult(this.privRequestSession.requestId,p.ResultReason.RecognizingSpeech,o.Text,o.Duration,d,o.Language,o.LanguageDetectionConfidence,void 0,void 0,s.textBody,c),this.privRequestSession.onHypothesis(d);const u=new p.ConversationTranscriptionEventArgs(h,o.Duration,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribing)try{this.privConversationTranscriber.transcribing(this.privConversationTranscriber,u)}catch{}r=!0;break;case"speech.phrase":const v=n.SimpleSpeechPhrase.fromJSON(s.textBody),l=n.EnumTranslation.implTranslateRecognitionResult(v.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+v.Offset+v.Duration),p.ResultReason.Canceled===l){const g=n.EnumTranslation.implTranslateCancelResult(v.RecognitionStatus),m=n.EnumTranslation.implTranslateCancelErrorCode(v.RecognitionStatus);await this.cancelRecognitionLocal(g,m,n.EnumTranslation.implTranslateErrorDetails(m))}else if(!this.privRequestSession.isSpeechEnded||l!==p.ResultReason.NoMatch||v.RecognitionStatus===n.RecognitionStatus.InitialSilenceTimeout){if(this.privRecognizerConfig.parameters.getProperty(n.OutputFormatPropertyName)===p.OutputFormat[p.OutputFormat.Simple])h=new p.ConversationTranscriptionResult(this.privRequestSession.requestId,l,v.DisplayText,v.Duration,v.Offset+this.privRequestSession.currentTurnAudioOffset,v.Language,v.LanguageDetectionConfidence,v.SpeakerId,void 0,s.textBody,c);else{const m=n.DetailedSpeechPhrase.fromJSON(s.textBody),S=m.Offset+this.privRequestSession.currentTurnAudioOffset,y=m.getJsonWithCorrectedOffsets(S);h=new p.ConversationTranscriptionResult(this.privRequestSession.requestId,l,m.RecognitionStatus===n.RecognitionStatus.Success?m.NBest[0].Display:void 0,m.Duration,S,m.Language,m.LanguageDetectionConfidence,v.SpeakerId,void 0,y,c)}const g=new p.ConversationTranscriptionEventArgs(h,h.offset,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribed)try{this.privConversationTranscriber.transcribed(this.privConversationTranscriber,g)}catch{}}r=!0}return r}cancelRecognition(s,h,c,r,o){if(new p.PropertyCollection().setProperty(n.CancellationErrorCodePropertyName,p.CancellationErrorCode[r]),this.privConversationTranscriber.canceled){const d=new p.ConversationTranscriptionCanceledEventArgs(c,o,r,void 0,s);try{this.privConversationTranscriber.canceled(this.privConversationTranscriber,d)}catch{}}}}e.ConversationTranscriptionServiceRecognizer=i},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TranscriptionServiceRecognizer=void 0;const p=t(4),n=t(79),i=t(2),a=t(206);class s extends i.ConversationServiceRecognizer{constructor(c,r,o,d,u){super(c,r,o,d,u),this.privTranscriberRecognizer=u,this.sendPrePayloadJSONOverride=v=>this.sendTranscriptionStartJSON(v),this.privRecognizerConfig.parameters.getProperty(n.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps)==="true"&&this.privSpeechContext.setWordLevelTimings()}async sendSpeechEventAsync(c,r){if(this.privRequestSession.isRecognizing){const o=await this.fetchConnection();await this.sendSpeechEvent(o,this.createSpeechEventPayload(c,r))}}async sendMeetingSpeechEventAsync(c,r){if(this.privRequestSession.isRecognizing){const o=await this.fetchConnection();await this.sendSpeechEvent(o,this.createMeetingSpeechEventPayload(c,r))}}processTypeSpecificMessages(c){return this.processSpeechMessages(c)}handleRecognizedCallback(c,r,o){try{const d=new n.SpeechRecognitionEventArgs(c,r,o);if(this.privTranscriberRecognizer.recognized(this.privTranscriberRecognizer,d),this.privSuccessCallback){try{this.privSuccessCallback(c)}catch(u){this.privErrorCallback&&this.privErrorCallback(u)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}catch{}}handleRecognizingCallback(c,r,o){try{const d=new n.SpeechRecognitionEventArgs(c,r,o);this.privTranscriberRecognizer.recognizing(this.privTranscriberRecognizer,d)}catch{}}cancelRecognition(c,r,o,d,u){const v=new n.PropertyCollection;if(v.setProperty(i.CancellationErrorCodePropertyName,n.CancellationErrorCode[d]),this.privTranscriberRecognizer.IsMeetingRecognizer()){if(this.privTranscriberRecognizer.canceled){const l=new n.MeetingTranscriptionCanceledEventArgs(o,u,d,void 0,c);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,l)}catch{}}}else if(this.privTranscriberRecognizer.canceled){const l=new n.ConversationTranscriptionCanceledEventArgs(o,u,d,void 0,c);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,l)}catch{}}if(this.privSuccessCallback){const l=new n.SpeechRecognitionResult(r,n.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,u,void 0,v);try{this.privSuccessCallback(l),this.privSuccessCallback=void 0}catch{}}}async sendTranscriptionStartJSON(c){if(await this.sendSpeechContext(c,!0),this.privTranscriberRecognizer.IsMeetingRecognizer()){const r=this.privTranscriberRecognizer.getMeetingInfo(),o=this.createMeetingSpeechEventPayload(r,"start");await this.sendSpeechEvent(c,o)}else{const r=this.privTranscriberRecognizer.getConversationInfo(),o=this.createSpeechEventPayload(r,"start");await this.sendSpeechEvent(c,o)}await this.sendWaveHeader(c)}sendSpeechEvent(c,r){const o=JSON.stringify(r);if(o)return c.send(new a.SpeechConnectionMessage(p.MessageType.Text,"speech.event",this.privRequestSession.requestId,"application/json",o))}createSpeechEventPayload(c,r){const o={id:"meeting",name:r,meeting:c.conversationProperties};return o.meeting.id=c.id,o.meeting.attendees=c.participants,o}createMeetingSpeechEventPayload(c,r){const o={id:"meeting",name:r,meeting:c.meetingProperties};return o.meeting.id=c.id,o.meeting.attendees=c.participants,o}}e.TranscriptionServiceRecognizer=s},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DetailedSpeechPhrase=void 0;const p=t(2);class n{constructor(a){this.privDetailedSpeechPhrase=JSON.parse(a),this.privDetailedSpeechPhrase.RecognitionStatus=p.RecognitionStatus[this.privDetailedSpeechPhrase.RecognitionStatus]}static fromJSON(a){return new n(a)}getJsonWithCorrectedOffsets(a){if(this.privDetailedSpeechPhrase.NBest){let s;for(const h of this.privDetailedSpeechPhrase.NBest)if(h.Words&&h.Words[0]){s=h.Words[0].Offset;break}if(s&&s<a){const h=a-s;for(const c of this.privDetailedSpeechPhrase.NBest){if(c.Words)for(const r of c.Words)r.Offset+=h;if(c.DisplayWords)for(const r of c.DisplayWords)r.Offset+=h}}}return JSON.stringify(this.privDetailedSpeechPhrase)}get RecognitionStatus(){return this.privDetailedSpeechPhrase.RecognitionStatus}get NBest(){return this.privDetailedSpeechPhrase.NBest}get Duration(){return this.privDetailedSpeechPhrase.Duration}get Offset(){return this.privDetailedSpeechPhrase.Offset}get Language(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence}get Text(){return this.privDetailedSpeechPhrase.NBest&&this.privDetailedSpeechPhrase.NBest[0]?this.privDetailedSpeechPhrase.NBest[0].Display||this.privDetailedSpeechPhrase.NBest[0].DisplayText:this.privDetailedSpeechPhrase.DisplayText}get SpeakerId(){return this.privDetailedSpeechPhrase.SpeakerId}}e.DetailedSpeechPhrase=n},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SimpleSpeechPhrase=void 0;const p=t(2);class n{constructor(a){this.privSimpleSpeechPhrase=JSON.parse(a),this.privSimpleSpeechPhrase.RecognitionStatus=p.RecognitionStatus[this.privSimpleSpeechPhrase.RecognitionStatus]}static fromJSON(a){return new n(a)}get RecognitionStatus(){return this.privSimpleSpeechPhrase.RecognitionStatus}get DisplayText(){return this.privSimpleSpeechPhrase.DisplayText}get Offset(){return this.privSimpleSpeechPhrase.Offset}get Duration(){return this.privSimpleSpeechPhrase.Duration}get Language(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSimpleSpeechPhrase.SpeakerId}}e.SimpleSpeechPhrase=n},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AddedLmIntent=void 0,e.AddedLmIntent=class{constructor(t,p){this.modelImpl=t,this.intentName=p}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.IntentServiceRecognizer=void 0;const p=t(4),n=t(79),i=t(2);class a extends i.ServiceRecognizerBase{constructor(h,c,r,o,d){super(h,c,r,o,d),this.privIntentRecognizer=d,this.privIntentDataSent=!1}setIntents(h,c){this.privAddedLmIntents=h,this.privUmbrellaIntent=c,this.privIntentDataSent=!0}processTypeSpecificMessages(h){let c,r,o=!1;const d=new n.PropertyCollection;switch(h.messageType===p.MessageType.Text&&d.setProperty(n.PropertyId.SpeechServiceResponse_JsonResult,h.textBody),h.path.toLowerCase()){case"speech.hypothesis":const v=i.SpeechHypothesis.fromJSON(h.textBody);if(c=new n.IntentRecognitionResult(void 0,this.privRequestSession.requestId,n.ResultReason.RecognizingIntent,v.Text,v.Duration,v.Offset+this.privRequestSession.currentTurnAudioOffset,v.Language,v.LanguageDetectionConfidence,void 0,h.textBody,d),this.privRequestSession.onHypothesis(c.offset),r=new n.IntentRecognitionEventArgs(c,v.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId),this.privIntentRecognizer.recognizing)try{this.privIntentRecognizer.recognizing(this.privIntentRecognizer,r)}catch{}o=!0;break;case"speech.phrase":const l=i.SimpleSpeechPhrase.fromJSON(h.textBody);c=new n.IntentRecognitionResult(void 0,this.privRequestSession.requestId,i.EnumTranslation.implTranslateRecognitionResult(l.RecognitionStatus),l.DisplayText,l.Duration,l.Offset+this.privRequestSession.currentTurnAudioOffset,l.Language,l.LanguageDetectionConfidence,void 0,h.textBody,d),r=new n.IntentRecognitionEventArgs(c,c.offset,this.privRequestSession.sessionId);const g=()=>{if(this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,r)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(c)}catch(S){this.privErrorCallback&&this.privErrorCallback(S)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}};this.privIntentDataSent===!1||n.ResultReason.NoMatch===r.result.reason?(this.privRequestSession.onPhraseRecognized(r.offset+r.result.duration),g()):this.privPendingIntentArgs=r,o=!0;break;case"response":if(r=this.privPendingIntentArgs,this.privPendingIntentArgs=void 0,r===void 0){if(h.textBody==="")return;r=new n.IntentRecognitionEventArgs(new n.IntentRecognitionResult,0,this.privRequestSession.sessionId)}const m=i.IntentResponse.fromJSON(h.textBody);if(m!==null&&m.topScoringIntent&&m.topScoringIntent.intent){let S=this.privAddedLmIntents[m.topScoringIntent.intent];if(this.privUmbrellaIntent!==void 0&&(S=this.privUmbrellaIntent),S){const y=S===void 0||S.intentName===void 0?m.topScoringIntent.intent:S.intentName;let C=r.result.reason;y!==void 0&&(C=n.ResultReason.RecognizedIntent);const P=r.result.properties!==void 0?r.result.properties:new n.PropertyCollection;P.setProperty(n.PropertyId.LanguageUnderstandingServiceResponse_JsonResult,h.textBody),r=new n.IntentRecognitionEventArgs(new n.IntentRecognitionResult(y,r.result.resultId,C,r.result.text,r.result.duration,r.result.offset,void 0,void 0,r.result.errorDetails,r.result.json,P),r.offset,r.sessionId)}}if(this.privRequestSession.onPhraseRecognized(r.offset+r.result.duration),this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,r)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(r.result)}catch(S){this.privErrorCallback&&this.privErrorCallback(S)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}o=!0}const u=new p.Deferred;return u.resolve(o),u.promise}cancelRecognition(h,c,r,o,d){const u=new n.PropertyCollection;if(u.setProperty(i.CancellationErrorCodePropertyName,n.CancellationErrorCode[o]),this.privIntentRecognizer.canceled){const v=new n.IntentRecognitionCanceledEventArgs(r,d,o,void 0,void 0,h);try{this.privIntentRecognizer.canceled(this.privIntentRecognizer,v)}catch{}}if(this.privSuccessCallback){const v=new n.IntentRecognitionResult(void 0,c,n.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,d,void 0,u);try{this.privSuccessCallback(v),this.privSuccessCallback=void 0}catch{}}}}e.IntentServiceRecognizer=a},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.IntentResponse=void 0;class t{constructor(n){this.privIntentResponse=n===""?{}:JSON.parse(n)}static fromJSON(n){return new t(n)}get query(){return this.privIntentResponse.query}get topScoringIntent(){return this.privIntentResponse.topScoringIntent}get entities(){return this.privIntentResponse.entities}}e.IntentResponse=t},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RequestSession=void 0;const p=t(4),n=t(204),i=t(234);e.RequestSession=class{constructor(a){this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecognitionBytesSent=0,this.privRecogNumber=0,this.privInTurn=!1,this.privConnectionAttempts=0,this.privAudioSourceId=a,this.privRequestId=p.createNoDashGuid(),this.privAudioNodeId=p.createNoDashGuid(),this.privTurnDeferral=new p.Deferred,this.privTurnDeferral.resolve()}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get audioNodeId(){return this.privAudioNodeId}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSpeechEnded(){return this.privIsSpeechEnded}get isRecognizing(){return this.privIsRecognizing}get currentTurnAudioOffset(){return this.privTurnStartAudioOffset}get recogNumber(){return this.privRecogNumber}get numConnectionAttempts(){return this.privConnectionAttempts}get bytesSent(){return this.privBytesSent}get recognitionBytesSent(){return this.privRecognitionBytesSent}listenForServiceTelemetry(a){this.privServiceTelemetryListener&&this.privDetachables.push(a.attachListener(this.privServiceTelemetryListener))}startNewRecognition(){this.privRecognitionBytesSent=0,this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRecogNumber++,this.privServiceTelemetryListener=new i.ServiceTelemetryListener(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new n.RecognitionTriggeredEvent(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}async onAudioSourceAttachCompleted(a,s){this.privAudioNode=a,this.privIsAudioNodeDetached=!1,s?await this.onComplete():this.onEvent(new n.ListeningStartedEvent(this.privRequestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}onPreConnectionStart(a,s){this.privAuthFetchEventId=a,this.privSessionId=s,this.onEvent(new n.ConnectingToServiceEvent(this.privRequestId,this.privAuthFetchEventId,this.privSessionId))}async onAuthCompleted(a){a&&await this.onComplete()}async onConnectionEstablishCompleted(a,s){if(a===200)return this.onEvent(new n.RecognitionStartedEvent(this.requestId,this.privAudioSourceId,this.privAudioNodeId,this.privAuthFetchEventId,this.privSessionId)),this.privAudioNode&&this.privAudioNode.replay(),this.privTurnStartAudioOffset=this.privLastRecoOffset,void(this.privBytesSent=0);a===403&&await this.onComplete()}async onServiceTurnEndResponse(a){this.privTurnDeferral.resolve(),!a||this.isSpeechEnded?(await this.onComplete(),this.privInTurn=!1):(this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privAudioNode.replay())}onSpeechContext(){this.privRequestId=p.createNoDashGuid()}onServiceTurnStartResponse(){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new p.Deferred}onHypothesis(a){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(a)))}onPhraseRecognized(a){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(a)),this.onServiceRecognized(a)}onServiceRecognized(a){this.privLastRecoOffset=a,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(a),this.privConnectionAttempts=0}onAudioSent(a){this.privBytesSent+=a,this.privRecognitionBytesSent+=a}onRetryConnection(){this.privConnectionAttempts++}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const a of this.privDetachables)await a.detach();this.privServiceTelemetryListener&&this.privServiceTelemetryListener.dispose(),this.privIsRecognizing=!1}}getTelemetry(){return this.privServiceTelemetryListener.hasTelemetry?this.privServiceTelemetryListener.getTelemetry():null}async onStopRecognizing(){await this.onComplete()}onSpeechEnded(){this.privIsSpeechEnded=!0}onEvent(a){this.privServiceTelemetryListener&&this.privServiceTelemetryListener.onEvent(a),p.Events.instance.onEvent(a)}async onComplete(){this.privIsRecognizing&&(this.privIsRecognizing=!1,await this.detachAudioNode())}async detachAudioNode(){this.privIsAudioNodeDetached||(this.privIsAudioNodeDetached=!0,this.privAudioNode&&await this.privAudioNode.detach())}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ServiceTelemetryListener=void 0;const p=t(4),n=t(204);e.ServiceTelemetryListener=class{constructor(i,a,s){this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privRequestId=i,this.privAudioSourceId=a,this.privAudioNodeId=s,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}phraseReceived(i){i>0&&this.privPhraseLatencies.push(Date.now()-i)}hypothesisReceived(i){i>0&&this.privHypothesisLatencies.push(Date.now()-i)}onEvent(i){!this.privIsDisposed&&(i instanceof n.RecognitionTriggeredEvent&&i.requestId===this.privRequestId&&(this.privListeningTriggerMetric={End:i.eventTime,Name:"ListeningTrigger",Start:i.eventTime}),i instanceof p.AudioStreamNodeAttachingEvent&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=i.eventTime),i instanceof p.AudioStreamNodeAttachedEvent&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=i.eventTime),i instanceof p.AudioSourceErrorEvent&&i.audioSourceId===this.privAudioSourceId&&(this.privMicMetric||(this.privMicMetric={End:i.eventTime,Error:i.error,Name:"Microphone",Start:this.privMicStartTime})),i instanceof p.AudioStreamNodeErrorEvent&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:i.eventTime,Error:i.error,Name:"Microphone",Start:this.privMicStartTime})),i instanceof p.AudioStreamNodeDetachedEvent&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:i.eventTime,Name:"Microphone",Start:this.privMicStartTime})),i instanceof n.ConnectingToServiceEvent&&i.requestId===this.privRequestId&&(this.privConnectionId=i.sessionId),i instanceof p.ConnectionStartEvent&&i.connectionId===this.privConnectionId&&(this.privConnectionStartTime=i.eventTime),i instanceof p.ConnectionEstablishedEvent&&i.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:i.eventTime,Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),i instanceof p.ConnectionEstablishErrorEvent&&i.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:i.eventTime,Error:this.getConnectionError(i.statusCode),Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),i instanceof p.ConnectionMessageReceivedEvent&&i.connectionId===this.privConnectionId&&i.message&&i.message.headers&&i.message.headers.path)&&(this.privReceivedMessages[i.message.headers.path]||(this.privReceivedMessages[i.message.headers.path]=new Array),this.privReceivedMessages[i.message.headers.path].length<50&&this.privReceivedMessages[i.message.headers.path].push(i.networkReceivedTime))}getTelemetry(){const i=new Array;this.privListeningTriggerMetric&&i.push(this.privListeningTriggerMetric),this.privMicMetric&&i.push(this.privMicMetric),this.privConnectionEstablishMetric&&i.push(this.privConnectionEstablishMetric),this.privPhraseLatencies.length>0&&i.push({PhraseLatencyMs:this.privPhraseLatencies}),this.privHypothesisLatencies.length>0&&i.push({FirstHypothesisLatencyMs:this.privHypothesisLatencies});const a={Metrics:i,ReceivedMessages:this.privReceivedMessages},s=JSON.stringify(a);return this.privReceivedMessages={},this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privPhraseLatencies=[],this.privHypothesisLatencies=[],s}get hasTelemetry(){return Object.keys(this.privReceivedMessages).length!==0||this.privListeningTriggerMetric!==null||this.privMicMetric!==null||this.privConnectionEstablishMetric!==null||this.privPhraseLatencies.length!==0||this.privHypothesisLatencies.length!==0}dispose(){this.privIsDisposed=!0}getConnectionError(i){switch(i){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+i.toString()}}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechContext=void 0,e.SpeechContext=class{constructor(t){this.privContext={},this.privDynamicGrammar=t}getSection(t){return this.privContext[t]||{}}setSection(t,p){this.privContext[t]=p}setPronunciationAssessmentParams(t,p,n=!1){this.privContext.phraseDetection===void 0&&(this.privContext.phraseDetection={enrichment:{pronunciationAssessment:{}}}),this.privContext.phraseDetection.enrichment===void 0&&(this.privContext.phraseDetection.enrichment={pronunciationAssessment:{}}),this.privContext.phraseDetection.enrichment.pronunciationAssessment=JSON.parse(t),n&&(this.privContext.phraseDetection.mode="Conversation"),this.setWordLevelTimings(),this.privContext.phraseOutput.detailed.options.push("PronunciationAssessment"),this.privContext.phraseOutput.detailed.options.indexOf("SNR")===-1&&this.privContext.phraseOutput.detailed.options.push("SNR"),p&&(this.privContext.phraseDetection.enrichment.contentAssessment={topic:p},this.privContext.phraseOutput.detailed.options.push("ContentAssessment"))}setDetailedOutputFormat(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]},format:{}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format="Detailed"}setWordLevelTimings(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]},format:{}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format="Detailed",this.privContext.phraseOutput.detailed.options.indexOf("WordTimings")===-1&&this.privContext.phraseOutput.detailed.options.push("WordTimings")}setSpeakerDiarizationAudioOffsetMs(t){this.privContext.phraseDetection.speakerDiarization.audioOffsetMs=t}toJSON(){const t=this.privDynamicGrammar.generateGrammarObject();return this.setSection("dgi",t),JSON.stringify(this.privContext)}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DynamicGrammarBuilder=void 0,e.DynamicGrammarBuilder=class{addPhrase(t){this.privPhrases||(this.privPhrases=[]),t instanceof Array?this.privPhrases=this.privPhrases.concat(t):this.privPhrases.push(t)}clearPhrases(){this.privPhrases=void 0}addReferenceGrammar(t){this.privGrammars||(this.privGrammars=[]),t instanceof Array?this.privGrammars=this.privGrammars.concat(t):this.privGrammars.push(t)}clearGrammars(){this.privGrammars=void 0}generateGrammarObject(){if(this.privGrammars===void 0&&this.privPhrases===void 0)return;const t={};if(t.ReferenceGrammars=this.privGrammars,this.privPhrases!==void 0&&this.privPhrases.length!==0){const p=[];this.privPhrases.forEach(n=>{p.push({Text:n})}),t.Groups=[{Type:"Generic",Items:p}]}return t}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DialogServiceAdapter=void 0;const p=t(60),n=t(29),i=t(4),a=t(85),s=t(79),h=t(239),c=t(2),r=t(241),o=t(206);class d extends c.ServiceRecognizerBase{constructor(v,l,g,m,S){super(v,l,g,m,S),this.privEvents=new i.EventSource,this.privDialogServiceConnector=S,this.receiveMessageOverride=()=>this.receiveDialogMessageOverride(),this.privTurnStateManager=new h.DialogServiceTurnStateManager,this.recognizeOverride=(y,C,P)=>this.listenOnce(y,C,P),this.postConnectImplOverride=y=>this.dialogConnectImpl(y),this.configConnectionOverride=y=>this.configConnection(y),this.disconnectOverride=()=>this.privDisconnect(),this.privDialogAudioSource=g,this.agentConfigSent=!1,this.privLastResult=null,this.connectionEvents.attach(y=>{y.name==="ConnectionClosedEvent"&&(this.terminateMessageLoop=!0)})}async sendMessage(v){const l=i.createGuid(),g=i.createNoDashGuid(),m={context:{interactionId:l},messagePayload:JSON.parse(v),version:.5},S=JSON.stringify(m);await(await this.fetchConnection()).send(new o.SpeechConnectionMessage(i.MessageType.Text,"agent",g,"application/json",S))}async privDisconnect(){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,s.CancellationReason.Error,s.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,this.agentConfigSent=!1}processTypeSpecificMessages(v){const l=new s.PropertyCollection;let g,m;switch(v.messageType===i.MessageType.Text&&l.setProperty(s.PropertyId.SpeechServiceResponse_JsonResult,v.textBody),v.path.toLowerCase()){case"speech.phrase":const y=c.SimpleSpeechPhrase.fromJSON(v.textBody);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+y.Offset+y.Duration),y.RecognitionStatus!==c.RecognitionStatus.TooManyRequests&&y.RecognitionStatus!==c.RecognitionStatus.Error){const w=this.fireEventForResult(y,l);if(this.privLastResult=w.result,this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,w)}catch{}}m=!0;break;case"speech.hypothesis":const C=c.SpeechHypothesis.fromJSON(v.textBody),P=C.Offset+this.privRequestSession.currentTurnAudioOffset;g=new s.SpeechRecognitionResult(this.privRequestSession.requestId,s.ResultReason.RecognizingSpeech,C.Text,C.Duration,P,C.Language,C.LanguageDetectionConfidence,void 0,void 0,v.textBody,l),this.privRequestSession.onHypothesis(P);const R=new s.SpeechRecognitionEventArgs(g,C.Duration,this.privRequestSession.sessionId);if(this.privDialogServiceConnector.recognizing)try{this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector,R)}catch{}m=!0;break;case"speech.keyword":const I=c.SpeechKeyword.fromJSON(v.textBody);g=new s.SpeechRecognitionResult(this.privRequestSession.requestId,I.Status==="Accepted"?s.ResultReason.RecognizedKeyword:s.ResultReason.NoMatch,I.Text,I.Duration,I.Offset,void 0,void 0,void 0,void 0,v.textBody,l),I.Status!=="Accepted"&&(this.privLastResult=g);const T=new s.SpeechRecognitionEventArgs(g,g.duration,g.resultId);if(this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,T)}catch{}m=!0;break;case"audio":{const w=v.requestId.toUpperCase(),E=this.privTurnStateManager.GetTurn(w);try{v.binaryBody?E.audioStream.write(v.binaryBody):E.endAudioStream()}catch{}}m=!0;break;case"response":this.handleResponseMessage(v),m=!0}const S=new i.Deferred;return S.resolve(m),S.promise}async cancelRecognition(v,l,g,m,S){if(this.terminateMessageLoop=!0,this.privRequestSession.isRecognizing&&await this.privRequestSession.onStopRecognizing(),this.privDialogServiceConnector.canceled){const y=new s.PropertyCollection;y.setProperty(c.CancellationErrorCodePropertyName,s.CancellationErrorCode[m]);const C=new s.SpeechRecognitionCanceledEventArgs(g,S,m,void 0,v);try{this.privDialogServiceConnector.canceled(this.privDialogServiceConnector,C)}catch{}if(this.privSuccessCallback){const P=new s.SpeechRecognitionResult(void 0,s.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,S,void 0,y);try{this.privSuccessCallback(P),this.privSuccessCallback=void 0}catch{}}}}async listenOnce(v,l,g){this.privRecognizerConfig.recognitionMode=v,this.privSuccessCallback=l,this.privErrorCallback=g,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privDialogAudioSource.events),this.privRecognizerConfig.parameters.setProperty(s.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);const m=this.connectImpl(),S=this.sendPreAudioMessages(),y=await this.privDialogAudioSource.attach(this.privRequestSession.audioNodeId),C=await this.privDialogAudioSource.format,P=await this.privDialogAudioSource.deviceInfo,R=new p.ReplayableAudioNode(y,C.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(R,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:P};try{await m,await S}catch(T){return await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,s.CancellationReason.Error,s.CancellationErrorCode.ConnectionFailure,T),Promise.resolve()}const I=new s.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,I),this.sendAudio(R).then(()=>{},async T=>{await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,s.CancellationReason.Error,s.CancellationErrorCode.RuntimeError,T)})}dialogConnectImpl(v){return this.privConnectionLoop=this.startMessageLoop(),v}receiveDialogMessageOverride(){const v=new i.Deferred,l=async()=>{try{const g=this.isDisposed(),m=!this.isDisposed()&&this.terminateMessageLoop;if(g||m)return void v.resolve(void 0);const S=await this.fetchConnection(),y=await S.read();if(!y)return l();const C=o.SpeechConnectionMessage.fromConnectionMessage(y);switch(C.path.toLowerCase()){case"turn.start":{const E=C.requestId.toUpperCase();E!==this.privRequestSession.requestId.toUpperCase()?this.privTurnStateManager.StartTurn(E):this.privRequestSession.onServiceTurnStartResponse()}break;case"speech.startdetected":const P=c.SpeechDetected.fromJSON(C.textBody),R=new s.RecognitionEventArgs(P.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,R);break;case"speech.enddetected":let I;I=C.textBody.length>0?C.textBody:"{ Offset: 0 }";const T=c.SpeechDetected.fromJSON(I);this.privRequestSession.onServiceRecognized(T.Offset+this.privRequestSession.currentTurnAudioOffset);const w=new s.RecognitionEventArgs(T.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,w);break;case"turn.end":{const E=C.requestId.toUpperCase();if(E!==this.privRequestSession.requestId.toUpperCase())this.privTurnStateManager.CompleteTurn(E);else{const A=new s.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(!1),this.privRecognizerConfig.isContinuousRecognition&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing||this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,A),this.privSuccessCallback&&this.privLastResult){try{this.privSuccessCallback(this.privLastResult),this.privLastResult=null}catch(D){this.privErrorCallback&&this.privErrorCallback(D)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}}break;default:try{await this.processTypeSpecificMessages(C)||this.serviceEvents&&this.serviceEvents.onEvent(new i.ServiceEvent(C.path.toLowerCase(),C.textBody))}catch{}}return l()}catch{this.terminateMessageLoop=!0,v.resolve()}};return l().catch(g=>{i.Events.instance.onEvent(new i.BackgroundEvent(g))}),v.promise}async startMessageLoop(){this.terminateMessageLoop=!1;try{await this.receiveDialogMessageOverride()}catch(v){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,s.CancellationReason.Error,s.CancellationErrorCode.RuntimeError,v)}return Promise.resolve()}async configConnection(v){return this.terminateMessageLoop?(this.terminateMessageLoop=!1,Promise.reject("Connection to service terminated.")):(await this.sendSpeechServiceConfig(v,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendAgentConfig(v),v)}async sendPreAudioMessages(){const v=await this.fetchConnection();this.addKeywordContextData(),await this.sendSpeechContext(v,!0),await this.sendAgentContext(v),await this.sendWaveHeader(v)}sendAgentConfig(v){if(this.agentConfig&&!this.agentConfigSent){if(this.privRecognizerConfig.parameters.getProperty(s.PropertyId.Conversation_DialogType)===s.DialogServiceConfig.DialogTypes.CustomCommands){const g=this.agentConfig.get();g.botInfo.commandsCulture=this.privRecognizerConfig.parameters.getProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage,"en-us"),this.agentConfig.set(g)}this.onEvent(new n.SendingAgentContextMessageEvent(this.agentConfig));const l=this.agentConfig.toJsonString();return this.agentConfigSent=!0,v.send(new o.SpeechConnectionMessage(i.MessageType.Text,"agent.config",this.privRequestSession.requestId,"application/json",l))}}sendAgentContext(v){const l=i.createGuid(),g=this.privDialogServiceConnector.properties.getProperty(s.PropertyId.Conversation_Speech_Activity_Template),m={channelData:"",context:{interactionId:l},messagePayload:typeof g===void 0?void 0:g,version:.5},S=JSON.stringify(m);return v.send(new o.SpeechConnectionMessage(i.MessageType.Text,"speech.agent.context",this.privRequestSession.requestId,"application/json",S))}fireEventForResult(v,l){const g=c.EnumTranslation.implTranslateRecognitionResult(v.RecognitionStatus),m=v.Offset+this.privRequestSession.currentTurnAudioOffset,S=new s.SpeechRecognitionResult(this.privRequestSession.requestId,g,v.DisplayText,v.Duration,m,v.Language,v.LanguageDetectionConfidence,void 0,void 0,JSON.stringify(v),l);return new s.SpeechRecognitionEventArgs(S,m,this.privRequestSession.sessionId)}handleResponseMessage(v){const l=JSON.parse(v.textBody);switch(l.messageType.toLowerCase()){case"message":const g=v.requestId.toUpperCase(),m=r.ActivityPayloadResponse.fromJSON(v.textBody),S=this.privTurnStateManager.GetTurn(g);if(m.conversationId){const P=this.agentConfig.get();P.botInfo.conversationId=m.conversationId,this.agentConfig.set(P)}const y=S.processActivityPayload(m,a.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormatString(this.privDialogServiceConnector.properties.getProperty(s.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0))),C=new s.ActivityReceivedEventArgs(m.messagePayload,y);if(this.privDialogServiceConnector.activityReceived)try{this.privDialogServiceConnector.activityReceived(this.privDialogServiceConnector,C)}catch{}break;case"messagestatus":if(this.privDialogServiceConnector.turnStatusReceived)try{this.privDialogServiceConnector.turnStatusReceived(this.privDialogServiceConnector,new s.TurnStatusReceivedEventArgs(v.textBody))}catch{}break;default:i.Events.instance.onEvent(new i.BackgroundEvent(`Unexpected response of type ${l.messageType}. Ignoring.`))}}onEvent(v){this.privEvents.onEvent(v),i.Events.instance.onEvent(v)}addKeywordContextData(){const v=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect");if(v===void 0)return;const l=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Offsets"),g=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Durations"),m=v.split(";"),S=l===void 0?[]:l.split(";"),y=g===void 0?[]:g.split(";"),C=[];for(let P=0;P<m.length;P++){const R={};R.text=m[P],P<S.length&&(R.offset=Number(S[P])),P<y.length&&(R.duration=Number(y[P])),C.push(R)}this.speechContext.setSection("invocationSource","VoiceActivationWithKeyword"),this.speechContext.setSection("keywordDetection",[{clientDetectedKeywords:C,onReject:{action:"EndOfTurn"},type:"startTrigger"}])}}e.DialogServiceAdapter=d},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DialogServiceTurnStateManager=void 0;const p=t(26),n=t(240);e.DialogServiceTurnStateManager=class{constructor(){this.privTurnMap=new Map}StartTurn(i){if(this.privTurnMap.has(i))throw new p.InvalidOperationError("Service error: There is already a turn with id:"+i);const a=new n.DialogServiceTurnState(this,i);return this.privTurnMap.set(i,a),this.privTurnMap.get(i)}GetTurn(i){return this.privTurnMap.get(i)}CompleteTurn(i){if(!this.privTurnMap.has(i))throw new p.InvalidOperationError("Service error: Received turn end for an unknown turn id:"+i);const a=this.privTurnMap.get(i);return a.complete(),this.privTurnMap.delete(i),a}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DialogServiceTurnState=void 0;const p=t(85),n=t(84),i=t(241);e.DialogServiceTurnState=class{constructor(a,s){this.privRequestId=s,this.privIsCompleted=!1,this.privAudioStream=null,this.privTurnManager=a,this.resetTurnEndTimeout()}get audioStream(){return this.resetTurnEndTimeout(),this.privAudioStream}processActivityPayload(a,s){return a.messageDataStreamType===i.MessageDataStreamType.TextToSpeechAudio&&(this.privAudioStream=n.AudioOutputStream.createPullStream(),this.privAudioStream.format=s!==void 0?s:p.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privAudioStream}endAudioStream(){this.privAudioStream===null||this.privAudioStream.isClosed||this.privAudioStream.close()}complete(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.endAudioStream()}resetTurnEndTimeout(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.privTimeoutToken=setTimeout(()=>{this.privTurnManager.CompleteTurn(this.privRequestId)},2e3)}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MessageDataStreamType=e.ActivityPayloadResponse=void 0;class t{constructor(n){this.privActivityResponse=JSON.parse(n)}static fromJSON(n){return new t(n)}get conversationId(){return this.privActivityResponse.conversationId}get messageDataStreamType(){return this.privActivityResponse.messageDataStreamType}get messagePayload(){return this.privActivityResponse.messagePayload}get version(){return this.privActivityResponse.version}}e.ActivityPayloadResponse=t,function(p){p[p.None=0]="None",p[p.TextToSpeechAudio=1]="TextToSpeechAudio"}(e.MessageDataStreamType||(e.MessageDataStreamType={}))},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AgentConfig=void 0,e.AgentConfig=class{toJsonString(){return JSON.stringify(this.iPrivConfig)}get(){return this.iPrivConfig}set(t){this.iPrivConfig=t}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var p=t(244);Object.defineProperty(e,"ConversationManager",{enumerable:!0,get:function(){return p.ConversationManager}});var n=t(245);Object.defineProperty(e,"ConversationConnectionConfig",{enumerable:!0,get:function(){return n.ConversationConnectionConfig}});var i=t(246);Object.defineProperty(e,"ConversationRecognizerFactory",{enumerable:!0,get:function(){return i.ConversationRecognizerFactory}});var a=t(258);Object.defineProperty(e,"TranscriberRecognizer",{enumerable:!0,get:function(){return a.TranscriberRecognizer}});var s=t(252);Object.defineProperty(e,"ConversationReceivedTranslationEventArgs",{enumerable:!0,get:function(){return s.ConversationReceivedTranslationEventArgs}}),Object.defineProperty(e,"LockRoomEventArgs",{enumerable:!0,get:function(){return s.LockRoomEventArgs}}),Object.defineProperty(e,"MuteAllEventArgs",{enumerable:!0,get:function(){return s.MuteAllEventArgs}}),Object.defineProperty(e,"ParticipantAttributeEventArgs",{enumerable:!0,get:function(){return s.ParticipantAttributeEventArgs}}),Object.defineProperty(e,"ParticipantEventArgs",{enumerable:!0,get:function(){return s.ParticipantEventArgs}}),Object.defineProperty(e,"ParticipantsListEventArgs",{enumerable:!0,get:function(){return s.ParticipantsListEventArgs}});var h=t(253);Object.defineProperty(e,"ConversationTranslatorCommandTypes",{enumerable:!0,get:function(){return h.ConversationTranslatorCommandTypes}}),Object.defineProperty(e,"ConversationTranslatorMessageTypes",{enumerable:!0,get:function(){return h.ConversationTranslatorMessageTypes}}),Object.defineProperty(e,"InternalParticipants",{enumerable:!0,get:function(){return h.InternalParticipants}})},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationManager=void 0;const p=t(60),n=t(64),i=t(79),a=t(245);e.ConversationManager=class{constructor(){this.privRequestParams=a.ConversationConnectionConfig.configParams,this.privErrors=a.ConversationConnectionConfig.restErrors,this.privHost=a.ConversationConnectionConfig.host,this.privApiVersion=a.ConversationConnectionConfig.apiVersion,this.privRestPath=a.ConversationConnectionConfig.restPath,this.privRestAdapter=new p.RestMessageAdapter({})}createOrJoin(s,h,c,r){try{n.Contracts.throwIfNullOrUndefined(s,"args");const o=s.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage,a.ConversationConnectionConfig.defaultLanguageCode),d=s.getProperty(i.PropertyId.ConversationTranslator_Name,"conversation_host"),u=s.getProperty(i.PropertyId.ConversationTranslator_Host,this.privHost),v=s.getProperty(i.PropertyId.ConversationTranslator_CorrelationId),l=s.getProperty(i.PropertyId.SpeechServiceConnection_Key),g=s.getProperty(i.PropertyId.SpeechServiceConnection_Region),m=s.getProperty(i.PropertyId.SpeechServiceAuthorization_Token);n.Contracts.throwIfNullOrWhitespace(o,"languageCode"),n.Contracts.throwIfNullOrWhitespace(d,"nickname"),n.Contracts.throwIfNullOrWhitespace(u,"endpointHost");const S={};S[this.privRequestParams.apiVersion]=this.privApiVersion,S[this.privRequestParams.languageCode]=o,S[this.privRequestParams.nickname]=d;const y={};v&&(y[this.privRequestParams.correlationId]=v),y[this.privRequestParams.clientAppId]=a.ConversationConnectionConfig.clientAppId,h!==void 0?S[this.privRequestParams.roomId]=h:(n.Contracts.throwIfNullOrUndefined(g,this.privErrors.authInvalidSubscriptionRegion),y[this.privRequestParams.subscriptionRegion]=g,l?y[this.privRequestParams.subscriptionKey]=l:m?y[this.privRequestParams.authorization]=`Bearer ${m}`:n.Contracts.throwIfNullOrUndefined(l,this.privErrors.authInvalidSubscriptionKey));const C={};C.headers=y,this.privRestAdapter.options=C;const P=`https://${u}${this.privRestPath}`;this.privRestAdapter.request(p.RestRequestType.Post,P,S,null).then(R=>{const I=p.RestMessageAdapter.extractHeaderValue(this.privRequestParams.requestId,R.headers);if(!R.ok){if(r){let w,E=this.privErrors.invalidCreateJoinConversationResponse.replace("{status}",R.status.toString());try{w=JSON.parse(R.data),E+=` [${w.error.code}: ${w.error.message}]`}catch{E+=` [${R.data}]`}I&&(E+=` ${I}`),r(E)}return}const T=JSON.parse(R.data);if(T&&(T.requestId=I),c){try{c(T)}catch(w){r&&r(w)}c=void 0}}).catch(()=>{})}catch(o){if(r)if(o instanceof Error){const d=o;r(d.name+": "+d.message)}else r(o)}}leave(s,h){return new Promise((c,r)=>{try{n.Contracts.throwIfNullOrUndefined(s,this.privErrors.invalidArgs.replace("{arg}","config")),n.Contracts.throwIfNullOrWhitespace(h,this.privErrors.invalidArgs.replace("{arg}","token"));const o=s.getProperty(i.PropertyId.ConversationTranslator_Host,this.privHost),d=s.getProperty(i.PropertyId.ConversationTranslator_CorrelationId),u={};u[this.privRequestParams.apiVersion]=this.privApiVersion,u[this.privRequestParams.sessionToken]=h;const v={};d&&(v[this.privRequestParams.correlationId]=d);const l={};l.headers=v,this.privRestAdapter.options=l;const g=`https://${o}${this.privRestPath}`;this.privRestAdapter.request(p.RestRequestType.Delete,g,u,null).then(m=>{m.ok,c()}).catch(()=>{})}catch(o){if(o instanceof Error){const d=o;r(d.name+": "+d.message)}else r(o)}})}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationConnectionConfig=void 0;const p=t(202);class n extends p.RestConfigBase{static get host(){return n.privHost}static get apiVersion(){return n.privApiVersion}static get clientAppId(){return n.privClientAppId}static get defaultLanguageCode(){return n.privDefaultLanguageCode}static get restPath(){return n.privRestPath}static get webSocketPath(){return n.privWebSocketPath}static get transcriptionEventKeys(){return n.privTranscriptionEventKeys}}e.ConversationConnectionConfig=n,n.privHost="dev.microsofttranslator.com",n.privRestPath="/capito/room",n.privApiVersion="2.0",n.privDefaultLanguageCode="en-US",n.privClientAppId="FC539C22-1767-4F1F-84BC-B4D811114F15",n.privWebSocketPath="/capito/translate",n.privTranscriptionEventKeys=["iCalUid","callId","organizer","FLAC","MTUri","DifferentiateGuestSpeakers","audiorecording","Threadid","OrganizerMri","OrganizerTenantId","UserToken"]},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationTranslatorRecognizer=e.ConversationRecognizerFactory=void 0;const p=t(2),n=t(4),i=t(64),a=t(79),s=t(247),h=t(250);e.ConversationRecognizerFactory=class{static fromConfig(r,o,d){return new c(r,o,d)}};class c extends a.Recognizer{constructor(o,d,u){const v=d;i.Contracts.throwIfNull(v,"speechConfig");const l=o;i.Contracts.throwIfNull(l,"conversationImpl"),super(u,v.properties,new s.ConversationConnectionFactory),this.privConversation=l,this.privIsDisposed=!1,this.privProperties=v.properties.clone(),this.privConnection=a.Connection.fromRecognizer(this),this.privProperties.getProperty(a.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?(this.privSetTimeout=n.Timeout.setTimeout,this.privClearTimeout=n.Timeout.clearTimeout):typeof window<"u"?(this.privSetTimeout=window.setTimeout.bind(window),this.privClearTimeout=window.clearTimeout.bind(window)):(this.privSetTimeout=setTimeout,this.privClearTimeout=clearTimeout)}set connected(o){this.privConnection.connected=o}set disconnected(o){this.privConnection.disconnected=o}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get properties(){return this.privProperties}isDisposed(){return this.privIsDisposed}connect(o,d,u){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfNullOrWhitespace(o,"token"),this.privReco.conversationTranslatorToken=o,this.resetConversationTimeout(),this.privReco.connectAsync(d,u)}catch(v){if(u)if(v instanceof Error){const l=v;u(l.name+": "+l.message)}else u(v)}}disconnect(o,d){try{i.Contracts.throwIfDisposed(this.privIsDisposed),this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privReco.disconnect().then(()=>{o&&o()},u=>{d&&d(u)})}catch(u){if(d)if(u instanceof Error){const v=u;d(v.name+": "+v.message)}else d(u);this.dispose(!0).catch(v=>{n.Events.instance.onEvent(new n.BackgroundEvent(v))})}}sendRequest(o,d,u){try{i.Contracts.throwIfDisposed(this.privIsDisposed),this.sendMessage(o,d,u)}catch(v){if(u)if(v instanceof Error){const l=v;u(l.name+": "+l.message)}else u(v);this.dispose(!0).catch(l=>{n.Events.instance.onEvent(new n.BackgroundEvent(l))})}}onToken(o){this.privConversation.onToken(o)}async close(){this.privIsDisposed||(this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close()),this.privConnection=void 0,await this.dispose(!0))}async dispose(o){this.privIsDisposed||o&&(this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privIsDisposed=!0,this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close(),this.privConnection=void 0),await super.dispose(o))}createRecognizerConfig(o){return new p.RecognizerConfig(o,this.privProperties)}createServiceRecognizer(o,d,u,v){const l=u;return new h.ConversationServiceAdapter(o,d,l,v,this)}sendMessage(o,d,u){((v,l,g)=>{v!==void 0?v.then(()=>{try{l&&l()}catch(m){g&&g(`'Unhandled error on promise callback: ${m}'`)}},m=>{try{g&&g(m)}catch{}}):g&&g("Null promise")})(this.privReco.sendMessageAsync(o),d,u),this.resetConversationTimeout()}resetConversationTimeout(){this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privTimeoutToken=this.privSetTimeout(()=>{this.sendRequest(this.privConversation.getKeepAlive())},6e4)}}e.ConversationTranslatorRecognizer=c},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationConnectionFactory=void 0;const p=t(60),n=t(4),i=t(64),a=t(79),s=t(134),h=t(245),c=t(248);class r extends s.ConnectionFactoryBase{create(d,u,v){const l=d.parameters.getProperty(a.PropertyId.ConversationTranslator_Host,h.ConversationConnectionConfig.host),g=d.parameters.getProperty(a.PropertyId.ConversationTranslator_CorrelationId,n.createGuid()),m=`wss://${l}${h.ConversationConnectionConfig.webSocketPath}`,S=d.parameters.getProperty(a.PropertyId.ConversationTranslator_Token,void 0);i.Contracts.throwIfNullOrUndefined(S,"token");const y={};y[h.ConversationConnectionConfig.configParams.apiVersion]=h.ConversationConnectionConfig.apiVersion,y[h.ConversationConnectionConfig.configParams.token]=S,y[h.ConversationConnectionConfig.configParams.correlationId]=g;const C=d.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new p.WebsocketConnection(m,y,{},new c.ConversationWebsocketMessageFormatter,p.ProxyInfo.fromRecognizerConfig(d),C,v)}}e.ConversationConnectionFactory=r},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationWebsocketMessageFormatter=void 0;const p=t(4),n=t(249);e.ConversationWebsocketMessageFormatter=class{toConnectionMessage(i){const a=new p.Deferred;try{if(i.messageType===p.MessageType.Text){const s=new n.ConversationConnectionMessage(i.messageType,i.textContent,{},i.id);a.resolve(s)}else i.messageType===p.MessageType.Binary&&a.resolve(new n.ConversationConnectionMessage(i.messageType,i.binaryContent,void 0,i.id))}catch(s){a.reject(`Error formatting the message. Error: ${s}`)}return a.promise}fromConnectionMessage(i){const a=new p.Deferred;try{if(i.messageType===p.MessageType.Text){const s=`${i.textBody?i.textBody:""}`;a.resolve(new p.RawWebsocketMessage(p.MessageType.Text,s,i.id))}}catch(s){a.reject(`Error formatting the message. ${s}`)}return a.promise}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationConnectionMessage=void 0;const p=t(4);class n extends p.ConnectionMessage{constructor(a,s,h,c){super(a,s,h,c);const r=JSON.parse(this.textBody);r.type!==void 0&&(this.privConversationMessageType=r.type)}get conversationMessageType(){return this.privConversationMessageType}}e.ConversationConnectionMessage=n},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationServiceAdapter=void 0;const p=t(4),n=t(79),i=t(2),a=t(249),s=t(251),h=t(252),c=t(253),r=t(254);class o extends i.ServiceRecognizerBase{constructor(u,v,l,g,m){super(u,v,l,g,m),this.privConnectionConfigPromise=void 0,this.privLastPartialUtteranceId="",this.privConversationServiceConnector=m,this.privConversationAuthentication=u,this.receiveMessageOverride=()=>this.receiveConversationMessageOverride(),this.recognizeOverride=()=>this.noOp(),this.postConnectImplOverride=S=>this.conversationConnectImpl(S),this.configConnectionOverride=()=>this.configConnection(),this.disconnectOverride=()=>this.privDisconnect(),this.privConversationRequestSession=new s.ConversationRequestSession(p.createNoDashGuid()),this.privConversationConnectionFactory=v,this.privConversationIsDisposed=!1}isDisposed(){return super.isDisposed()||this.privConversationIsDisposed}async dispose(u){this.privConversationIsDisposed=!0,this.privConnectionConfigPromise!==void 0&&await(await this.privConnectionConfigPromise).dispose(u),await super.dispose(u)}async sendMessage(u){return(await this.fetchConnection()).send(new a.ConversationConnectionMessage(p.MessageType.Text,u))}async sendMessageAsync(u){await(await this.fetchConnection()).send(new a.ConversationConnectionMessage(p.MessageType.Text,u))}privDisconnect(){if(!this.terminateMessageLoop)return this.cancelRecognition(this.privConversationRequestSession.sessionId,this.privConversationRequestSession.requestId,n.CancellationReason.Error,n.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,Promise.resolve()}async processTypeSpecificMessages(){return!0}cancelRecognition(u,v,l,g,m){this.terminateMessageLoop=!0;const S=new n.ConversationTranslationCanceledEventArgs(l,m,g,void 0,u);try{this.privConversationServiceConnector.canceled&&this.privConversationServiceConnector.canceled(this.privConversationServiceConnector,S)}catch{}}async conversationConnectImpl(u){return this.privConnectionLoop=this.startMessageLoop(),u}async receiveConversationMessageOverride(){if(this.isDisposed()||this.terminateMessageLoop)return Promise.resolve();const u=new p.Deferred;try{const v=await this.fetchConnection(),l=await v.read();if(this.isDisposed()||this.terminateMessageLoop)return u.resolve(),Promise.resolve();if(!l)return this.receiveConversationMessageOverride();const g=this.privConversationRequestSession.sessionId,m=l.conversationMessageType.toLowerCase();let S=!1;try{switch(m){case"info":case"participant_command":case"command":const y=r.CommandResponsePayload.fromJSON(l.textBody);switch(y.command.toLowerCase()){case"participantlist":const w=r.ParticipantsListPayloadResponse.fromJSON(l.textBody),E=w.participants.map(O=>({avatar:O.avatar,displayName:O.nickname,id:O.participantId,isHost:O.ishost,isMuted:O.ismuted,isUsingTts:O.usetts,preferredLanguage:O.locale}));this.privConversationServiceConnector.participantsListReceived&&this.privConversationServiceConnector.participantsListReceived(this.privConversationServiceConnector,new h.ParticipantsListEventArgs(w.roomid,w.token,w.translateTo,w.profanityFilter,w.roomProfanityFilter,w.roomLocked,w.muteAll,E,g));break;case"settranslatetolanguages":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new h.ParticipantAttributeEventArgs(y.participantId,c.ConversationTranslatorCommandTypes.setTranslateToLanguages,y.value,g));break;case"setprofanityfiltering":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new h.ParticipantAttributeEventArgs(y.participantId,c.ConversationTranslatorCommandTypes.setProfanityFiltering,y.value,g));break;case"setmute":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new h.ParticipantAttributeEventArgs(y.participantId,c.ConversationTranslatorCommandTypes.setMute,y.value,g));break;case"setmuteall":this.privConversationServiceConnector.muteAllCommandReceived&&this.privConversationServiceConnector.muteAllCommandReceived(this.privConversationServiceConnector,new h.MuteAllEventArgs(y.value,g));break;case"roomexpirationwarning":this.privConversationServiceConnector.conversationExpiration&&this.privConversationServiceConnector.conversationExpiration(this.privConversationServiceConnector,new n.ConversationExpirationEventArgs(y.value,this.privConversationRequestSession.sessionId));break;case"setusetts":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new h.ParticipantAttributeEventArgs(y.participantId,c.ConversationTranslatorCommandTypes.setUseTTS,y.value,g));break;case"setlockstate":this.privConversationServiceConnector.lockRoomCommandReceived&&this.privConversationServiceConnector.lockRoomCommandReceived(this.privConversationServiceConnector,new h.LockRoomEventArgs(y.value,g));break;case"changenickname":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new h.ParticipantAttributeEventArgs(y.participantId,c.ConversationTranslatorCommandTypes.changeNickname,y.value,g));break;case"joinsession":const A=r.ParticipantPayloadResponse.fromJSON(l.textBody),D={avatar:A.avatar,displayName:A.nickname,id:A.participantId,isHost:A.ishost,isMuted:A.ismuted,isUsingTts:A.usetts,preferredLanguage:A.locale};this.privConversationServiceConnector.participantJoinCommandReceived&&this.privConversationServiceConnector.participantJoinCommandReceived(this.privConversationServiceConnector,new h.ParticipantEventArgs(D,g));break;case"leavesession":const N={id:y.participantId};this.privConversationServiceConnector.participantLeaveCommandReceived&&this.privConversationServiceConnector.participantLeaveCommandReceived(this.privConversationServiceConnector,new h.ParticipantEventArgs(N,g));break;case"disconnectsession":y.participantId;break;case"token":const k=new i.CognitiveTokenAuthentication(()=>{const O=y.token;return Promise.resolve(O)},()=>{const O=y.token;return Promise.resolve(O)});this.authentication=k,this.privConversationServiceConnector.onToken(k)}break;case"partial":case"final":const C=r.SpeechResponsePayload.fromJSON(l.textBody),P=m==="final"?n.ResultReason.TranslatedParticipantSpeech:n.ResultReason.TranslatingParticipantSpeech,R=new n.ConversationTranslationResult(C.participantId,this.getTranslations(C.translations),C.language,C.id,P,C.recognition,void 0,void 0,l.textBody,void 0);C.isFinal?((R.text!==void 0&&R.text.length>0||C.id===this.privLastPartialUtteranceId)&&(S=!0),S&&this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new h.ConversationReceivedTranslationEventArgs(c.ConversationTranslatorMessageTypes.final,R,g))):R.text!==void 0&&(this.privLastPartialUtteranceId=C.id,this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new h.ConversationReceivedTranslationEventArgs(c.ConversationTranslatorMessageTypes.partial,R,g)));break;case"translated_message":const I=r.TextResponsePayload.fromJSON(l.textBody),T=new n.ConversationTranslationResult(I.participantId,this.getTranslations(I.translations),I.language,void 0,void 0,I.originalText,void 0,void 0,void 0,l.textBody,void 0);this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new h.ConversationReceivedTranslationEventArgs(c.ConversationTranslatorMessageTypes.instantMessage,T,g))}}catch{}return this.receiveConversationMessageOverride()}catch{this.terminateMessageLoop=!0}return u.promise}async startMessageLoop(){if(this.isDisposed())return Promise.resolve();this.terminateMessageLoop=!1;const u=this.receiveConversationMessageOverride();try{return await u}catch(v){return this.cancelRecognition(this.privRequestSession?this.privRequestSession.sessionId:"",this.privRequestSession?this.privRequestSession.requestId:"",n.CancellationReason.Error,n.CancellationErrorCode.RuntimeError,v),null}}configConnection(){return this.isDisposed()?Promise.resolve(void 0):this.privConnectionConfigPromise!==void 0?this.privConnectionConfigPromise.then(u=>u.state()===p.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection()):this.privConnectionConfigPromise,()=>(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection())):this.terminateMessageLoop?Promise.resolve(void 0):(this.privConnectionConfigPromise=this.connectImpl().then(u=>u),this.privConnectionConfigPromise)}getTranslations(u){let v;if(u!==void 0){v=new n.Translations;for(const l of u)v.set(l.lang,l.translation)}return v}}e.ConversationServiceAdapter=o},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationRequestSession=void 0;const p=t(4);e.ConversationRequestSession=class{constructor(n){this.privIsDisposed=!1,this.privDetachables=new Array,this.privSessionId=n,this.privRequestId=p.createNoDashGuid(),this.privRequestCompletionDeferral=new p.Deferred}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get completionPromise(){return this.privRequestCompletionDeferral.promise}onPreConnectionStart(n,i){this.privSessionId=i}onAuthCompleted(n){n&&this.onComplete()}onConnectionEstablishCompleted(n){n!==200&&n===403&&this.onComplete()}onServiceTurnEndResponse(n){n?this.privRequestId=p.createNoDashGuid():this.onComplete()}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const n of this.privDetachables)await n.detach()}}onComplete(){}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationReceivedTranslationEventArgs=e.ParticipantsListEventArgs=e.ParticipantAttributeEventArgs=e.ParticipantEventArgs=e.LockRoomEventArgs=e.MuteAllEventArgs=void 0;const p=t(79);class n extends p.SessionEventArgs{constructor(r,o){super(o),this.privIsMuted=r}get isMuted(){return this.privIsMuted}}e.MuteAllEventArgs=n;class i extends p.SessionEventArgs{constructor(r,o){super(o),this.privIsLocked=r}get isMuted(){return this.privIsLocked}}e.LockRoomEventArgs=i;class a extends p.SessionEventArgs{constructor(r,o){super(o),this.privParticipant=r}get participant(){return this.privParticipant}}e.ParticipantEventArgs=a;class s extends p.SessionEventArgs{constructor(r,o,d,u){super(u),this.privKey=o,this.privValue=d,this.privParticipantId=r}get value(){return this.privValue}get key(){return this.privKey}get id(){return this.privParticipantId}}e.ParticipantAttributeEventArgs=s;class h extends p.SessionEventArgs{constructor(r,o,d,u,v,l,g,m,S){super(S),this.privRoomId=r,this.privSessionToken=o,this.privTranslateTo=d,this.privProfanityFilter=u,this.privRoomProfanityFilter=v,this.privIsRoomLocked=l,this.privIsRoomLocked=g,this.privParticipants=m}get sessionToken(){return this.privSessionToken}get conversationId(){return this.privRoomId}get translateTo(){return this.privTranslateTo}get profanityFilter(){return this.privProfanityFilter}get roomProfanityFilter(){return this.privRoomProfanityFilter}get isRoomLocked(){return this.privIsRoomLocked}get isMuteAll(){return this.privIsMuteAll}get participants(){return this.privParticipants}}e.ParticipantsListEventArgs=h,e.ConversationReceivedTranslationEventArgs=class{constructor(c,r,o){this.privPayload=r,this.privCommand=c,this.privSessionId=o}get payload(){return this.privPayload}get command(){return this.privCommand}get sessionId(){return this.privSessionId}}},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationTranslatorCommandTypes=e.ConversationTranslatorMessageTypes=e.InternalParticipants=void 0,e.InternalParticipants=class{constructor(t=[],p){this.participants=t,this.meId=p}addOrUpdateParticipant(t){if(t===void 0)return;const p=this.getParticipantIndex(t.id);return p>-1?this.participants.splice(p,1,t):this.participants.push(t),this.getParticipant(t.id)}getParticipantIndex(t){return this.participants.findIndex(p=>p.id===t)}getParticipant(t){return this.participants.find(p=>p.id===t)}deleteParticipant(t){this.participants=this.participants.filter(p=>p.id!==t)}get host(){return this.participants.find(t=>t.isHost===!0)}get me(){return this.getParticipant(this.meId)}},e.ConversationTranslatorMessageTypes={command:"command",final:"final",info:"info",instantMessage:"instant_message",keepAlive:"keep_alive",partial:"partial",participantCommand:"participant_command",translatedMessage:"translated_message"},e.ConversationTranslatorCommandTypes={changeNickname:"ChangeNickname",disconnectSession:"DisconnectSession",ejectParticipant:"EjectParticipant",instant_message:"instant_message",joinSession:"JoinSession",leaveSession:"LeaveSession",participantList:"ParticipantList",roomExpirationWarning:"RoomExpirationWarning",setLockState:"SetLockState",setMute:"SetMute",setMuteAll:"SetMuteAll",setProfanityFiltering:"SetProfanityFiltering",setTranslateToLanguages:"SetTranslateToLanguages",setUseTTS:"SetUseTTS"}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var p=t(255);Object.defineProperty(e,"CommandResponsePayload",{enumerable:!0,get:function(){return p.CommandResponsePayload}});var n=t(256);Object.defineProperty(e,"ParticipantsListPayloadResponse",{enumerable:!0,get:function(){return n.ParticipantsListPayloadResponse}}),Object.defineProperty(e,"ParticipantPayloadResponse",{enumerable:!0,get:function(){return n.ParticipantPayloadResponse}});var i=t(257);Object.defineProperty(e,"SpeechResponsePayload",{enumerable:!0,get:function(){return i.SpeechResponsePayload}}),Object.defineProperty(e,"TextResponsePayload",{enumerable:!0,get:function(){return i.TextResponsePayload}})},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CommandResponsePayload=void 0;class t{constructor(n){this.privCommandResponse=(i=>JSON.parse(i))(n)}get type(){return this.privCommandResponse.type}get command(){return this.privCommandResponse.command}get id(){return this.privCommandResponse.id}get nickname(){return this.privCommandResponse.nickname}get participantId(){return this.privCommandResponse.participantId}get roomid(){return this.privCommandResponse.roomid}get value(){return this.privCommandResponse.value}get token(){return this.privCommandResponse.token}static fromJSON(n){return new t(n)}}e.CommandResponsePayload=t},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ParticipantPayloadResponse=e.ParticipantsListPayloadResponse=void 0;class t{constructor(i){this.privParticipantsPayloadResponse=(a=>JSON.parse(a))(i)}get roomid(){return this.privParticipantsPayloadResponse.roomid}get id(){return this.privParticipantsPayloadResponse.id}get command(){return this.privParticipantsPayloadResponse.command}get participants(){return this.privParticipantsPayloadResponse.participants}get token(){return this.privParticipantsPayloadResponse.token}get translateTo(){return this.privParticipantsPayloadResponse.translateTo}get profanityFilter(){return this.privParticipantsPayloadResponse.profanityFilter}get roomProfanityFilter(){return this.privParticipantsPayloadResponse.roomProfanityFilter}get roomLocked(){return this.privParticipantsPayloadResponse.roomLocked}get muteAll(){return this.privParticipantsPayloadResponse.muteAll}get type(){return this.privParticipantsPayloadResponse.type}static fromJSON(i){return new t(i)}}e.ParticipantsListPayloadResponse=t;class p{constructor(i){this.privParticipantPayloadResponse=(a=>JSON.parse(a))(i)}get nickname(){return this.privParticipantPayloadResponse.nickname}get locale(){return this.privParticipantPayloadResponse.locale}get usetts(){return this.privParticipantPayloadResponse.usetts}get ismuted(){return this.privParticipantPayloadResponse.ismuted}get ishost(){return this.privParticipantPayloadResponse.ishost}get participantId(){return this.privParticipantPayloadResponse.participantId}get avatar(){return this.privParticipantPayloadResponse.avatar}static fromJSON(i){return new p(i)}}e.ParticipantPayloadResponse=p},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextResponsePayload=e.SpeechResponsePayload=void 0;class t{constructor(i){this.privSpeechResponse=(a=>JSON.parse(a))(i)}get recognition(){return this.privSpeechResponse.recognition}get translations(){return this.privSpeechResponse.translations}get id(){return this.privSpeechResponse.id}get language(){return this.privSpeechResponse.language}get nickname(){return this.privSpeechResponse.nickname}get participantId(){return this.privSpeechResponse.participantId}get roomid(){return this.privSpeechResponse.roomid}get timestamp(){return this.privSpeechResponse.timestamp}get type(){return this.privSpeechResponse.type}get isFinal(){return this.privSpeechResponse.type==="final"}static fromJSON(i){return new t(i)}}e.SpeechResponsePayload=t;class p{constructor(i){this.privTextResponse=(a=>JSON.parse(a))(i)}get originalText(){return this.privTextResponse.originalText}get translations(){return this.privTextResponse.translations}get id(){return this.privTextResponse.id}get language(){return this.privTextResponse.language}get nickname(){return this.privTextResponse.nickname}get participantId(){return this.privTextResponse.participantId}get roomid(){return this.privTextResponse.roomid}get timestamp(){return this.privTextResponse.timestamp}get type(){return this.privTextResponse.type}static fromJSON(i){return new p(i)}}e.TextResponsePayload=p},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TranscriberRecognizer=void 0;const p=t(4),n=t(64),i=t(79),a=t(2);class s extends i.Recognizer{constructor(c,r){const o=c;n.Contracts.throwIfNull(o,"speechTranslationConfig");const d=r;n.Contracts.throwIfNull(d,"audioConfigImpl"),n.Contracts.throwIfNullOrWhitespace(o.speechRecognitionLanguage,i.PropertyId[i.PropertyId.SpeechServiceConnection_RecoLanguage]),super(r,o.properties,new a.TranscriberConnectionFactory),this.privDisposedRecognizer=!1,this.isMeetingRecognizer=!1}get speechRecognitionLanguage(){return n.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(i.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(c){n.Contracts.throwIfNullOrWhitespace(c,"token"),this.properties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,c)}set conversation(c){n.Contracts.throwIfNullOrUndefined(c,"Conversation"),this.isMeetingRecognizer=!1,this.privConversation=c}getConversationInfo(){return n.Contracts.throwIfNullOrUndefined(this.privConversation,"Conversation"),this.privConversation.conversationInfo}set meeting(c){n.Contracts.throwIfNullOrUndefined(c,"Meeting"),this.isMeetingRecognizer=!0,this.privMeeting=c}getMeetingInfo(){return n.Contracts.throwIfNullOrUndefined(this.privMeeting,"Meeting"),this.privMeeting.meetingInfo}IsMeetingRecognizer(){return this.isMeetingRecognizer}startContinuousRecognitionAsync(c,r){p.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(a.RecognitionMode.Conversation),c,r)}stopContinuousRecognitionAsync(c,r){p.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),c,r)}async close(){this.privDisposedRecognizer||await this.dispose(!0)}async pushConversationEvent(c,r){const o=this.privReco;n.Contracts.throwIfNullOrUndefined(o,"serviceRecognizer"),await o.sendSpeechEventAsync(c,r)}async pushMeetingEvent(c,r){const o=this.privReco;n.Contracts.throwIfNullOrUndefined(o,"serviceRecognizer"),await o.sendMeetingSpeechEventAsync(c,r)}async enforceAudioGating(){const c=this.audioConfig,r=(await c.format).channels;if(r===1){if(this.properties.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()!=="true")throw new Error("Single channel audio configuration for MeetingTranscriber is currently under private preview, please contact diarizationrequest@microsoft.com for more details")}else if(r!==8)throw new Error(`Unsupported audio configuration: Detected ${r}-channel audio`)}connectMeetingCallbacks(c){this.isMeetingRecognizer=!0,this.canceled=(r,o)=>{c.canceled&&c.canceled(c,o)},this.recognizing=(r,o)=>{c.transcribing&&c.transcribing(c,o)},this.recognized=(r,o)=>{c.transcribed&&c.transcribed(c,o)},this.sessionStarted=(r,o)=>{c.sessionStarted&&c.sessionStarted(c,o)},this.sessionStopped=(r,o)=>{c.sessionStopped&&c.sessionStopped(c,o)}}disconnectCallbacks(){this.canceled=void 0,this.recognizing=void 0,this.recognized=void 0,this.sessionStarted=void 0,this.sessionStopped=void 0}async dispose(c){this.privDisposedRecognizer||(c&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(c))}createRecognizerConfig(c){return new a.RecognizerConfig(c,this.properties)}createServiceRecognizer(c,r,o,d){const u=o;return new a.TranscriptionServiceRecognizer(c,r,u,d,this)}}e.TranscriberRecognizer=s},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SynthesisAudioMetadata=e.MetadataType=void 0,function(p){p.WordBoundary="WordBoundary",p.Bookmark="Bookmark",p.Viseme="Viseme",p.SentenceBoundary="SentenceBoundary",p.SessionEnd="SessionEnd",p.AvatarSignal="TalkingAvatarSignal"}(e.MetadataType||(e.MetadataType={}));class t{constructor(n){this.privSynthesisAudioMetadata=JSON.parse(n)}static fromJSON(n){return new t(n)}get Metadata(){return this.privSynthesisAudioMetadata.Metadata}}e.SynthesisAudioMetadata=t},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SynthesisTurn=void 0;const p=t(4),n=t(84),i=t(79),a=t(259),s=t(261);class h{constructor(){this.privIsDisposed=!1,this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!1,this.privBytesReceived=0,this.privInTurn=!1,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privRequestId=p.createNoDashGuid(),this.privTurnDeferral=new p.Deferred,this.privTurnDeferral.resolve()}get requestId(){return this.privRequestId}get streamId(){return this.privStreamId}set streamId(r){this.privStreamId=r}get audioOutputFormat(){return this.privAudioOutputFormat}set audioOutputFormat(r){this.privAudioOutputFormat=r}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSynthesisEnded(){return this.privIsSynthesisEnded}get isSynthesizing(){return this.privIsSynthesizing}get currentTextOffset(){return this.privTextOffset}get currentSentenceOffset(){return this.privSentenceOffset}get bytesReceived(){return this.privBytesReceived}get audioDuration(){return this.privAudioDuration}get extraProperties(){if(this.privWebRTCSDP){const r=new i.PropertyCollection;return r.setProperty(i.PropertyId.TalkingAvatarService_WebRTC_SDP,this.privWebRTCSDP),r}}async getAllReceivedAudio(){return this.privReceivedAudio?Promise.resolve(this.privReceivedAudio):this.privIsSynthesisEnded?(await this.readAllAudioFromStream(),Promise.resolve(this.privReceivedAudio)):null}async getAllReceivedAudioWithHeader(){if(this.privReceivedAudioWithHeader)return this.privReceivedAudioWithHeader;if(!this.privIsSynthesisEnded)return null;if(this.audioOutputFormat.hasHeader){const r=await this.getAllReceivedAudio();return this.privReceivedAudioWithHeader=this.audioOutputFormat.addHeader(r),this.privReceivedAudioWithHeader}return this.getAllReceivedAudio()}startNewSynthesis(r,o,d,u){this.privIsSynthesisEnded=!1,this.privIsSynthesizing=!0,this.privRequestId=r,this.privRawText=o,this.privIsSSML=d,this.privAudioOutputStream=new n.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privAudioOutputFormat,this.privReceivedAudio=null,this.privReceivedAudioWithHeader=null,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privPartialVisemeAnimation="",this.privWebRTCSDP="",u!==void 0&&(this.privTurnAudioDestination=u,this.privTurnAudioDestination.format=this.privAudioOutputFormat),this.onEvent(new s.SynthesisTriggeredEvent(this.requestId,void 0,u===void 0?void 0:u.id()))}onPreConnectionStart(r){this.privAuthFetchEventId=r,this.onEvent(new s.ConnectingToSynthesisServiceEvent(this.privRequestId,this.privAuthFetchEventId))}onAuthCompleted(r){r&&this.onComplete()}onConnectionEstablishCompleted(r){if(r===200)return this.onEvent(new s.SynthesisStartedEvent(this.requestId,this.privAuthFetchEventId)),void(this.privBytesReceived=0);r===403&&this.onComplete()}onServiceResponseMessage(r){const o=JSON.parse(r);this.streamId=o.audio.streamId}onServiceTurnEndResponse(){this.privInTurn=!1,this.privTurnDeferral.resolve(),this.onComplete()}onServiceTurnStartResponse(r){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new p.Deferred;const o=JSON.parse(r);o.webrtc&&(this.privWebRTCSDP=o.webrtc.connectionString)}onAudioChunkReceived(r){this.isSynthesizing&&(this.privAudioOutputStream.write(r),this.privBytesReceived+=r.byteLength,this.privTurnAudioDestination!==void 0&&this.privTurnAudioDestination.write(r))}onTextBoundaryEvent(r){this.updateTextOffset(r.Data.text.Text,r.Type)}onVisemeMetadataReceived(r){r.Data.AnimationChunk!==void 0&&(this.privPartialVisemeAnimation+=r.Data.AnimationChunk)}onSessionEnd(r){this.privAudioDuration=r.Data.Offset}async constructSynthesisResult(){const r=await this.getAllReceivedAudioWithHeader();return new i.SpeechSynthesisResult(this.requestId,i.ResultReason.SynthesizingAudioCompleted,r,void 0,this.extraProperties,this.audioDuration)}dispose(){this.privIsDisposed||(this.privIsDisposed=!0)}onStopSynthesizing(){this.onComplete()}getAndClearVisemeAnimation(){const r=this.privPartialVisemeAnimation;return this.privPartialVisemeAnimation="",r}onEvent(r){p.Events.instance.onEvent(r)}static isXmlTag(r){return r.length>=2&&r[0]==="<"&&r[r.length-1]===">"}updateTextOffset(r,o){o===a.MetadataType.WordBoundary?(this.privTextOffset=this.privRawText.indexOf(r,this.privNextSearchTextIndex),this.privTextOffset>=0&&(this.privNextSearchTextIndex=this.privTextOffset+r.length,this.privIsSSML&&this.withinXmlTag(this.privTextOffset)&&!h.isXmlTag(r)&&this.updateTextOffset(r,o))):(this.privSentenceOffset=this.privRawText.indexOf(r,this.privNextSearchSentenceIndex),this.privSentenceOffset>=0&&(this.privNextSearchSentenceIndex=this.privSentenceOffset+r.length,this.privIsSSML&&this.withinXmlTag(this.privSentenceOffset)&&!h.isXmlTag(r)&&this.updateTextOffset(r,o)))}onComplete(){this.privIsSynthesizing&&(this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!0,this.privAudioOutputStream.close(),this.privInTurn=!1,this.privTurnAudioDestination!==void 0&&(this.privTurnAudioDestination.close(),this.privTurnAudioDestination=void 0))}async readAllAudioFromStream(){if(this.privIsSynthesisEnded){this.privReceivedAudio=new ArrayBuffer(this.bytesReceived);try{await this.privAudioOutputStream.read(this.privReceivedAudio)}catch{this.privReceivedAudio=new ArrayBuffer(0)}}}withinXmlTag(r){return this.privRawText.indexOf("<",r+1)>this.privRawText.indexOf(">",r+1)}}e.SynthesisTurn=h},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SynthesisStartedEvent=e.ConnectingToSynthesisServiceEvent=e.SynthesisTriggeredEvent=e.SpeechSynthesisEvent=void 0;const p=t(4);class n extends p.PlatformEvent{constructor(a,s,h=p.EventType.Info){super(a,h),this.privRequestId=s}get requestId(){return this.privRequestId}}e.SpeechSynthesisEvent=n,e.SynthesisTriggeredEvent=class extends n{constructor(i,a,s){super("SynthesisTriggeredEvent",i),this.privSessionAudioDestinationId=a,this.privTurnAudioDestinationId=s}get audioSessionDestinationId(){return this.privSessionAudioDestinationId}get audioTurnDestinationId(){return this.privTurnAudioDestinationId}},e.ConnectingToSynthesisServiceEvent=class extends n{constructor(i,a){super("ConnectingToSynthesisServiceEvent",i),this.privAuthFetchEventId=a}get authFetchEventId(){return this.privAuthFetchEventId}},e.SynthesisStartedEvent=class extends n{constructor(i,a){super("SynthesisStartedEvent",i),this.privAuthFetchEventId=a}get authFetchEventId(){return this.privAuthFetchEventId}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SynthesisAdapterBase=void 0;const p=t(4),n=t(79),i=t(2),a=t(206);class s{constructor(c,r,o,d){if(this.speakOverride=void 0,this.receiveMessageOverride=void 0,this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.privConnectionConfigurationPromise=void 0,!c)throw new p.ArgumentNullError("authentication");if(!r)throw new p.ArgumentNullError("connectionFactory");if(!o)throw new p.ArgumentNullError("synthesizerConfig");this.privAuthentication=c,this.privConnectionFactory=r,this.privSynthesizerConfig=o,this.privIsDisposed=!1,this.privSessionAudioDestination=d,this.privSynthesisTurn=new i.SynthesisTurn,this.privConnectionEvents=new p.EventSource,this.privServiceEvents=new p.EventSource,this.privSynthesisContext=new i.SynthesisContext,this.privAgentConfig=new i.AgentConfig,this.connectionEvents.attach(u=>{if(u.name==="ConnectionClosedEvent"){const v=u;v.statusCode!==1e3&&this.cancelSynthesisLocal(n.CancellationReason.Error,v.statusCode===1007?n.CancellationErrorCode.BadRequestParameters:n.CancellationErrorCode.ConnectionFailure,`${v.reason} websocket error code: ${v.statusCode}`)}})}get synthesisContext(){return this.privSynthesisContext}get agentConfig(){return this.privAgentConfig}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}set activityTemplate(c){this.privActivityTemplate=c}get activityTemplate(){return this.privActivityTemplate}set audioOutputFormat(c){this.privAudioOutputFormat=c,this.privSynthesisTurn.audioOutputFormat=c,this.privSessionAudioDestination!==void 0&&(this.privSessionAudioDestination.format=c),this.synthesisContext!==void 0&&(this.synthesisContext.audioOutputFormat=c)}isDisposed(){return this.privIsDisposed}async dispose(c){this.privIsDisposed=!0,this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.close(),this.privConnectionConfigurationPromise!==void 0&&await(await this.privConnectionConfigurationPromise).dispose(c)}async connect(){await this.connectImpl()}async sendNetworkMessage(c,r){const o=typeof r=="string"?p.MessageType.Text:p.MessageType.Binary,d=typeof r=="string"?"application/json":"";return(await this.fetchConnection()).send(new a.SpeechConnectionMessage(o,c,this.privSynthesisTurn.requestId,d,r))}async Speak(c,r,o,d,u,v){let l;if(l=r?c:this.privSynthesizer.buildSsml(c),this.speakOverride!==void 0)return this.speakOverride(l,o,d,u);this.privSuccessCallback=d,this.privErrorCallback=u,this.privSynthesisTurn.startNewSynthesis(o,c,r,v);try{await this.connectImpl();const g=await this.fetchConnection();await this.sendSynthesisContext(g),await this.sendSsmlMessage(g,l,o),this.onSynthesisStarted(o),this.receiveMessage()}catch(g){return this.cancelSynthesisLocal(n.CancellationReason.Error,n.CancellationErrorCode.ConnectionFailure,g),Promise.reject(g)}}async stopSpeaking(){return await this.connectImpl(),(await this.fetchConnection()).send(new a.SpeechConnectionMessage(p.MessageType.Text,"synthesis.control",this.privSynthesisTurn.requestId,"application/json",JSON.stringify({action:"stop"})))}cancelSynthesis(c,r,o,d){const u=new n.PropertyCollection;u.setProperty(i.CancellationErrorCodePropertyName,n.CancellationErrorCode[o]);const v=new n.SpeechSynthesisResult(c,n.ResultReason.Canceled,void 0,d,u);if(this.onSynthesisCancelled(v),this.privSuccessCallback)try{this.privSuccessCallback(v)}catch{}}cancelSynthesisLocal(c,r,o){this.privSynthesisTurn.isSynthesizing&&(this.privSynthesisTurn.onStopSynthesizing(),this.cancelSynthesis(this.privSynthesisTurn.requestId,c,r,o))}processTypeSpecificMessages(c){return!0}async receiveMessage(){try{const c=await this.fetchConnection(),r=await c.read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(this.privIsDisposed)return;if(!r)return this.privSynthesisTurn.isSynthesizing?this.receiveMessage():void 0;const o=a.SpeechConnectionMessage.fromConnectionMessage(r);if(o.requestId.toLowerCase()===this.privSynthesisTurn.requestId.toLowerCase())switch(o.path.toLowerCase()){case"turn.start":this.privSynthesisTurn.onServiceTurnStartResponse(o.textBody);break;case"response":this.privSynthesisTurn.onServiceResponseMessage(o.textBody);break;case"audio":this.privSynthesisTurn.streamId.toLowerCase()===o.streamId.toLowerCase()&&o.binaryBody&&(this.privSynthesisTurn.onAudioChunkReceived(o.binaryBody),this.onSynthesizing(o.binaryBody),this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.write(o.binaryBody));break;case"audio.metadata":const d=i.SynthesisAudioMetadata.fromJSON(o.textBody).Metadata;for(const v of d)switch(v.Type){case i.MetadataType.WordBoundary:case i.MetadataType.SentenceBoundary:this.privSynthesisTurn.onTextBoundaryEvent(v);const l=new n.SpeechSynthesisWordBoundaryEventArgs(v.Data.Offset,v.Data.Duration,v.Data.text.Text,v.Data.text.Length,v.Type===i.MetadataType.WordBoundary?this.privSynthesisTurn.currentTextOffset:this.privSynthesisTurn.currentSentenceOffset,v.Data.text.BoundaryType);this.onWordBoundary(l);break;case i.MetadataType.Bookmark:const g=new n.SpeechSynthesisBookmarkEventArgs(v.Data.Offset,v.Data.Bookmark);this.onBookmarkReached(g);break;case i.MetadataType.Viseme:if(this.privSynthesisTurn.onVisemeMetadataReceived(v),v.Data.IsLastAnimation){const m=new n.SpeechSynthesisVisemeEventArgs(v.Data.Offset,v.Data.VisemeId,this.privSynthesisTurn.getAndClearVisemeAnimation());this.onVisemeReceived(m)}break;case i.MetadataType.AvatarSignal:this.onAvatarEvent(v);break;case i.MetadataType.SessionEnd:this.privSynthesisTurn.onSessionEnd(v)}break;case"turn.end":let u;this.privSynthesisTurn.onServiceTurnEndResponse();try{u=await this.privSynthesisTurn.constructSynthesisResult(),this.privSuccessCallback&&this.privSuccessCallback(u)}catch(v){this.privErrorCallback&&this.privErrorCallback(v)}this.onSynthesisCompleted(u);break;default:this.processTypeSpecificMessages(o)||this.privServiceEvents&&this.serviceEvents.onEvent(new p.ServiceEvent(o.path.toLowerCase(),o.textBody))}return this.receiveMessage()}catch{}}sendSynthesisContext(c){this.setSynthesisContextSynthesisSection();const r=this.synthesisContext.toJSON();if(r)return c.send(new a.SpeechConnectionMessage(p.MessageType.Text,"synthesis.context",this.privSynthesisTurn.requestId,"application/json",r))}setSpeechConfigSynthesisSection(){}connectImpl(c=!1){if(this.privConnectionPromise!=null)return this.privConnectionPromise.then(o=>o.state()===p.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()));this.privAuthFetchEventId=p.createNoDashGuid(),this.privConnectionId=p.createNoDashGuid(),this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId);const r=c?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=r.then(async o=>{this.privSynthesisTurn.onAuthCompleted(!1);const d=this.privConnectionFactory.create(this.privSynthesizerConfig,o,this.privConnectionId);d.events.attach(v=>{this.connectionEvents.onEvent(v)});const u=await d.open();return u.statusCode===200?(this.privSynthesisTurn.onConnectionEstablishCompleted(u.statusCode),Promise.resolve(d)):u.statusCode!==403||c?(this.privSynthesisTurn.onConnectionEstablishCompleted(u.statusCode),Promise.reject(`Unable to contact server. StatusCode: ${u.statusCode},
                    ${this.privSynthesizerConfig.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Url)} Reason: ${u.reason}`)):this.connectImpl(!0)},o=>{throw this.privSynthesisTurn.onAuthCompleted(!0),new Error(o)}),this.privConnectionPromise.catch(()=>{}),this.privConnectionPromise}sendSpeechServiceConfig(c,r){if(r)return c.send(new a.SpeechConnectionMessage(p.MessageType.Text,"speech.config",this.privSynthesisTurn.requestId,"application/json",r))}sendSsmlMessage(c,r,o){return c.send(new a.SpeechConnectionMessage(p.MessageType.Text,"ssml",o,"application/ssml+xml",r))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(c=>c.state()===p.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async configureConnection(){const c=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(c):(this.setSpeechConfigSynthesisSection(),await this.sendSpeechServiceConfig(c,this.privSynthesizerConfig.SpeechServiceConfig.serialize()),c)}onAvatarEvent(c){}onSynthesisStarted(c){}onSynthesizing(c){}onSynthesisCancelled(c){}onSynthesisCompleted(c){}onWordBoundary(c){}onVisemeReceived(c){}onBookmarkReached(c){}}e.SynthesisAdapterBase=s,s.telemetryDataEnabled=!0},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AvatarSynthesisAdapter=void 0;const p=t(79),n=t(2);class i extends n.SynthesisAdapterBase{constructor(s,h,c,r,o){super(s,h,c,void 0),this.privAvatarSynthesizer=r,this.privSynthesizer=r,this.privAvatarConfig=o}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(void 0)}setSpeechConfigSynthesisSection(){this.privSynthesizerConfig.synthesisVideoSection={format:{bitrate:this.privAvatarConfig.videoFormat?.bitrate,codec:this.privAvatarConfig.videoFormat?.codec,crop:{bottomRight:{x:this.privAvatarConfig.videoFormat?.cropRange?.bottomRight?.x,y:this.privAvatarConfig.videoFormat?.cropRange?.bottomRight?.y},topLeft:{x:this.privAvatarConfig.videoFormat?.cropRange?.topLeft?.x,y:this.privAvatarConfig.videoFormat?.cropRange?.topLeft?.y}},resolution:{height:this.privAvatarConfig.videoFormat?.height,width:this.privAvatarConfig.videoFormat?.width}},protocol:{name:"WebRTC",webrtcConfig:{clientDescription:btoa(this.privSynthesizerConfig.parameters.getProperty(p.PropertyId.TalkingAvatarService_WebRTC_SDP)),iceServers:this.privAvatarConfig.remoteIceServers??this.privAvatarSynthesizer.iceServers}},talkingAvatar:{background:{color:this.privAvatarConfig.backgroundColor,image:{url:this.privAvatarConfig.backgroundImage?.toString()}},character:this.privAvatarConfig.character,customized:this.privAvatarConfig.customized,style:this.privAvatarConfig.style}}}onAvatarEvent(s){if(this.privAvatarSynthesizer.avatarEventReceived){const h=new p.AvatarEventArgs(s.Data.Offset,s.Data.Name);try{this.privAvatarSynthesizer.avatarEventReceived(this.privAvatarSynthesizer,h)}catch{}}}}e.AvatarSynthesisAdapter=i},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechSynthesisAdapter=void 0;const p=t(79),n=t(2);class i extends n.SynthesisAdapterBase{constructor(s,h,c,r,o){super(s,h,c,o),this.privSpeechSynthesizer=r,this.privSynthesizer=r}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(this.privSpeechSynthesizer)}onSynthesisStarted(s){const h=new p.SpeechSynthesisEventArgs(new p.SpeechSynthesisResult(s,p.ResultReason.SynthesizingAudioStarted));this.privSpeechSynthesizer.synthesisStarted&&this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer,h)}onSynthesizing(s){if(this.privSpeechSynthesizer.synthesizing)try{const h=this.privSynthesisTurn.audioOutputFormat.addHeader(s),c=new p.SpeechSynthesisEventArgs(new p.SpeechSynthesisResult(this.privSynthesisTurn.requestId,p.ResultReason.SynthesizingAudio,h));this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer,c)}catch{}}onSynthesisCancelled(s){if(this.privSpeechSynthesizer.SynthesisCanceled){const h=new p.SpeechSynthesisEventArgs(s);try{this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer,h)}catch{}}}onSynthesisCompleted(s){if(this.privSpeechSynthesizer.synthesisCompleted)try{this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer,new p.SpeechSynthesisEventArgs(s))}catch{}}onWordBoundary(s){if(this.privSpeechSynthesizer.wordBoundary)try{this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer,s)}catch{}}onVisemeReceived(s){if(this.privSpeechSynthesizer.visemeReceived)try{this.privSpeechSynthesizer.visemeReceived(this.privSpeechSynthesizer,s)}catch{}}onBookmarkReached(s){if(this.privSpeechSynthesizer.bookmarkReached)try{this.privSpeechSynthesizer.bookmarkReached(this.privSpeechSynthesizer,s)}catch{}}}e.SpeechSynthesisAdapter=i},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SynthesisRestAdapter=void 0;const p=t(60),n=t(79),i=t(134),a=t(54);e.SynthesisRestAdapter=class{constructor(s,h){let c=s.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Endpoint,void 0);if(!c){const o=s.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Region,"westus"),d=i.ConnectionFactoryBase.getHostSuffix(o);c=s.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Host,`https://${o}.tts.speech${d}`)}this.privUri=`${c}/cognitiveservices/voices/list`;const r=p.RestConfigBase.requestOptions;this.privRestAdapter=new p.RestMessageAdapter(r),this.privAuthentication=h}getVoicesList(s){return this.privRestAdapter.setHeaders(a.HeaderNames.ConnectionId,s),this.privAuthentication.fetch(s).then(h=>(this.privRestAdapter.setHeaders(h.headerName,h.token),this.privRestAdapter.request(p.RestRequestType.Get,this.privUri)))}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SynthesizerConfig=e.SynthesisServiceType=void 0;const p=t(2);var n;(function(i){i[i.Standard=0]="Standard",i[i.Custom=1]="Custom"})(n=e.SynthesisServiceType||(e.SynthesisServiceType={})),e.SynthesizerConfig=class{constructor(i,a){this.privSynthesisServiceType=n.Standard,this.avatarEnabled=!1,this.privSpeechServiceConfig=i||new p.SpeechServiceConfig(new p.Context(null)),this.privParameters=a}get parameters(){return this.privParameters}get synthesisServiceType(){return this.privSynthesisServiceType}set synthesisServiceType(i){this.privSynthesisServiceType=i}set synthesisVideoSection(i){this.privSpeechServiceConfig.Context.synthesis={video:i}}get SpeechServiceConfig(){return this.privSpeechServiceConfig}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SynthesisContext=void 0;const p=t(79);e.SynthesisContext=class{constructor(){this.privContext={}}setSection(n,i){this.privContext[n]=i}set audioOutputFormat(n){this.privAudioOutputFormat=n}toJSON(){return JSON.stringify(this.privContext)}setSynthesisSection(n){const i=this.buildSynthesisContext(n);this.setSection("synthesis",i)}buildSynthesisContext(n){return{audio:{metadataOptions:{bookmarkEnabled:!!n?.bookmarkReached,punctuationBoundaryEnabled:n?.properties.getProperty(p.PropertyId.SpeechServiceResponse_RequestPunctuationBoundary,!!n?.wordBoundary),sentenceBoundaryEnabled:n?.properties.getProperty(p.PropertyId.SpeechServiceResponse_RequestSentenceBoundary,!1),sessionEndEnabled:!0,visemeEnabled:!!n?.visemeReceived,wordBoundaryEnabled:n?.properties.getProperty(p.PropertyId.SpeechServiceResponse_RequestWordBoundary,!!n?.wordBoundary)},outputFormat:this.privAudioOutputFormat.requestAudioFormatString},language:{autoDetection:n?.autoDetectSourceLanguage}}}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeakerRecognitionConfig=void 0;const p=t(2);e.SpeakerRecognitionConfig=class{constructor(n,i){this.privContext=n||new p.Context(null),this.privParameters=i}get parameters(){return this.privParameters}get Context(){return this.privContext}}},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeakerServiceRecognizer=void 0;const p=t(60),n=t(4),i=t(79),a=t(2),s=t(206);class h extends a.ServiceRecognizerBase{constructor(r,o,d,u,v){super(r,o,d,u,v),this.privSpeakerRecognizer=v,this.privSpeakerAudioSource=d,this.recognizeSpeaker=l=>this.recognizeSpeakerOnce(l),this.sendPrePayloadJSONOverride=()=>this.noOp()}processTypeSpecificMessages(r){let o=!1;const d=new i.PropertyCollection;if(r.messageType===n.MessageType.Text&&d.setProperty(i.PropertyId.SpeechServiceResponse_JsonResult,r.textBody),r.path.toLowerCase()==="speaker.response"){const v=JSON.parse(r.textBody);let l;l=v.status.statusCode.toLowerCase()!=="success"?new i.SpeakerRecognitionResult(v,i.ResultReason.Canceled,i.CancellationErrorCode.ServiceError,v.status.reason):new i.SpeakerRecognitionResult(v,i.ResultReason.RecognizedSpeaker),this.privResultDeferral&&this.privResultDeferral.resolve(l),o=!0}const u=new n.Deferred;return u.resolve(o),u.promise}cancelRecognition(r,o,d,u,v){if(new i.PropertyCollection().setProperty(a.CancellationErrorCodePropertyName,i.CancellationErrorCode[u]),this.privResultDeferral){const l=new i.SpeakerRecognitionResult({scenario:this.privSpeakerModel.scenario,status:{statusCode:v,reason:v}},i.ResultReason.Canceled,u,v);try{this.privResultDeferral.resolve(l)}catch(g){this.privResultDeferral.reject(g)}}}async recognizeSpeakerOnce(r){this.privSpeakerModel=r,this.voiceProfileType=r.scenario,this.privResultDeferral||(this.privResultDeferral=new n.Deferred),this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(i.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);const o=this.connectImpl(),d=this.sendPreAudioMessages(this.extractSpeakerContext(r)),u=await this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),v=await this.privSpeakerAudioSource.format,l=await this.privSpeakerAudioSource.deviceInfo,g=new p.ReplayableAudioNode(u,v.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(g,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:l};try{await o,await d}catch(S){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.ConnectionFailure,S)}const m=new i.SessionEventArgs(this.privRequestSession.sessionId);return this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,m),this.receiveMessage(),this.sendAudio(g).then(()=>{},S=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.RuntimeError,S)}),this.privResultDeferral.promise}async sendPreAudioMessages(r){const o=await this.fetchConnection();await this.sendSpeakerRecognition(o,r)}async sendSpeakerRecognition(r,o){const d=JSON.stringify(o);return r.send(new s.SpeechConnectionMessage(n.MessageType.Text,"speaker.context",this.privRequestSession.requestId,"application/json; charset=utf-8",d))}extractSpeakerContext(r){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:r.profileIds,scenario:r.scenario}}}e.SpeakerServiceRecognizer=h},(f,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VoiceServiceRecognizer=void 0;const p=t(60),n=t(4),i=t(79),a=t(2),s=t(206);class h extends a.ServiceRecognizerBase{constructor(r,o,d,u,v){super(r,o,d,u,v),this.privDeferralMap=new n.DeferralMap,this.privSpeakerAudioSource=d,this.sendPrePayloadJSONOverride=()=>this.noOp()}set SpeakerAudioSource(r){this.privSpeakerAudioSource=r}processTypeSpecificMessages(r){let o=!1;const d=new i.PropertyCollection;switch(r.messageType===n.MessageType.Text&&d.setProperty(i.PropertyId.SpeechServiceResponse_JsonResult,r.textBody),r.path.toLowerCase()){case"speaker.profiles":const v=JSON.parse(r.textBody);switch(v.operation.toLowerCase()){case"create":this.handleCreateResponse(v,r.requestId);break;case"delete":case"reset":this.handleResultResponse(v,r.requestId);break;case"fetch":const S=JSON.parse(r.textBody);this.handleFetchResponse(S,r.requestId)}o=!0;break;case"speaker.phrases":const l=JSON.parse(r.textBody);this.handlePhrasesResponse(l,r.requestId),o=!0;break;case"speaker.profile.enrollment":const g=JSON.parse(r.textBody),m=new i.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(g.enrollment?g.enrollment.enrollmentStatus:g.status.statusCode),g.enrollment?JSON.stringify(g.enrollment):void 0,g.status.reason);this.privDeferralMap.getId(r.requestId)&&this.privDeferralMap.complete(r.requestId,m),this.privRequestSession.onSpeechEnded(),o=!0}const u=new n.Deferred;return u.resolve(o),u.promise}cancelRecognition(r,o,d,u,v){new i.PropertyCollection().setProperty(a.CancellationErrorCodePropertyName,i.CancellationErrorCode[u]);const l=new i.VoiceProfileEnrollmentResult(i.ResultReason.Canceled,v,v);this.privDeferralMap.getId(o)&&this.privDeferralMap.complete(o,l)}async createProfile(r,o){this.voiceProfileType=r.toString();const d=this.connectImpl();try{const u=new n.Deferred;return await d,await this.sendCreateProfile(u,r,o),this.receiveMessage(),u.promise}catch(u){throw u}}async resetProfile(r){return this.voiceProfileType=r.profileType.toString(),this.sendCommonRequest("reset",r.profileType,r)}async deleteProfile(r){return this.voiceProfileType=r.profileType.toString(),this.sendCommonRequest("delete",r.profileType,r)}async retrieveEnrollmentResult(r){return this.voiceProfileType=r.profileType.toString(),this.privExpectedProfileId=r.profileId,this.sendCommonRequest("fetch",r.profileType,r)}async getAllProfiles(r){return this.voiceProfileType=r.toString(),this.sendCommonRequest("fetch",r)}async getActivationPhrases(r,o){this.voiceProfileType=r.toString();const d=this.connectImpl();try{const u=new n.Deferred;return await d,await this.sendPhrasesRequest(u,r,o),this.receiveMessage(),u.promise}catch(u){throw u}}async enrollProfile(r){this.voiceProfileType=r.profileType.toString();const o=new n.Deferred;this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(i.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);const d=this.connectImpl(),u=this.sendPreAudioMessages(r,o),v=await this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),l=await this.privSpeakerAudioSource.format,g=await this.privSpeakerAudioSource.deviceInfo,m=new p.ReplayableAudioNode(v,l.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(m,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:g};try{await d,await u}catch(y){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.ConnectionFailure,y)}const S=new i.SessionEventArgs(this.privRequestSession.sessionId);return this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,S),this.receiveMessage(),this.sendAudio(m).then(()=>{},y=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.RuntimeError,y)}),o.promise}async sendPreAudioMessages(r,o){const d=await this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,o),await this.sendBaseRequest(d,"enroll",this.scenarioFrom(r.profileType),r)}async sendPhrasesRequest(r,o,d){const u=await this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,r);const v={locale:d,scenario:this.scenarioFrom(o)};return u.send(new s.SpeechConnectionMessage(n.MessageType.Text,"speaker.profile.phrases",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(v)))}async sendCreateProfile(r,o,d){const u=await this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,r);const v={locale:d,number:"1",scenario:o===i.VoiceProfileType.TextIndependentIdentification?"TextIndependentIdentification":o===i.VoiceProfileType.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification"};return u.send(new s.SpeechConnectionMessage(n.MessageType.Text,"speaker.profile.create",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(v)))}async sendCommonRequest(r,o,d){const u=this.connectImpl();try{const v=new n.Deferred;this.privRequestSession.onSpeechContext(),await u;const l=await this.fetchConnection();return this.privDeferralMap.add(this.privRequestSession.requestId,v),await this.sendBaseRequest(l,r,this.scenarioFrom(o),d),this.receiveMessage(),v.promise}catch(v){throw v}}async sendBaseRequest(r,o,d,u){const v={scenario:d};return u?v.profileIds=[u.profileId]:v.maxPageSize=-1,r.send(new s.SpeechConnectionMessage(n.MessageType.Text,`speaker.profile.${o}`,this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(v)))}extractSpeakerContext(r){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:r.profileIds,scenario:r.scenario}}handlePhrasesResponse(r,o){if(!this.privDeferralMap.getId(o))throw new Error(`Voice Profile get activation phrases request for requestID ${o} not found`);if(r.status.statusCode.toLowerCase()!=="success"){const d=i.ResultReason.Canceled,u=new i.VoiceProfilePhraseResult(d,r.status.statusCode,r.passPhraseType,[]);this.privDeferralMap.complete(o,u)}else{if(!(r.phrases&&r.phrases.length>0))throw new Error("Voice Profile get activation phrases failed, no phrases received");{const d=i.ResultReason.EnrollingVoiceProfile,u=new i.VoiceProfilePhraseResult(d,r.status.statusCode,r.passPhraseType,r.phrases);this.privDeferralMap.complete(o,u)}}}handleCreateResponse(r,o){if(!(r.profiles&&r.profiles.length>0))throw new Error("Voice Profile create failed, no profile id received");if(!this.privDeferralMap.getId(o))throw new Error(`Voice Profile create request for requestID ${o} not found`);{const d=r.profiles.map(u=>u.profileId);this.privDeferralMap.complete(o,d)}}handleResultResponse(r,o){if(!this.privDeferralMap.getId(o))throw new Error(`Voice Profile create request for requestID ${o} not found`);{const d=r.operation.toLowerCase()==="delete"?i.ResultReason.DeletedVoiceProfile:i.ResultReason.ResetVoiceProfile,u=r.status.statusCode.toLowerCase()==="success"?d:i.ResultReason.Canceled,v=new i.VoiceProfileResult(u,`statusCode: ${r.status.statusCode}, errorDetails: ${r.status.reason}`);this.privDeferralMap.complete(o,v)}}handleFetchResponse(r,o){if(!this.privDeferralMap.getId(o)||!r.profiles[0])throw new Error(`Voice Profile fetch request for requestID ${o} not found`);if(this.privExpectedProfileId&&r.profiles.length===1&&r.profiles[0].profileId===this.privExpectedProfileId){this.privExpectedProfileId=void 0;const d=r.profiles[0],u=new i.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(d.enrollmentStatus),JSON.stringify(d),r.status.reason);this.privDeferralMap.complete(o,u)}else if(r.profiles.length>0){const d=r.profiles,u=[];for(const v of d)u.push(new i.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(v.enrollmentStatus),JSON.stringify(v),r.status.reason));this.privDeferralMap.complete(o,u)}}enrollmentReasonFrom(r){switch(r.toLowerCase()){case"enrolled":return i.ResultReason.EnrolledVoiceProfile;case"invalidlocale":case"invalidphrase":case"invalidaudioformat":case"invalidscenario":case"invalidprofilecount":case"invalidoperation":case"audiotooshort":case"audiotoolong":case"toomanyenrollments":case"storageconflict":case"profilenotfound":case"incompatibleprofiles":case"incompleteenrollment":return i.ResultReason.Canceled;default:return i.ResultReason.EnrollingVoiceProfile}}scenarioFrom(r){return r===i.VoiceProfileType.TextIndependentIdentification?"TextIndependentIdentification":r===i.VoiceProfileType.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification"}}e.VoiceServiceRecognizer=h},(f,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.type=e.connectivity=e.Device=e.OS=e.System=e.Context=e.SpeechServiceConfig=void 0,e.SpeechServiceConfig=class{constructor(p){this.context=p}serialize(){return JSON.stringify(this,(p,n)=>{if(n&&typeof n=="object"&&!Array.isArray(n)){const i={};for(const a in n)Object.hasOwnProperty.call(n,a)&&(i[a&&a.charAt(0).toLowerCase()+a.substring(1)]=n[a]);return i}return n})}get Context(){return this.context}get Recognition(){return this.recognition}set Recognition(p){this.recognition=p.toLowerCase()}},e.Context=class{constructor(p){this.system=new t,this.os=p}};class t{constructor(){this.name="SpeechSDK",this.version="1.40.0",this.build="JavaScript",this.lang="JavaScript"}}e.System=t,e.OS=class{constructor(p,n,i){this.platform=p,this.name=n,this.version=i}},e.Device=class{constructor(p,n,i){this.manufacturer=p,this.model=n,this.version=i}},function(p){p.Bluetooth="Bluetooth",p.Wired="Wired",p.WiFi="WiFi",p.Cellular="Cellular",p.InBuilt="InBuilt",p.Unknown="Unknown"}(e.connectivity||(e.connectivity={})),function(p){p.Phone="Phone",p.Speaker="Speaker",p.Car="Car",p.Headset="Headset",p.Thermostat="Thermostat",p.Microphones="Microphones",p.Deskphone="Deskphone",p.RemoteControl="RemoteControl",p.Unknown="Unknown",p.File="File",p.Stream="Stream"}(e.type||(e.type={}))}],_={};function M(f){var e=_[f];if(e!==void 0)return e.exports;var t=_[f]={exports:{}};return B[f].call(t.exports,t,t.exports,M),t.exports}M.n=f=>{var e=f&&f.__esModule?()=>f.default:()=>f;return M.d(e,{a:e}),e},M.d=(f,e)=>{for(var t in e)M.o(e,t)&&!M.o(f,t)&&Object.defineProperty(f,t,{enumerable:!0,get:e[t]})},M.o=(f,e)=>Object.prototype.hasOwnProperty.call(f,e),M.r=f=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(f,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(f,"__esModule",{value:!0})};var j={};(()=>{"use strict";M.r(j);var f=M(1);window.SpeechSDK=f})()})();
