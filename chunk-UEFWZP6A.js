import{$ as f,$a as Re,A as j,Aa as xt,B as mt,Ba as wt,C as ut,Ca as Tt,D as oe,Da as D,E as K,Ea as Et,F as ye,Fa as we,G as s,Ga as Te,H as x,I as gt,J as Ge,K as ft,Ka as kt,L as b,La as At,M as _t,Ma as Ee,N as p,Na as ke,O as Ye,P as U,Pa as Ae,Q as re,Qa as N,R as A,Ra as Pe,S as C,Sa as Pt,T as Qe,Ta as Ze,U as F,Ua as Mt,V,Va as pe,W as l,Wa as Me,X as a,Xa as me,Y as v,Ya as ue,Z as he,Za as Ie,_ as S,_a as Oe,a as st,aa as m,ab as ge,b as at,ba as vt,bb as De,c as fe,ca as bt,cb as Be,d as be,da as Ct,db as Fe,e as le,ea as G,eb as Ve,f as ce,fa as Y,fb as It,g as Ce,ga as Q,gb as y,h as lt,ha as St,hb as Ot,i as de,ia as yt,ib as Rt,j as z,ja as I,jb as Dt,k as ct,ka as h,kb as Le,l as Se,la as P,lb as Ne,m as Ue,ma as E,mb as Je,n as M,na as q,nb as Bt,o as ie,oa as X,p as dt,pa as Z,q as H,qa as se,r as T,ra as W,s as w,sa as J,t as ne,ta as O,u as _e,ua as xe,v as ht,va as ee,w as u,x as g,xa as qe,y as k,ya as Xe,z as pt,za as L}from"./chunk-XLJC6YSI.js";var ni=["form"],oi=(i,n)=>n.route,ri=i=>({"d-block":i}),si=i=>({"text-primary fw-bold":i});function ai(i,n){if(i&1&&(l(0,"video",18),v(1,"source",31),a()),i&2){let o=m();p("muted","muted"),s(),p("src",o.settings.backgroundUrl,oe)}}function li(i,n){if(i&1&&v(0,"div",32),i&2){let o=m();Ye("background-image","url("+o.settings.backgroundUrl+")")}}function ci(i,n){if(i&1&&(l(0,"li",28)(1,"a",33),h(2),a()()),i&2){let o=n.$implicit,t=m();s(),p("routerLink",o.route)("ngClass",J(3,si,t.activatedRoute==o.route)),s(),P(o.title)}}var Vt=(()=>{class i{form=ft.required("form");router=T(Ee);store=T(Bt);settings=Je(this.store);clonedSettings=structuredClone(this.settings);collapsed=!0;hideSettings=!0;activatedRoute;navLinks=[{route:"/",title:"Home"},{route:"/ai-service/ai-search",title:"AI Search"},{route:"/ai-service/ai-chat-bot",title:"Chat Bot"},{route:"",title:"Chat Bot"}];constructor(){}ngOnInit(){this.router.events.pipe(ce(o=>o instanceof kt)).subscribe(o=>{this.activatedRoute=o.url}),this.form().valueChanges.subscribe(o=>{this.clonedSettings.preview&&(this.settings=o)})}toggleSettings(o){o.preventDefault(),this.hideSettings=!this.hideSettings}saveSettings(){this.store.updateState(this.clonedSettings),this.settings=this.clonedSettings,this.hideSettings=!0}closeIfOpened(){this.hideSettings||(this.hideSettings=!0)}cancelSettings(){this.hideSettings=!0,this.clonedSettings=this.settings=Je(this.store)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=w({type:i,selectors:[["app-ai-services"]],viewQuery:function(t,e){t&1&&St(e.form,ni,5),t&2&&yt()},hostBindings:function(t,e){t&1&&f("keydown.Escape",function(c){return e.closeIfOpened(c)},!1,K)},decls:49,vars:13,consts:[["form","ngForm"],[1,"min-vh-100"],[1,"shadow-lg","bg-white","rounded-4","position-absolute",2,"z-index","100","width","500px","left","50%","top","50%","transform","translate(-50%,-50%)","padding","20px",3,"hidden"],[1,"mb-3"],["for","logoUrl",1,"form-label"],["name","logoUrl","type","text","id","logoUrl","placeholder","assets/images/nlogo.svg",1,"form-control",3,"ngModelChange","ngModel"],["for","backgroundUrl",1,"form-label"],["name","backgroundUrl","type","text","id","backgroundUrl","placeholder","https://www.phcc.gov.qa/videos/default-source/home-video-library/16-x-9---30-seconds---with-music---english.mp4",1,"form-control",3,"ngModelChange","ngModel"],["name","backgroundColor","type","color","id","backgroundColor",3,"ngModelChange","ngModel"],["for","backgroundColor"],[1,"form-check","form-switch"],["name","isVideo","type","checkbox","role","switch","id","isVideo",1,"form-check-input",3,"ngModelChange","ngModel"],["for","isVideo",1,"form-check-label"],["name","preview","type","checkbox","role","switch","id","preview",1,"form-check-input",3,"ngModelChange","ngModel"],["for","preview",1,"form-check-label"],[1,"d-flex","gap-2","justify-content-end"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-secondary",3,"click"],["width","100%","height","100%","autoplay","","loop","",1,"phcc-video","sf.mp4","position-fixed",3,"muted"],[2,"position","absolute","width","100vw","height","100vh","background-size","cover","background-position","center center",3,"background-image"],[1,"navbar","navbar-expand-lg","navbar-light","bg-light",2,"box-shadow","0 2px 10px #000"],[1,"container"],["href","#",1,"navbar-brand","d-flex","align-items-center"],["alt","Ebla corp","height","80",1,"d-inline-block","align-text-top",3,"src"],["type","button",1,"navbar-toggler",3,"click"],[1,"navbar-toggler-icon"],[1,"navbar-collapse","collapse",3,"ngClass"],[1,"navbar-nav","ms-auto"],[1,"nav-item"],["href","#",1,"nav-link",3,"click"],[1,"container","py-5"],["type","video/mp4",3,"src"],[2,"position","absolute","width","100vw","height","100vh","background-size","cover","background-position","center center"],[1,"nav-link",3,"routerLink","ngClass"]],template:function(t,e){if(t&1){let r=S();l(0,"main",1)(1,"div",2)(2,"h1"),h(3,"Settings"),a(),l(4,"div")(5,"form",null,0)(7,"div",3)(8,"label",4),h(9,"Logo Url"),a(),l(10,"input",5),Z("ngModelChange",function(d){return u(r),X(e.clonedSettings.logoUrl,d)||(e.clonedSettings.logoUrl=d),g(d)}),a()(),l(11,"div",3)(12,"label",6),h(13,"background Url"),a(),l(14,"input",7),Z("ngModelChange",function(d){return u(r),X(e.clonedSettings.backgroundUrl,d)||(e.clonedSettings.backgroundUrl=d),g(d)}),a()(),l(15,"div",3)(16,"input",8),Z("ngModelChange",function(d){return u(r),X(e.clonedSettings.backgroundColor,d)||(e.clonedSettings.backgroundColor=d),g(d)}),a(),l(17,"label",9),h(18,"\xA0 background color"),a()(),l(19,"div",10)(20,"input",11),Z("ngModelChange",function(d){return u(r),X(e.clonedSettings.isVideo,d)||(e.clonedSettings.isVideo=d),g(d)}),a(),l(21,"label",12),h(22,"is Background Video?"),a()(),l(23,"div",10)(24,"input",13),Z("ngModelChange",function(d){return u(r),X(e.clonedSettings.preview,d)||(e.clonedSettings.preview=d),g(d)}),a(),l(25,"label",14),h(26,"Live preview"),a()()()(),l(27,"div",15)(28,"button",16),f("click",function(){return u(r),g(e.saveSettings())}),h(29,"Save"),a(),l(30,"button",17),f("click",function(){return u(r),g(e.cancelSettings())}),h(31,"Cancel"),a()()(),b(32,ai,2,2,"video",18)(33,li,1,2,"div",19),l(34,"nav",20)(35,"div",21)(36,"a",22),v(37,"img",23),a(),l(38,"button",24),f("click",function(){return u(r),g(e.collapsed=!e.collapsed)}),v(39,"span",25),a(),l(40,"div",26)(41,"ul",27),F(42,ci,3,5,"li",28,oi),l(44,"li",28)(45,"a",29),f("click",function(d){return u(r),g(e.toggleSettings(d))}),h(46,"Settings"),a()()()()()(),l(47,"div",30),v(48,"router-outlet"),a()()}t&2&&(Ye("background-color",e.settings.backgroundColor),s(),p("hidden",e.hideSettings),s(9),q("ngModel",e.clonedSettings.logoUrl),s(4),q("ngModel",e.clonedSettings.backgroundUrl),s(2),q("ngModel",e.clonedSettings.backgroundColor),s(4),q("ngModel",e.clonedSettings.isVideo),s(4),q("ngModel",e.clonedSettings.preview),s(8),C(e.settings.isVideo?32:33),s(5),p("src",e.settings.logoUrl,oe),s(3),p("ngClass",J(11,ri,!e.collapsed)),s(2),V(e.navLinks))},dependencies:[L,At,ke,ge,pe,Mt,me,ue,Re,Ie],styles:[".phcc-video[_ngcontent-%COMP%]{background:#fff;width:100%;object-fit:cover}"]})}return i})();var je=class{clone(n){return Object.assign(this,n)}};var te=class extends je{content;role;context;end_turn;function_call;tool_calls;constructor(n="",o="user"){super(),this.content=n,this.role=o}};var Lt=(()=>{class i extends Pe{tag="website/";http=T(Te);messageHistory=[];constructor(){super("chat")}appendMessage(o){this.messageHistory.push(o)}_drawBack(){this.messageHistory.pop()}askQuestion(o,t){return this.appendMessage(new te(o)),this.startLoading(),this.http.post(this.baseUrl,{messages:this.messageHistory,stream_id:t},{headers:new we({})}).pipe(de(()=>{this.stopLoading()}),Ce(e=>{throw this._drawBack(),this.appendMessage(new te().clone({content:e.message,role:"error"})),new Error(e)})).pipe(le(e=>(typeof e=="string"&&(e=JSON.parse(e),e.error&&(e.message=new te(e.message,"error"))),e)))}resetMessageHistory(){this.messageHistory=[]}static \u0275fac=function(t){return new(t||i)};static \u0275prov=M({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var di=(()=>{let n=class n{constructor(){this._focusTrapStack=[]}register(t){this._focusTrapStack=this._focusTrapStack.filter(r=>r!==t);let e=this._focusTrapStack;e.length&&e[e.length-1]._disable(),e.push(t),t._enable()}deregister(t){t._disable();let e=this._focusTrapStack,r=e.indexOf(t);r!==-1&&(e.splice(r,1),e.length&&e[e.length-1]._enable())}};n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=M({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})();var et;try{et=typeof Intl<"u"&&Intl.v8BreakIterator}catch{et=!1}var jt=(()=>{let n=class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?Et(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||et)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}};n.\u0275fac=function(e){return new(e||n)(H(mt))},n.\u0275prov=M({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})();var Wt=(()=>{let n=class n{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return pi(t)&&getComputedStyle(t).visibility==="visible"}isTabbable(t){if(!this._platform.isBrowser)return!1;let e=hi(Ci(t));if(e&&(Nt(e)===-1||!this.isVisible(e)))return!1;let r=t.nodeName.toLowerCase(),c=Nt(t);return t.hasAttribute("contenteditable")?c!==-1:r==="iframe"||r==="object"||this._platform.WEBKIT&&this._platform.IOS&&!vi(t)?!1:r==="audio"?t.hasAttribute("controls")?c!==-1:!1:r==="video"?c===-1?!1:c!==null?!0:this._platform.FIREFOX||t.hasAttribute("controls"):t.tabIndex>=0}isFocusable(t,e){return bi(t)&&!this.isDisabled(t)&&(e?.ignoreVisibility||this.isVisible(t))}};n.\u0275fac=function(e){return new(e||n)(H(jt))},n.\u0275prov=M({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})();function hi(i){try{return i.frameElement}catch{return null}}function pi(i){return!!(i.offsetWidth||i.offsetHeight||typeof i.getClientRects=="function"&&i.getClientRects().length)}function mi(i){let n=i.nodeName.toLowerCase();return n==="input"||n==="select"||n==="button"||n==="textarea"}function ui(i){return fi(i)&&i.type=="hidden"}function gi(i){return _i(i)&&i.hasAttribute("href")}function fi(i){return i.nodeName.toLowerCase()=="input"}function _i(i){return i.nodeName.toLowerCase()=="a"}function $t(i){if(!i.hasAttribute("tabindex")||i.tabIndex===void 0)return!1;let n=i.getAttribute("tabindex");return n=="-32768"?!1:!!(n&&!isNaN(parseInt(n,10)))}function Nt(i){if(!$t(i))return null;let n=parseInt(i.getAttribute("tabindex")||"",10);return isNaN(n)?-1:n}function vi(i){let n=i.nodeName.toLowerCase(),o=n==="input"&&i.type;return o==="text"||o==="password"||n==="select"||n==="textarea"}function bi(i){return ui(i)?!1:mi(i)||gi(i)||i.hasAttribute("contenteditable")||$t(i)}function Ci(i){return i.ownerDocument&&i.ownerDocument.defaultView||window}function Ht(i){return i!=null&&`${i}`!="false"}var tt=class{get enabled(){return this._enabled}set enabled(n){this._enabled=n,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(n,this._startAnchor),this._toggleAnchorTabIndex(n,this._endAnchor))}constructor(n,o,t,e,r=!1){this._element=n,this._checker=o,this._ngZone=t,this._document=e,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,r||this.attachAnchors()}destroy(){let n=this._startAnchor,o=this._endAnchor;n&&(n.removeEventListener("focus",this.startAnchorListener),n.parentNode&&n.parentNode.removeChild(n)),o&&(o.removeEventListener("focus",this.endAnchorListener),o.parentNode&&o.parentNode.removeChild(o)),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return this._hasAttached?!0:(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(){return new Promise(n=>{this._executeOnStable(()=>n(this.focusInitialElement()))})}focusFirstTabbableElementWhenReady(){return new Promise(n=>{this._executeOnStable(()=>n(this.focusFirstTabbableElement()))})}focusLastTabbableElementWhenReady(){return new Promise(n=>{this._executeOnStable(()=>n(this.focusLastTabbableElement()))})}_getRegionBoundary(n){let o=this._element.querySelectorAll(`[cdk-focus-region-${n}], [cdkFocusRegion${n}], [cdk-focus-${n}]`);for(let t=0;t<o.length;t++)o[t].hasAttribute(`cdk-focus-${n}`)?console.warn(`Found use of deprecated attribute 'cdk-focus-${n}', use 'cdkFocusRegion${n}' instead. The deprecated attribute will be removed in 8.0.0.`,o[t]):o[t].hasAttribute(`cdk-focus-region-${n}`)&&console.warn(`Found use of deprecated attribute 'cdk-focus-region-${n}', use 'cdkFocusRegion${n}' instead. The deprecated attribute will be removed in 8.0.0.`,o[t]);return n=="start"?o.length?o[0]:this._getFirstTabbableElement(this._element):o.length?o[o.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(){let n=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(n){if(n.hasAttribute("cdk-focus-initial")&&console.warn("Found use of deprecated attribute 'cdk-focus-initial', use 'cdkFocusInitial' instead. The deprecated attribute will be removed in 8.0.0",n),!this._checker.isFocusable(n)){let o=this._getFirstTabbableElement(n);return o?.focus(),!!o}return n.focus(),!0}return this.focusFirstTabbableElement()}focusFirstTabbableElement(){let n=this._getRegionBoundary("start");return n&&n.focus(),!!n}focusLastTabbableElement(){let n=this._getRegionBoundary("end");return n&&n.focus(),!!n}hasAttached(){return this._hasAttached}_getFirstTabbableElement(n){if(this._checker.isFocusable(n)&&this._checker.isTabbable(n))return n;let o=n.children||n.childNodes;for(let t=0;t<o.length;t++){let e=o[t].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(o[t]):null;if(e)return e}return null}_getLastTabbableElement(n){if(this._checker.isFocusable(n)&&this._checker.isTabbable(n))return n;let o=n.children||n.childNodes;for(let t=o.length-1;t>=0;t--){let e=o[t].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(o[t]):null;if(e)return e}return null}_createAnchor(){let n=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,n),n.classList.add("cdk-visually-hidden"),n.classList.add("cdk-focus-trap-anchor"),n.setAttribute("aria-hidden","true"),n}_toggleAnchorTabIndex(n,o){n?o.setAttribute("tabindex","0"):o.removeAttribute("tabindex")}toggleAnchors(n){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(n,this._startAnchor),this._toggleAnchorTabIndex(n,this._endAnchor))}_executeOnStable(n){this._ngZone.isStable?n():this._ngZone.onStable.pipe(lt(1)).subscribe(n)}},Si=(()=>{let n=class n{constructor(t,e,r){this._checker=t,this._ngZone=e,this._document=r}create(t,e=!1){return new tt(t,this._checker,this._ngZone,this._document,e)}};n.\u0275fac=function(e){return new(e||n)(H(Wt),H(pt),H(Xe))},n.\u0275prov=M({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})(),zt=(()=>{let n=class n{get enabled(){return this.focusTrap.enabled}set enabled(t){this.focusTrap.enabled=Ht(t)}get autoCapture(){return this._autoCapture}set autoCapture(t){this._autoCapture=Ht(t)}constructor(t,e,r){this._elementRef=t,this._focusTrapFactory=e,this._previouslyFocusedElement=null,this._autoCapture=!1,this._document=r,this.focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement,!0)}ngOnDestroy(){this.focusTrap.destroy(),this._previouslyFocusedElement&&(this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null)}ngAfterContentInit(){this.focusTrap.attachAnchors(),this.autoCapture&&this._captureFocus()}ngDoCheck(){this.focusTrap.hasAttached()||this.focusTrap.attachAnchors()}ngOnChanges(t){let e=t.autoCapture;e&&!e.firstChange&&this.autoCapture&&this.focusTrap.hasAttached()&&this._captureFocus()}_captureFocus(){this._previouslyFocusedElement=this._document.activeElement,this.focusTrap.focusInitialElementWhenReady()}};n.\u0275fac=function(e){return new(e||n)(x(j),x(Si),x(Xe))},n.\u0275dir=_e({type:n,selectors:[["","focusTrap",""]],inputs:{enabled:[0,"cdkTrapFocus","enabled"],autoCapture:[0,"cdkTrapFocusAutoCapture","autoCapture"]},exportAs:["focusTrap"],features:[ht]});let i=n;return i})(),Kt=(()=>{let n=class n{static forRoot(){return{ngModule:n,providers:[di,jt,Wt]}}};n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ne({type:n}),n.\u0275inj=ie({imports:[D]});let i=n;return i})();var xi=["*"],Ut=(()=>{let n=class n{constructor(){this.hide=()=>{},this.setClass=()=>{}}};n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=M({token:n,factory:n.\u0275fac,providedIn:"platform"});let i=n;return i})();var Gt=(()=>{let n=class n{};n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=M({token:n,factory:n.\u0275fac,providedIn:"platform"});let i=n;return i})(),We={backdrop:!0,keyboard:!0,focus:!0,show:!1,ignoreBackdropClick:!1,class:"",animated:!0,initialState:{},closeInterceptor:void 0},wi=new dt("override-default-config"),$={SCROLLBAR_MEASURER:"modal-scrollbar-measure",BACKDROP:"modal-backdrop",OPEN:"modal-open",FADE:"fade",IN:"in",SHOW:"show"};var $e={MODAL:300,BACKDROP:150},it={BACKRDOP:"backdrop-click",ESC:"esc",BACK:"browser-back-navigation-clicked"},Ti=(()=>{let n=class n{constructor(t,e,r){this._element=e,this._renderer=r,this.isShown=!1,this.isAnimated=!1,this._focusEl=null,this.isModalHiding=!1,this.clickStartedInContent=!1,this.config=Object.assign({},t)}ngOnInit(){this._focusEl=y.activeElement,this.isAnimated&&this._renderer.addClass(this._element.nativeElement,$.FADE),this._renderer.setStyle(this._element.nativeElement,"display","block"),setTimeout(()=>{this.isShown=!0,this._renderer.addClass(this._element.nativeElement,$.SHOW)},this.isAnimated?$e.BACKDROP:0),y&&y.body&&(this.bsModalService&&this.bsModalService.getModalsCount()===1&&(this.bsModalService.checkScrollbar(),this.bsModalService.setScrollbar()),this._renderer.addClass(y.body,$.OPEN),this._renderer.setStyle(y.body,"overflow-y","hidden")),this._element.nativeElement&&this._element.nativeElement.focus()}onClickStarted(t){this.clickStartedInContent=t.target!==this._element.nativeElement}onClickStop(t){let e=t.target===this._element.nativeElement&&!this.clickStartedInContent;if(this.config.ignoreBackdropClick||this.config.backdrop==="static"||!e){this.clickStartedInContent=!1;return}this.bsModalService?.setDismissReason(it.BACKRDOP),this.hide()}onPopState(){this.bsModalService?.setDismissReason(it.BACK),this.hide()}onEsc(t){this.isShown&&((t.keyCode===27||t.key==="Escape")&&t.preventDefault(),this.config.keyboard&&this.level===this.bsModalService?.getModalsCount()&&(this.bsModalService?.setDismissReason(it.ESC),this.hide()))}ngOnDestroy(){this.isShown&&this._hide()}hide(){if(!this.isModalHiding){if(this.config.closeInterceptor){this.config.closeInterceptor().then(()=>this._hide(),()=>{});return}this._hide()}}_hide(){this.isModalHiding=!0,this._renderer.removeClass(this._element.nativeElement,$.SHOW),setTimeout(()=>{this.isShown=!1,y&&y.body&&this.bsModalService?.getModalsCount()===1&&(this._renderer.removeClass(y.body,$.OPEN),this._renderer.setStyle(y.body,"overflow-y","")),this.bsModalService?.hide(this.config.id),this.isModalHiding=!1,this._focusEl&&this._focusEl.focus()},this.isAnimated?$e.MODAL:0)}};n.\u0275fac=function(e){return new(e||n)(x(Gt),x(j),x(Ge))},n.\u0275cmp=w({type:n,selectors:[["modal-container"]],hostAttrs:["role","dialog","tabindex","-1",1,"modal"],hostVars:3,hostBindings:function(e,r){e&1&&f("mousedown",function(d){return r.onClickStarted(d)})("click",function(d){return r.onClickStop(d)})("popstate",function(){return r.onPopState()},!1,K)("keydown.esc",function(d){return r.onEsc(d)},!1,K),e&2&&_t("aria-modal",!0)("aria-labelledby",r.config.ariaLabelledBy)("aria-describedby",r.config.ariaDescribedby)},ngContentSelectors:xi,decls:3,vars:2,consts:[["role","document","focusTrap",""],[1,"modal-content"]],template:function(e,r){e&1&&(vt(),l(0,"div",0)(1,"div",1),bt(2),a()()),e&2&&A("modal-dialog"+(r.config.class?" "+r.config.class:""))},dependencies:[zt],encapsulation:2});let i=n;return i})(),Ei=(()=>{let n=class n{get isAnimated(){return this._isAnimated}set isAnimated(t){this._isAnimated=t}get isShown(){return this._isShown}set isShown(t){this._isShown=t,t?this.renderer.addClass(this.element.nativeElement,`${$.SHOW}`):this.renderer.removeClass(this.element.nativeElement,`${$.SHOW}`)}constructor(t,e){this._isAnimated=!1,this._isShown=!1,this.element=t,this.renderer=e}ngOnInit(){this.isAnimated&&(this.renderer.addClass(this.element.nativeElement,`${$.FADE}`),Ot.reflow(this.element.nativeElement)),this.isShown=!0}};n.\u0275fac=function(e){return new(e||n)(x(j),x(Ge))},n.\u0275cmp=w({type:n,selectors:[["bs-modal-backdrop"]],hostAttrs:[1,"modal-backdrop"],decls:0,vars:0,template:function(e,r){},encapsulation:2});let i=n;return i})();var ki=1,nt=(()=>{let n=class n{constructor(t,e,r){this.clf=e,this.modalDefaultOption=r,this.onShow=new k,this.onShown=new k,this.onHide=new k,this.onHidden=new k,this.isBodyOverflowing=!1,this.originalBodyPadding=0,this.scrollbarWidth=0,this.modalsCount=0,this.loaders=[],this._focusEl=null,this._backdropLoader=this.clf.createLoader(),this._renderer=t.createRenderer(null,null),this.config=r?Object.assign({},We,r):We}show(t,e){this._focusEl=y.activeElement,this.modalsCount++,this._createLoaders();let r=e?.id||ki++;return this.config=this.modalDefaultOption?Object.assign({},We,this.modalDefaultOption,e):Object.assign({},We,e),this.config.id=r,this._showBackdrop(),this.lastDismissReason=void 0,this._showModal(t)}hide(t){(this.modalsCount===1||t==null)&&(this._hideBackdrop(),this.resetScrollbar()),this.modalsCount=this.modalsCount>=1&&t!=null?this.modalsCount-1:0,setTimeout(()=>{this._hideModal(t),this.removeLoaders(t)},this.config.animated?$e.BACKDROP:0),this._focusEl&&this._focusEl.focus()}_showBackdrop(){let t=this.config.backdrop===!0||this.config.backdrop==="static",e=!this.backdropRef||!this.backdropRef.instance.isShown;this.modalsCount===1&&(this.removeBackdrop(),t&&e&&(this._backdropLoader.attach(Ei).to("body").show({isAnimated:this.config.animated}),this.backdropRef=this._backdropLoader._componentRef))}_hideBackdrop(){if(!this.backdropRef)return;this.backdropRef.instance.isShown=!1;let t=this.config.animated?$e.BACKDROP:0;setTimeout(()=>this.removeBackdrop(),t)}_showModal(t){let e=this.loaders[this.loaders.length-1];if(this.config&&this.config.providers)for(let d of this.config.providers)e.provide(d);let r=new Ut,c=e.provide({provide:Gt,useValue:this.config}).provide({provide:Ut,useValue:r}).attach(Ti).to("body");return r.hide=()=>this.hide(r.id),r.setClass=d=>{c.instance&&(c.instance.config.class=d)},r.onHidden=new k,r.onHide=new k,this.copyEvent(e.onBeforeHide,r.onHide),this.copyEvent(e.onHidden,r.onHidden),c.show({content:t,isAnimated:this.config.animated,initialState:this.config.initialState,bsModalService:this,id:this.config.id}),c.instance&&(c.instance.level=this.getModalsCount(),r.content=e.getInnerComponent(),r.id=c.instance.config?.id),r}_hideModal(t){if(t!=null){let e=this.loaders.findIndex(c=>c.instance?.config.id===t),r=this.loaders[e];r&&r.hide(t)}else this.loaders.forEach(e=>{e.instance&&e.hide(e.instance.config.id)})}getModalsCount(){return this.modalsCount}setDismissReason(t){this.lastDismissReason=t}removeBackdrop(){this._renderer.removeClass(y.body,$.OPEN),this._renderer.setStyle(y.body,"overflow-y",""),this._backdropLoader.hide(),this.backdropRef=void 0}checkScrollbar(){this.isBodyOverflowing=y.body.clientWidth<window.innerWidth,this.scrollbarWidth=this.getScrollbarWidth()}setScrollbar(){y&&(this.originalBodyPadding=parseInt(window.getComputedStyle(y.body).getPropertyValue("padding-right")||"0",10),this.isBodyOverflowing&&(y.body.style.paddingRight=`${this.originalBodyPadding+this.scrollbarWidth}px`))}resetScrollbar(){y.body.style.paddingRight=`${this.originalBodyPadding}px`}getScrollbarWidth(){let t=this._renderer.createElement("div");this._renderer.addClass(t,$.SCROLLBAR_MEASURER),this._renderer.appendChild(y.body,t);let e=t.offsetWidth-t.clientWidth;return this._renderer.removeChild(y.body,t),e}_createLoaders(){let t=this.clf.createLoader();this.copyEvent(t.onBeforeShow,this.onShow),this.copyEvent(t.onShown,this.onShown),this.copyEvent(t.onBeforeHide,this.onHide),this.copyEvent(t.onHidden,this.onHidden),this.loaders.push(t)}removeLoaders(t){if(t!=null){let e=this.loaders.findIndex(r=>r.instance?.config.id===t);e>=0&&(this.loaders.splice(e,1),this.loaders.forEach((r,c)=>{r.instance&&(r.instance.level=c+1)}))}else this.loaders.splice(0,this.loaders.length)}copyEvent(t,e){t.subscribe(r=>{e.emit(this.lastDismissReason||r)})}};n.\u0275fac=function(e){return new(e||n)(H(gt),H(Rt),H(wi,8))},n.\u0275prov=M({token:n,factory:n.\u0275fac,providedIn:"platform"});let i=n;return i})(),So=Kt.forRoot();var ze=(()=>{class i{color="primary";constructor(){}ngOnInit(){}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=w({type:i,selectors:[["app-loading"]],inputs:{color:"color"},standalone:!0,features:[W],decls:7,vars:12,consts:[[1,"sk-wave"]],template:function(t,e){t&1&&(l(0,"div")(1,"div",0),v(2,"div")(3,"div")(4,"div")(5,"div")(6,"div"),a()()),t&2&&(A("d-flex align-items-center justify-content-center text-"+e.color),s(2),A("sk-wave-rect bg-"+e.color),s(),A("sk-wave-rect bg-"+e.color),s(),A("sk-wave-rect bg-"+e.color),s(),A("sk-wave-rect bg-"+e.color),s(),A("sk-wave-rect bg-"+e.color))},styles:[".sk-wave[_ngcontent-%COMP%]{width:40px;height:40px;display:inline-flex;justify-content:space-between}.sk-wave-rect[_ngcontent-%COMP%]{background-color:#fff;height:100%;width:15%;animation:_ngcontent-%COMP%_sk-wave 1.2s infinite ease-in-out}.sk-wave-rect[_ngcontent-%COMP%]:nth-child(1){animation-delay:-1.2s}.sk-wave-rect[_ngcontent-%COMP%]:nth-child(2){animation-delay:-1.1s}.sk-wave-rect[_ngcontent-%COMP%]:nth-child(3){animation-delay:-1s}.sk-wave-rect[_ngcontent-%COMP%]:nth-child(4){animation-delay:-.9s}.sk-wave-rect[_ngcontent-%COMP%]:nth-child(5){animation-delay:-.8s}@keyframes _ngcontent-%COMP%_sk-wave{0%,40%,to{transform:scaleY(.4)}20%{transform:scaleY(1)}}"]})}return i})();var Yt=(()=>{class i{elementRef;text="";speed=20;animating=new k;constructor(o){this.elementRef=o}ngOnInit(){this.animateText()}animateText(){this.animating.emit(!0);let o=0,t="",e=()=>{t+=this.text.charAt(o),this.elementRef.nativeElement.innerHTML=t,o++,o<this.text.length?setTimeout(e,this.speed*Math.random()):this.animating.emit(!1)};e()}static \u0275fac=function(t){return new(t||i)(x(j))};static \u0275dir=_e({type:i,selectors:[["","TextWriterAnimator",""]],inputs:{text:"text",speed:"speed"},outputs:{animating:"animating"},standalone:!0})}return i})();function ve(i){return/[\u0600-\u06FF]+/.test(i)}var Qt=i=>(i.split(" ").map(n=>(ve(n)?"\u202A":"\u202C")+n).join(" "),i);var Ai=["video_ref"],Pi=i=>({processing:i}),Mi=i=>({disabled:i});function Ii(i,n){i&1&&v(0,"i",11)}var qt=(()=>{class i{AiAvatarButtonComponent=i;video_ref;onToggle=new k;type="inner";service=T(Pt);route=T(Ee);static toggled=!1;isProcessing=!1;STREAM_ID_STORAGE_KEY=N.STREAM_ID_STORAGE_KEY;OUTER_AVATAR_IS_ACTIVE_KEY=N.OUTER_AVATAR_IS_ACTIVE_KEY;get isActiveOuterScreen(){return JSON.parse(localStorage.getItem(this.OUTER_AVATAR_IS_ACTIVE_KEY)||"false")}ngOnInit(){localStorage.getItem(this.STREAM_ID_STORAGE_KEY)&&this.closeStream()}ngAfterViewInit(){}closeStream(){let o=localStorage.getItem(this.STREAM_ID_STORAGE_KEY);o&&(localStorage.removeItem(this.STREAM_ID_STORAGE_KEY),this.service.closeStream(o).pipe(Ce(t=>{throw localStorage.setItem(this.STREAM_ID_STORAGE_KEY,o),t})).subscribe()),this.video_ref&&(this.video_ref.nativeElement.srcObject=null)}toggleVideo(){this.type=="outer"?(this.onToggle.emit(),window.open(window.location.origin+N.base+"/ai-avatar","myWindow","fullscreen=1")):(i.toggled=!i.toggled,this.onToggle.emit(i.toggled),localStorage.getItem(this.STREAM_ID_STORAGE_KEY)?this.closeStream():(this.isProcessing=!0,this.service.startStream().pipe(z(t=>{let{webrtcData:e}=t.data,{offer:r,iceServers:c}=e,{id:d}=t.data;localStorage.setItem(this.STREAM_ID_STORAGE_KEY,d);let R=new RTCPeerConnection({iceTransportPolicy:"relay",iceServers:c});return R.onicecandidate=_=>{console.log("onicecandidate",_),_.candidate&&this.service.sendCandidate(d,_.candidate).subscribe()},R.onicegatheringstatechange=_=>{_.target.iceGatheringState==="complete"&&this.video_ref.nativeElement.paused&&this.video_ref.nativeElement.srcObject&&this.video_ref.nativeElement.play()},R.ontrack=_=>{console.log("ontrack",_);let[ae]=_.streams;this.video_ref.nativeElement.srcObject=ae},be(R.setRemoteDescription(new RTCSessionDescription(r))).pipe(z(()=>be(R.createAnswer()))).pipe(z(_=>be(R.setLocalDescription(_)).pipe(le(()=>({id:d,answer_:_})))))})).pipe(de(()=>{this.isProcessing=!1}),z(({id:t,answer_:e})=>this.service.sendAnswer(t,e))).subscribe()))}beforeUnloadHandler(){this.closeStream()}ngOnDestroy(){this.closeStream()}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=w({type:i,selectors:[["ai-avatar-button"]],viewQuery:function(t,e){if(t&1&&G(Ai,5),t&2){let r;Y(r=Q())&&(e.video_ref=r.first)}},hostBindings:function(t,e){t&1&&f("beforeunload",function(c){return e.beforeUnloadHandler(c)},!1,K)},inputs:{type:"type"},outputs:{onToggle:"onToggle"},standalone:!0,features:[se([]),W],decls:13,vars:12,consts:[["video_ref",""],[1,"avatar-container","rounded-circle","position-relative",2,"box-shadow","0px 1px 13px #00000080"],[1,"avatar-popup-container",3,"hidden"],[1,"card","h-100"],[1,"card-header","d-flex","align-items-center","justify-lg-content-between"],[1,"m-0"],[1,"card-body","p-0"],["id","video","autoplay","","controls",""],[1,"spinner",3,"ngClass"],["type","button",1,"btn","circle","border-0",3,"click","tooltip","disabled","ngClass"],[1,"mdi","mdi-face-agent"],[1,"mdi","mdi-timeline-outline","new-tap-icon"]],template:function(t,e){if(t&1){let r=S();l(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"h6",5),h(5,"Reactive Avatar"),a()(),l(6,"div",6),v(7,"video",7,0),a()()(),v(9,"div",8),l(10,"button",9),f("click",function(){return u(r),g(e.toggleVideo())}),v(11,"i",10),b(12,Ii,1,0,"i",11),a()()}t&2&&(s(),p("hidden",e.type=="outer"||!e.AiAvatarButtonComponent.toggled),s(8),p("ngClass",J(8,Pi,e.isProcessing)),s(),p("tooltip",e.AiAvatarButtonComponent.toggled?"Close Avatar":e.type=="outer"?"Open new screen Avatar":"Open Avatar")("disabled",e.isProcessing||e.type=="inner"&&e.isActiveOuterScreen||e.type=="outer"&&e.AiAvatarButtonComponent.toggled)("ngClass",J(10,Mi,e.isProcessing||e.type=="inner"&&e.isActiveOuterScreen||e.type=="outer"&&e.AiAvatarButtonComponent.toggled)),s(),re(e.type=="outer"?"font-size: 14px; position: relative; left: 4px; top: 0px;":""),s(),C(e.type=="outer"?12:-1))},dependencies:[Le,Dt,D,L],styles:['.avatar-container[_ngcontent-%COMP%]{height:34px;width:34px;margin-top:2px;display:flex;align-items:center;justify-content:center}.avatar-container[_ngcontent-%COMP%]   .avatar-popup-container[_ngcontent-%COMP%]{z-index:1;position:absolute;bottom:0;right:68px}.avatar-container[_ngcontent-%COMP%]   .avatar-popup-container[_ngcontent-%COMP%]:after{content:"";display:block;width:18px;height:18px;background:#fff;border-width:var(--bs-border-width);border-color:var(--bs-border-color);border-style:var(--bs-border-style);border-top:none;border-left:none;transform:rotate(45deg);position:absolute;bottom:12px;right:-9px;clip-path:polygon(0 0,100% 0,100% 0,100% 100%)}.avatar-container[_ngcontent-%COMP%]   .avatar-popup-container[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{background:#c1c1c1!important}.avatar-container[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{width:380px;height:300px}.avatar-container[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{width:34px;height:34px;border-radius:50%;background:#fff;display:flex;justify-content:center;align-items:center;z-index:1;opacity:1;transition:.5s;box-shadow:0 0 2px #00000024,0 1px 18px #0000001f,0 3px 5px -1px #0002}.avatar-container[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#b2b1b1;font-size:23px;transition:.9s}.avatar-container[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:41px;height:41px;border-radius:50%;position:absolute;transform:rotate(0);background:linear-gradient(to left,#dede4e,transparent,transparent,#70f570,#8c8cff,transparent,transparent,#dede4e);animation:_ngcontent-%COMP%_spin 2s linear infinite .5s;opacity:0}.avatar-container[_ngcontent-%COMP%]   .spinner.processing[_ngcontent-%COMP%]{opacity:1}.avatar-container[_ngcontent-%COMP%]   .new-tap-icon[_ngcontent-%COMP%]{position:absolute;font-size:26px!important;top:-2px}.disabled[_ngcontent-%COMP%]{background:#dfd9d9!important}@media screen and (max-width: 900px){.avatar-container[_ngcontent-%COMP%]   .avatar-popup-container[_ngcontent-%COMP%]{right:auto;left:0;bottom:50px}.avatar-container[_ngcontent-%COMP%]   .avatar-popup-container[_ngcontent-%COMP%]:after{right:auto;left:12px;transform:rotate(135deg);bottom:-9px}.avatar-container[_ngcontent-%COMP%]   .avatar-popup-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{white-space:nowrap}.avatar-container[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{width:260px;height:260px}}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}']})}return i})();var Oi=["chat_container"],Ri=["chat_body"],Di=["recorder"],Bi=(i,n)=>n.content,Fi=(i,n)=>n.filepath,Vi=(i,n,o)=>({"align-items-end":i,"align-items-center":n,toggled:o}),Li=i=>({fullscreen:i}),Ni=(i,n)=>({"mdi-arrow-expand-all":i,"mdi-arrow-collapse-all":n}),Hi=(i,n)=>({rtl:i,ltr:n}),ji=(i,n)=>({"mdi-chevron-down":i,"mdi-chevron-up":n});function Wi(i,n){i&1&&(l(0,"small",15),h(1," Let's chat with me to help you. "),a())}function $i(i,n){if(i&1){let o=S();l(0,"span",36),f("animating",function(e){u(o);let r=m(2);return g(r.animating=e)}),a()}if(i&2){let o=m().$implicit;p("text",o.content)}}function zi(i,n){if(i&1&&v(0,"span",35),i&2){let o=m().$implicit;p("innerHtml",o.content,ut)}}function Ki(i,n){if(i&1){let o=S();l(0,"div",41)(1,"div",42)(2,"small",43),h(3),v(4,"i",44),a()(),l(5,"a",45),f("click",function(){let e=u(o).$implicit,r=m(3),c=I(38);return g(r.openDocModal(c,e))}),h(6),a()()}if(i&2){let o=n.$implicit,t=n.$index;s(3),E(" doc ",t+1," "),s(3),P(o.filepath)}}function Ui(i,n){if(i&1){let o=S();l(0,"div")(1,"div",37),f("click",function(){u(o);let e=I(6);return g(e.hidden=!e.hidden)}),v(2,"i",38),l(3,"span",39),h(4,"References"),a()(),l(5,"div",40,4),F(7,Ki,7,2,"div",41,Fi),a()()}if(i&2){let o=I(6),t=m().$implicit;s(2),p("ngClass",O(1,ji,o.hidden,!o.hidden)),s(5),V(t.context.citations)}}function Gi(i,n){if(i&1&&(l(0,"div")(1,"div",33),b(2,$i,1,1,"span",34)(3,zi,1,1,"span",35)(4,Ui,9,4,"div"),a()()),i&2){let o=n.$implicit,t=m();A("message "+o.role+"-message"),s(),p("ngClass",O(5,Hi,t.isRTL(o.content),!t.isRTL(o.content))),s(),C(o.role==="assistant"?2:3),s(2),C(o.context&&o.context.citations.length?4:-1)}}function Yi(i,n){i&1&&(l(0,"div",18),v(1,"app-loading"),a())}function Qi(i,n){if(i&1){let o=S();l(0,"div",46)(1,"h4",47),h(2,"Citation Details"),a(),l(3,"button",48),f("click",function(){u(o);let e=m();return g(e.modalRef==null?null:e.modalRef.hide())}),l(4,"span",49),h(5,"\xD7"),a()()(),l(6,"div",50)(7,"p",51),h(8),a(),l(9,"strong"),h(10,"Link to document: "),a(),l(11,"a",52),h(12),a()(),l(13,"div",53)(14,"button",54),f("click",function(){u(o);let e=m();return g(e.modalRef==null?null:e.modalRef.hide())}),h(15," Close "),a()()}if(i&2){let o=m();s(8),P(o.selectedDoc.content),s(3),p("href",o.selectedDoc.url,oe),s(),E(" ",o.selectedDoc.filepath," ")}}var Xt=(()=>{class i{chat_container;chat_body;recorder;toggled=!1;service=T(Lt);aiSpeechToTextService=T(Ve);modalService=T(nt);stopProcessing$=new fe;modalRef;control=new Oe("",Me.required);ask$=new fe;selectedDoc;fullScreen=!1;animating=!1;activeAvatar=!1;interval;isRTL=ve;OUTER_AVATAR_IS_ACTIVE_KEY=N.OUTER_AVATAR_IS_ACTIVE_KEY;MESSAGE_TEXT_KEY=N.MESSAGE_TEXT_KEY;AVATAR_IS_RECORDING_KEY=N.AVATAR_IS_RECORDING_KEY;STREAM_ID_STORAGE_KEY=N.STREAM_ID_STORAGE_KEY;handleKeyboardEvent(o){o.key==="Enter"&&(o.preventDefault(),this.ask$.next())}constructor(){}ngOnInit(){this.listenToAskQuestion(),this.handleOuterAvatar()}ngAfterViewInit(){this.scrollToMessage()}handleOuterAvatar(){this.interval=setInterval(()=>{localStorage.getItem(this.MESSAGE_TEXT_KEY)&&!JSON.parse(localStorage.getItem(this.AVATAR_IS_RECORDING_KEY)||"false")&&(this.control.setValue(localStorage.getItem(this.MESSAGE_TEXT_KEY)),this.ask$.next())},200)}scrollToMessage(){this.chat_body&&this.chat_container&&this.chat_container.nativeElement.lastElementChild&&(this.chat_body.nativeElement.scrollTop=this.chat_body?.nativeElement.scrollHeight-this.chat_container.nativeElement.lastElementChild.scrollHeight-20)}listenToAskQuestion(){this.ask$.pipe(ce(()=>!this.service.loading&&this.control.valid&&!!this.control.value.trim())).pipe(Se(()=>{(this.recorder.isProcessing||this.recorder.isRecording)&&this.recorder.canceledRecording()})).pipe(z(()=>{setTimeout(()=>{this.scrollToMessage()},200);let o=localStorage.getItem(this.STREAM_ID_STORAGE_KEY)||void 0;return this.service.askQuestion(this.control.value,o).pipe(ct(this.stopProcessing$))})).subscribe(o=>{Qt(this.formatText(o.message.content)),this.reset(),this.service.appendMessage(new te().clone(at(st({},o.message),{content:this.formatText(o.message.content)}))),setTimeout(()=>{this.scrollToMessage()},200)})}openDocModal(o,t){this.selectedDoc=t,this.modalRef=this.modalService.show(o,{class:"modal-lg"})}formatText(o){let t=o.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>");return t=t.replace(/\[(.*?)\]/g,'<pre class="d-inline"><small class="px-1 text-primary">$1<i class="mdi mdi-link-variant"></i></small></pre>'),t.trim()}stopAnimation(){this.stopProcessing$.next(),this.service.messageHistory[this.service.messageHistory.length-1].role=="assistant"&&(this.service.messageHistory[this.service.messageHistory.length-1].content=this.chat_container.nativeElement.lastElementChild.children[0].children[0].innerHTML),this.reset()}handleSpeechToText(o){this.control.setValue(o)}stopRecording(){this.ask$.next()}reset(){this.control.reset(),localStorage.setItem(this.MESSAGE_TEXT_KEY,""),this.control.updateValueAndValidity()}clear(){this.reset(),this.service.resetMessageHistory(),clearInterval(this.interval)}beforeUnloadHandler(){this.clear()}ngOnDestroy(){this.clear()}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=w({type:i,selectors:[["app-ai-chat-bot"]],viewQuery:function(t,e){if(t&1&&(G(Oi,5),G(Ri,5),G(Di,5)),t&2){let r;Y(r=Q())&&(e.chat_container=r.first),Y(r=Q())&&(e.chat_body=r.first),Y(r=Q())&&(e.recorder=r.first)}},hostBindings:function(t,e){t&1&&f("keypress",function(c){return e.handleKeyboardEvent(c)},!1,ye)("beforeunload",function(c){return e.beforeUnloadHandler(c)},!1,K)},standalone:!0,features:[se([nt]),W],decls:39,vars:24,consts:[["chat_body",""],["chat_container",""],["recorder",""],["docModal",""],["linkRef",""],[1,"chat-bot-button"],[1,"btn","btn-primary","toggle-button",3,"click"],[1,"mdi","mdi-robot-happy","mdi-24px"],[1,"d-flex","flex-column","avatar-card-container",3,"ngClass"],[1,"card","col-12",3,"ngClass"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"text-primary","mdi","mdi-robot-happy","mdi-24px"],[1,"btn","btn-outline-primary",3,"click"],[1,"mdi","mdi-arrow-expand-all",3,"ngClass"],[1,"text-center","card-body","overflow-auto"],[1,"fw-bold"],[1,"chat-container"],[3,"class"],[1,"loading-text"],[1,"card-footer"],["id","message-form"],[1,"input-group","position-relative"],[1,"d-flex","input-group-append","position-relative",2,"top","-2px"],[1,"me-2"],[3,"onToggle"],[3,"type"],[3,"onRecordReady","onStopRecording","disabled","isProcessing"],[3,"onClick","active"],["type","text","id","user-message","placeholder","Type your message...",1,"form-control-sm","form-control","rounded-0","rounded-start",3,"formControl"],[1,"input-group-append"],["type","button",1,"rounded-0","rounded-end","btn","btn-sm","btn-primary",3,"click","disabled"],[1,"mdi","mdi-send"],["id","clear-chat","type","button",1,"btn","btn-sm","btn-outline-secondary","ms-2",3,"click"],[1,"message-content",3,"ngClass"],["TextWriterAnimator","",3,"text"],[3,"innerHtml"],["TextWriterAnimator","",3,"animating","text"],[1,"icon-with-title",3,"click"],[1,"mdi",3,"ngClass"],[1,"title"],["hidden",""],["dir","auto"],[1,"d-inline"],[1,"px-1","text-primary"],[1,"mdi","mdi-link-variant"],[1,"d-inline","citation-link",2,"cursor","pointer",3,"click"],[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body",2,"overflow-wrap","break-word"],[2,"text-align","justify"],["target","_blank",3,"href"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(t,e){if(t&1){let r=S();l(0,"div",5)(1,"button",6),f("click",function(){return u(r),g(e.toggled=!e.toggled)}),v(2,"i",7),a(),l(3,"div",8)(4,"div",9)(5,"div",10)(6,"span"),v(7,"i",11),h(8," Chat bot "),a(),l(9,"button",12),f("click",function(){return u(r),g(e.fullScreen=!e.fullScreen)}),v(10,"i",13),a()(),l(11,"div",14,0),b(13,Wi,2,0,"small",15),l(14,"div",16,1),F(16,Gi,5,8,"div",17,Bi),a(),b(18,Yi,2,0,"div",18),a(),l(19,"div",19)(20,"form",20)(21,"div",21)(22,"div",22)(23,"div",23)(24,"ai-avatar-button",24),f("onToggle",function(d){return u(r),g(e.activeAvatar=d)}),a()(),l(25,"div",23),v(26,"ai-avatar-button",25),a(),l(27,"div",23)(28,"audio-recorder",26,2),f("onRecordReady",function(d){return u(r),g(e.handleSpeechToText(d))})("onStopRecording",function(){return u(r),g(e.stopRecording())}),a()()(),l(30,"stop-processing-btn",27),f("onClick",function(){return u(r),g(e.stopAnimation())}),a(),v(31,"input",28),l(32,"div",29)(33,"button",30),f("click",function(){return u(r),g(e.ask$.next())}),v(34,"i",31),a(),l(35,"button",32),f("click",function(){return u(r),g(e.clear())}),h(36," Clear "),a()()()()()()()(),b(37,Qi,16,3,"ng-template",null,3,ee)}t&2&&(s(3),p("ngClass",xe(15,Vi,e.activeAvatar,!e.activeAvatar,e.toggled)),s(),re("min-height: 300px; "+(e.fullScreen?"":"height: calc(100vh - 90px - 6rem);")),p("ngClass",J(19,Li,e.fullScreen)),s(6),p("ngClass",O(21,Ni,!e.fullScreen,e.fullScreen)),s(),re(e.fullScreen?"":"max-height: 100%"),s(2),C(e.service.messageHistory.length?-1:13),s(3),V(e.service.messageHistory),s(2),C(e.service.loading?18:-1),s(8),p("type","outer"),s(2),p("disabled",e.service.loading||e.aiSpeechToTextService.loading)("isProcessing",e.aiSpeechToTextService.loading),s(2),p("active",e.service.loading||e.animating),s(),p("formControl",e.control),s(2),p("disabled",e.service.loading||e.aiSpeechToTextService.loading))},dependencies:[Fe,ge,pe,me,ue,De,D,L,Ne,ze,Yt,It,qt,Le],styles:['.chat-bot-button[_ngcontent-%COMP%]{width:50px;height:50px;position:fixed;right:20px;bottom:20px}.chat-bot-button[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]{position:absolute;top:0;left:0}.chat-bot-button[_ngcontent-%COMP%]   .avatar-card-container[_ngcontent-%COMP%]{position:absolute;right:62px;bottom:0;width:460px;transition:.5s;opacity:0;visibility:hidden}.chat-bot-button[_ngcontent-%COMP%]   .avatar-card-container.toggled[_ngcontent-%COMP%]{opacity:1;visibility:visible}.user-message[_ngcontent-%COMP%], .assistant-message[_ngcontent-%COMP%]{display:flex}.message-content[_ngcontent-%COMP%]{letter-spacing:normal;border-radius:.25rem;margin-bottom:.75rem;padding:.5rem;width:85%;position:relative;word-break:break-word;white-space:pre-wrap}#citation-content[_ngcontent-%COMP%]{text-align:justify}.message-content[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block}.message-content[_ngcontent-%COMP%]   .icon-with-title[_ngcontent-%COMP%]{margin-top:1rem}.user-message[_ngcontent-%COMP%]{justify-content:end}.user-message[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]{background:var(--bs-primary);color:var(--bs-white);border-top-right-radius:0}.user-message[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]:after{content:"";position:absolute;right:-12px;top:0;background:var(--bs-primary);width:12px;height:12px;clip-path:polygon(0 0,100% 0,0 100%)}.assistant-message[_ngcontent-%COMP%]{justify-content:start}.assistant-message[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]{background:var(--bs-gray-300)}.assistant-message[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]:after{content:"";position:absolute;left:-10px;top:0;background:var(--bs-gray-300);width:12px;height:12px;clip-path:polygon(0 0,100% 0,100% 100%)}.error-message[_ngcontent-%COMP%]{margin-top:1.5rem;width:100%;background:var(--bs-danger);color:var(--bs-white)}.error-message[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]{direction:ltr}.fullscreen[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%!important;height:100%;z-index:1}']})}return i})();var Zt=(()=>{class i extends Pe{tag="website/";http=T(Te);constructor(){super("search")}search(o,t,e,r="date",c=""){return this.startLoading(),this.http.post(this.baseUrl,{query:o,page_size:t,page_number:e,sort:r,facet:c},{headers:new we({})}).pipe(de(()=>{this.stopLoading()}))}static \u0275fac=function(t){return new(t||i)};static \u0275prov=M({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var qi=(i,n)=>({"pull-left":i,"float-left":n}),Xi=(i,n)=>({"pull-right":i,"float-right":n}),Ke=(i,n)=>({disabled:i,currentPage:n}),Zi=(i,n,o)=>({disabled:i,$implicit:n,currentPage:o});function Ji(i,n){if(i&1){let o=S();l(0,"li",11)(1,"a",12),f("click",function(e){u(o);let r=m();return g(r.selectPage(1,e))}),he(2,13),a()()}if(i&2){let o=m(),t=I(13);U("disabled",o.noPrevious()||o.disabled),s(2),p("ngTemplateOutlet",o.customFirstTemplate||t)("ngTemplateOutletContext",O(4,Ke,o.noPrevious()||o.disabled,o.page))}}function en(i,n){if(i&1){let o=S();l(0,"li",14)(1,"a",12),f("click",function(e){u(o);let r=m();return g(r.selectPage(r.page-1,e))}),he(2,13),a()()}if(i&2){let o=m(),t=I(11);U("disabled",o.noPrevious()||o.disabled),s(2),p("ngTemplateOutlet",o.customPreviousTemplate||t)("ngTemplateOutletContext",O(4,Ke,o.noPrevious()||o.disabled,o.page))}}function tn(i,n){if(i&1){let o=S();l(0,"li",15)(1,"a",12),f("click",function(e){let r=u(o).$implicit,c=m();return g(c.selectPage(r.number,e))}),he(2,13),a()()}if(i&2){let o=n.$implicit,t=m(),e=I(7);U("active",o.active)("disabled",t.disabled&&!o.active),s(2),p("ngTemplateOutlet",t.customPageTemplate||e)("ngTemplateOutletContext",xe(6,Zi,t.disabled,o,t.page))}}function nn(i,n){if(i&1){let o=S();l(0,"li",16)(1,"a",12),f("click",function(e){u(o);let r=m();return g(r.selectPage(r.page+1,e))}),he(2,13),a()()}if(i&2){let o=m(),t=I(9);U("disabled",o.noNext()||o.disabled),s(2),p("ngTemplateOutlet",o.customNextTemplate||t)("ngTemplateOutletContext",O(4,Ke,o.noNext()||o.disabled,o.page))}}function on(i,n){if(i&1){let o=S();l(0,"li",17)(1,"a",12),f("click",function(e){u(o);let r=m();return g(r.selectPage(r.totalPages,e))}),he(2,13),a()()}if(i&2){let o=m(),t=I(15);U("disabled",o.noNext()||o.disabled),s(2),p("ngTemplateOutlet",o.customLastTemplate||t)("ngTemplateOutletContext",O(4,Ke,o.noNext()||o.disabled,o.page))}}function rn(i,n){if(i&1&&h(0),i&2){let o=n.$implicit;P(o.text)}}function sn(i,n){if(i&1&&h(0),i&2){let o=m();P(o.getText("next"))}}function an(i,n){if(i&1&&h(0),i&2){let o=m();P(o.getText("previous"))}}function ln(i,n){if(i&1&&h(0),i&2){let o=m();P(o.getText("first"))}}function cn(i,n){if(i&1&&h(0),i&2){let o=m();P(o.getText("last"))}}var Jt=(()=>{let n=class n{constructor(){this.main={itemsPerPage:10,boundaryLinks:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",pageBtnClass:"",rotate:!0},this.pager={itemsPerPage:15,previousText:"\xAB Previous",nextText:"Next \xBB",pageBtnClass:"",align:!0}}};n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=M({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})(),dn={provide:Ze,useExisting:Ue(()=>hn),multi:!0},hn=(()=>{let n=class n{constructor(t,e,r){this.elementRef=t,this.changeDetection=r,this.align=!1,this.boundaryLinks=!1,this.directionLinks=!0,this.firstText="First",this.previousText="\xAB Previous",this.nextText="Next \xBB",this.lastText="Last",this.rotate=!0,this.pageBtnClass="",this.disabled=!1,this.numPages=new k,this.pageChanged=new k,this.onChange=Function.prototype,this.onTouched=Function.prototype,this.classMap="",this.inited=!1,this._itemsPerPage=15,this._totalItems=0,this._totalPages=0,this._page=1,this.elementRef=t,this.config||this.configureOptions(Object.assign({},e.main,e.pager))}get itemsPerPage(){return this._itemsPerPage}set itemsPerPage(t){this._itemsPerPage=t,this.totalPages=this.calculateTotalPages()}get totalItems(){return this._totalItems}set totalItems(t){this._totalItems=t,this.totalPages=this.calculateTotalPages()}get totalPages(){return this._totalPages}set totalPages(t){this._totalPages=t,this.numPages.emit(t),this.inited&&this.selectPage(this.page)}get page(){return this._page}set page(t){let e=this._page;this._page=t>this.totalPages?this.totalPages:t||1,this.changeDetection.markForCheck(),!(e===this._page||typeof e>"u")&&this.pageChanged.emit({page:this._page,itemsPerPage:this.itemsPerPage})}configureOptions(t){this.config=Object.assign({},t)}ngOnInit(){typeof window<"u"&&(this.classMap=this.elementRef.nativeElement.getAttribute("class")||""),typeof this.maxSize>"u"&&(this.maxSize=this.config?.maxSize||0),typeof this.rotate>"u"&&(this.rotate=!!this.config?.rotate),typeof this.boundaryLinks>"u"&&(this.boundaryLinks=!!this.config?.boundaryLinks),typeof this.directionLinks>"u"&&(this.directionLinks=!!this.config?.directionLinks),typeof this.pageBtnClass>"u"&&(this.pageBtnClass=this.config?.pageBtnClass||""),typeof this.itemsPerPage>"u"&&(this.itemsPerPage=this.config?.itemsPerPage||0),this.totalPages=this.calculateTotalPages(),this.pages=this.getPages(this.page,this.totalPages),this.inited=!0}writeValue(t){this.page=t,this.pages=this.getPages(this.page,this.totalPages)}getText(t){return this[`${t}Text`]||this.config[`${t}Text`]}noPrevious(){return this.page===1}noNext(){return this.page===this.totalPages}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}selectPage(t,e){e&&e.preventDefault(),this.disabled||(e&&e.target&&e.target.blur(),this.writeValue(t),this.onChange(this.page))}makePage(t,e,r){return{text:e,number:t,active:r}}getPages(t,e){let r=[],c=1,d=e,R=typeof this.maxSize<"u"&&this.maxSize<e;R&&this.maxSize&&(this.rotate?(c=Math.max(t-Math.floor(this.maxSize/2),1),d=c+this.maxSize-1,d>e&&(d=e,c=d-this.maxSize+1)):(c=(Math.ceil(t/this.maxSize)-1)*this.maxSize+1,d=Math.min(c+this.maxSize-1,e)));for(let _=c;_<=d;_++){let ae=this.makePage(_,_.toString(),_===t);r.push(ae)}if(R&&!this.rotate){if(c>1){let _=this.makePage(c-1,"...",!1);r.unshift(_)}if(d<e){let _=this.makePage(d+1,"...",!1);r.push(_)}}return r}calculateTotalPages(){let t=this.itemsPerPage<1?1:Math.ceil(this.totalItems/this.itemsPerPage);return Math.max(t||0,1)}};n.\u0275fac=function(e){return new(e||n)(x(j),x(Jt),x(qe))},n.\u0275cmp=w({type:n,selectors:[["pager"]],inputs:{align:"align",maxSize:"maxSize",boundaryLinks:"boundaryLinks",directionLinks:"directionLinks",firstText:"firstText",previousText:"previousText",nextText:"nextText",lastText:"lastText",rotate:"rotate",pageBtnClass:"pageBtnClass",disabled:"disabled",itemsPerPage:"itemsPerPage",totalItems:"totalItems"},outputs:{numPages:"numPages",pageChanged:"pageChanged"},features:[se([dn])],decls:7,vars:24,consts:[[1,"pager"],[3,"ngClass"],["href","",3,"click"]],template:function(e,r){e&1&&(l(0,"ul",0)(1,"li",1)(2,"a",2),f("click",function(d){return r.selectPage(r.page-1,d)}),h(3),a()(),l(4,"li",1)(5,"a",2),f("click",function(d){return r.selectPage(r.page+1,d)}),h(6),a()()()),e&2&&(s(),A(r.pageBtnClass),U("disabled",r.noPrevious())("previous",r.align),p("ngClass",O(18,qi,r.align,r.align)),s(2),P(r.getText("previous")),s(),A(r.pageBtnClass),U("disabled",r.noNext())("next",r.align),p("ngClass",O(21,Xi,r.align,r.align)),s(2),P(r.getText("next")))},dependencies:[L],encapsulation:2});let i=n;return i})(),pn={provide:Ze,useExisting:Ue(()=>ot),multi:!0},ot=(()=>{let n=class n{constructor(t,e,r){this.elementRef=t,this.changeDetection=r,this.align=!0,this.boundaryLinks=!1,this.directionLinks=!0,this.rotate=!0,this.pageBtnClass="",this.disabled=!1,this.numPages=new k,this.pageChanged=new k,this.onChange=Function.prototype,this.onTouched=Function.prototype,this.classMap="",this.inited=!1,this._itemsPerPage=10,this._totalItems=0,this._totalPages=0,this._page=1,this.elementRef=t,this.config||this.configureOptions(e.main)}get itemsPerPage(){return this._itemsPerPage}set itemsPerPage(t){this._itemsPerPage=t,this.totalPages=this.calculateTotalPages()}get totalItems(){return this._totalItems}set totalItems(t){this._totalItems=t,this.totalPages=this.calculateTotalPages()}get totalPages(){return this._totalPages}set totalPages(t){this._totalPages=t,this.numPages.emit(t),this.inited&&this.selectPage(this.page)}get page(){return this._page}set page(t){let e=this._page;this._page=t>this.totalPages?this.totalPages:t||1,this.changeDetection.markForCheck(),!(e===this._page||typeof e>"u")&&this.pageChanged.emit({page:this._page,itemsPerPage:this.itemsPerPage})}configureOptions(t){this.config=Object.assign({},t)}ngOnInit(){typeof window<"u"&&(this.classMap=this.elementRef.nativeElement.getAttribute("class")||""),typeof this.maxSize>"u"&&(this.maxSize=this.config?.maxSize||0),typeof this.rotate>"u"&&(this.rotate=!!this.config?.rotate),typeof this.boundaryLinks>"u"&&(this.boundaryLinks=!!this.config?.boundaryLinks),typeof this.directionLinks>"u"&&(this.directionLinks=!!this.config?.directionLinks),typeof this.pageBtnClass>"u"&&(this.pageBtnClass=this.config?.pageBtnClass||""),typeof this.itemsPerPage>"u"&&(this.itemsPerPage=this.config?.itemsPerPage||0),this.totalPages=this.calculateTotalPages(),this.pages=this.getPages(this.page,this.totalPages),this.inited=!0}writeValue(t){this.page=t,this.pages=this.getPages(this.page,this.totalPages)}getText(t){return this[`${t}Text`]||this.config[`${t}Text`]}noPrevious(){return this.page===1}noNext(){return this.page===this.totalPages}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}selectPage(t,e){e&&e.preventDefault(),this.disabled||(e&&e.target&&e.target.blur(),this.writeValue(t),this.onChange(this.page))}makePage(t,e,r){return{text:e,number:t,active:r}}getPages(t,e){let r=[],c=1,d=e,R=typeof this.maxSize<"u"&&this.maxSize<e;R&&this.maxSize&&(this.rotate?(c=Math.max(t-Math.floor(this.maxSize/2),1),d=c+this.maxSize-1,d>e&&(d=e,c=d-this.maxSize+1)):(c=(Math.ceil(t/this.maxSize)-1)*this.maxSize+1,d=Math.min(c+this.maxSize-1,e)));for(let _=c;_<=d;_++){let ae=this.makePage(_,_.toString(),_===t);r.push(ae)}if(R&&!this.rotate){if(c>1){let _=this.makePage(c-1,"...",!1);r.unshift(_)}if(d<e){let _=this.makePage(d+1,"...",!1);r.push(_)}}return r}calculateTotalPages(){let t=this.itemsPerPage<1?1:Math.ceil(this.totalItems/this.itemsPerPage);return Math.max(t||0,1)}};n.\u0275fac=function(e){return new(e||n)(x(j),x(Jt),x(qe))},n.\u0275cmp=w({type:n,selectors:[["pagination"]],inputs:{align:"align",maxSize:"maxSize",boundaryLinks:"boundaryLinks",directionLinks:"directionLinks",firstText:"firstText",previousText:"previousText",nextText:"nextText",lastText:"lastText",rotate:"rotate",pageBtnClass:"pageBtnClass",disabled:"disabled",customPageTemplate:"customPageTemplate",customNextTemplate:"customNextTemplate",customPreviousTemplate:"customPreviousTemplate",customFirstTemplate:"customFirstTemplate",customLastTemplate:"customLastTemplate",itemsPerPage:"itemsPerPage",totalItems:"totalItems"},outputs:{numPages:"numPages",pageChanged:"pageChanged"},features:[se([pn])],decls:16,vars:6,consts:[["defaultPageTemplate",""],["defaultNextTemplate",""],["defaultPreviousTemplate",""],["defaultFirstTemplate",""],["defaultLastTemplate",""],[1,"pagination",3,"ngClass"],["class","pagination-first page-item",3,"disabled",4,"ngIf"],["class","pagination-prev page-item",3,"disabled",4,"ngIf"],["class","pagination-page page-item",3,"active","disabled",4,"ngFor","ngForOf"],["class","pagination-next page-item",3,"disabled",4,"ngIf"],["class","pagination-last page-item",3,"disabled",4,"ngIf"],[1,"pagination-first","page-item"],["href","",1,"page-link",3,"click"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"pagination-prev","page-item"],[1,"pagination-page","page-item"],[1,"pagination-next","page-item"],[1,"pagination-last","page-item"]],template:function(e,r){e&1&&(l(0,"ul",5),b(1,Ji,3,7,"li",6)(2,en,3,7,"li",7)(3,tn,3,10,"li",8)(4,nn,3,7,"li",9)(5,on,3,7,"li",10),a(),b(6,rn,1,1,"ng-template",null,0,ee)(8,sn,1,1,"ng-template",null,1,ee)(10,an,1,1,"ng-template",null,2,ee)(12,ln,1,1,"ng-template",null,3,ee)(14,cn,1,1,"ng-template",null,4,ee)),e&2&&(p("ngClass",r.classMap),s(),p("ngIf",r.boundaryLinks),s(),p("ngIf",r.directionLinks),s(),p("ngForOf",r.pages),s(),p("ngIf",r.directionLinks),s(),p("ngIf",r.boundaryLinks))},dependencies:[L,xt,wt,Tt],encapsulation:2});let i=n;return i})(),ei=(()=>{let n=class n{static forRoot(){return{ngModule:n,providers:[]}}};n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ne({type:n}),n.\u0275inj=ie({imports:[D]});let i=n;return i})();var un=["recorder"],gn=(i,n)=>n.chunk_id,fn=(i,n)=>({rtl:i,ltr:n});function _n(i,n){i&1&&(l(0,"div",12),h(1," Processing "),v(2,"app-loading",18),a()),i&2&&(s(2),p("color","white"))}function vn(i,n){if(i&1&&(l(0,"span",19),h(1),a(),l(2,"span",20),h(3),a()),i&2){let o=m();s(),E('Search: "',o.searchKeyWord,'"'),s(2),E("Results: ",o.total_count,"")}}function bn(i,n){if(i&1&&(l(0,"p"),h(1),a()),i&2){let o=n.$implicit;s(),P(o)}}function Cn(i,n){if(i&1&&(l(0,"div"),F(1,bn,2,1,"p",null,Qe),a()),i&2){let o=m(2).$implicit;s(),V(o["@search.highlights"].merged_content)}}function Sn(i,n){if(i&1&&(l(0,"p"),h(1),a()),i&2){let o=n.$implicit;s(),E("Image caption: ",o,"")}}function yn(i,n){if(i&1&&(l(0,"div"),F(1,Sn,2,1,"p",null,Qe),a()),i&2){let o=m(2).$implicit;s(),V(o["@search.highlights"].imageCaption)}}function xn(i,n){if(i&1&&b(0,Cn,3,0,"div")(1,yn,3,0,"div"),i&2){let o=m().$implicit;C(o["@search.highlights"].merged_content.length>0?0:-1),s(),C(o["@search.highlights"].imageCaption.length>0?1:-1)}}function wn(i,n){i&1&&h(0),i&2&&E(" ","..."," ")}function Tn(i,n){if(i&1&&h(0),i&2){let o=m(2).$implicit,t=m();E(" ",t.isRTL(o.chunk)?"\u0639\u0631\u0636 \u0627\u0644\u0645\u0632\u064A\u062F":"Show more"," ")}}function En(i,n){if(i&1&&h(0),i&2){let o=m(2).$implicit,t=m();E(" ",t.isRTL(o.chunk)?"\u0639\u0631\u0636 \u0627\u0642\u0644":"Show less"," ")}}function kn(i,n){if(i&1){let o=S();l(0,"button",25),f("click",function(){u(o),m();let e=I(8);return g(e.hidden=!e.hidden)}),b(1,Tn,1,1)(2,En,1,1),a()}if(i&2){m();let o=I(8);s(),C(o.hidden?1:2)}}function An(i,n){if(i&1&&(l(0,"div")(1,"span",26)(2,"strong"),h(3,"Score: "),a(),h(4),a(),l(5,"span",27)(6,"strong"),h(7,"Reranker Score: "),a(),h(8),a()()),i&2){let o=m().$implicit;s(4),E(" ",o["@search.score"],""),s(4),E(" ",o["@search.reranker_score"],"")}}function Pn(i,n){if(i&1&&(l(0,"li",16)(1,"a",21),h(2),a(),b(3,xn,2,2),l(4,"div",22),h(5),b(6,wn,1,1),l(7,"span",23,1),h(9),a(),b(10,kn,3,1,"button",24),a(),b(11,An,9,2,"div"),a()),i&2){let o=n.$implicit,t=I(8),e=m();p("ngClass",O(9,fn,e.isRTL(o.chunk),!e.isRTL(o.chunk))),s(),Ct("href",o.ref_url,oe),s(),P(o.title),s(),C(o["@search.highlights"]?3:-1),s(2),E(" ",o.chunk.slice(0,400)," "),s(),C(t.hidden?6:-1),s(3),E(" ",o.chunk.slice(400,o.chunk.length)," "),s(),C(o.chunk.length>400?10:-1),s(),C(e.environment.debugMode?11:-1)}}function Mn(i,n){if(i&1){let o=S();l(0,"pagination",28),Z("ngModelChange",function(e){u(o);let r=m();return X(r.currentPage,e)||(r.currentPage=e),g(e)}),f("pageChanged",function(e){u(o);let r=m();return g(r.search$.next(e.page))}),a()}if(i&2){let o=m();p("disabled",o.service.loading||o.aiSpeechToTextService.loading)("totalItems",o.total_count),q("ngModel",o.currentPage),p("maxSize",5)}}var ti=(()=>{class i{recorder;service=T(Zt);aiSpeechToTextService=T(Ve);search$=new fe;control=new Oe("",[Me.required]);results=[];total_count=0;currentPage=1;searchKeyWord="";isRTL=ve;handleKeyboardEvent(o){o.key==="Enter"&&(o.preventDefault(),this.search$.next(1))}constructor(){}ngOnInit(){this.listenToSearch()}listenToSearch(){this.search$.pipe(ce(()=>!this.service.loading&&(!!this.control.valid||!!this.searchKeyWord))).pipe(Se(()=>{(this.recorder.isProcessing||this.recorder.isRecording)&&this.recorder.canceledRecording()})).pipe(le(o=>(this.control.value||this.control.setValue(this.searchKeyWord),this.control.value&&this.searchKeyWord!==this.control.value?this.currentPage=1:this.currentPage=o,this.currentPage))).pipe(z(o=>this.service.search(this.control.value,10,o))).subscribe(({rs:o,total_count:t})=>{this.results=o,this.total_count=t,this.searchKeyWord=this.control.value,this.control.reset(),this.control.updateValueAndValidity()})}handleSpeechToText(o){this.control.setValue(o)}stopRecording(){this.search$.next(1)}environment=N;static \u0275fac=function(t){return new(t||i)};static \u0275cmp=w({type:i,selectors:[["app-ai-search"]],viewQuery:function(t,e){if(t&1&&G(un,5),t&2){let r;Y(r=Q())&&(e.recorder=r.first)}},hostBindings:function(t,e){t&1&&f("keypress",function(c){return e.handleKeyboardEvent(c)},!1,ye)},standalone:!0,features:[W],decls:20,vars:9,consts:[["recorder",""],["completion",""],[1,"position-relative","d-flex","flex-column","justify-content-center","align-items-center",2,"z-index","3"],[1,"text-white","mb-4"],[1,"col-12","col-md-6","d-flex","mb-5","position-relative"],[1,"me-2"],[3,"onRecordReady","onStopRecording","disabled","isProcessing"],[1,"input-group",2,"box-shadow","0px 1px 13px #00000080"],["type","text","placeholder","Search...",1,"form-control","rounded-0","rounded-start",3,"formControl"],[1,"input-group-prepend"],["type","button",1,"rounded-0","rounded-end","btn","btn-secondary","text-white",3,"click","disabled"],[1,"mdi","mdi-magnify"],[1,"loading-text","text-white"],[1,"container","py-3"],[1,"pt-3"],[1,"list-group","bg-transparent"],[1,"list-group-item","py-3",3,"ngClass"],[1,"mt-3","justify-content-center",3,"disabled","totalItems","ngModel","maxSize"],[3,"color"],[1,"badge","bg-secondary"],[1,"badge","bg-secondary","ms-2"],["target","_blank",3,"href"],[1,"mt-3","mb-1",2,"text-align","justify","overflow-wrap","break-word"],["hidden",""],[1,"btn","btn-link"],[1,"btn","btn-link",3,"click"],[1,"badge","bg-primary"],[1,"badge","bg-primary","me-2"],[1,"mt-3","justify-content-center",3,"ngModelChange","pageChanged","disabled","totalItems","ngModel","maxSize"]],template:function(t,e){if(t&1){let r=S();l(0,"div",2)(1,"h5",3),h(2," Empowering Insights, Unleashing Intelligence! "),a(),l(3,"form",4)(4,"div",5)(5,"audio-recorder",6,0),f("onRecordReady",function(d){return u(r),g(e.handleSpeechToText(d))})("onStopRecording",function(){return u(r),g(e.stopRecording())}),a()(),l(7,"div",7),v(8,"input",8),l(9,"div",9)(10,"button",10),f("click",function(){return u(r),g(e.search$.next(1))}),v(11,"i",11),a()()()(),b(12,_n,3,1,"div",12),a(),l(13,"div",13),b(14,vn,4,2),l(15,"div",14)(16,"ul",15),F(17,Pn,12,12,"li",16,gn),a(),b(19,Mn,1,4,"pagination",17),a()()}t&2&&(re(e.results.length?"":"height: calc(100vh - 9rem - 90px)"),s(5),p("disabled",e.service.loading||e.aiSpeechToTextService.loading)("isProcessing",e.aiSpeechToTextService.loading),s(3),p("formControl",e.control),s(2),p("disabled",e.service.loading||e.aiSpeechToTextService.loading),s(2),C(e.service.loading?12:-1),s(2),C(e.results.length?14:-1),s(3),V(e.results),s(2),C(e.total_count?19:-1))},dependencies:[Fe,ge,pe,me,ue,De,D,L,Be,Re,Ie,Ne,ze,ei,ot]})}return i})();var In=(i,n)=>n.id;function On(i,n){if(i&1&&(l(0,"div",3)(1,"div",4)(2,"div",5)(3,"h5",6),h(4),a(),v(5,"i"),a(),l(6,"div",7)(7,"p",8),h(8),a(),l(9,"button",9),h(10," Try it out "),a()()()()),i&2){let o=n.$implicit;s(4),E(" ",o.title," "),s(),A("text-primary mdi mdi-24px mdi-"+o.icon),s(3),E(" ",o.description," "),s(),p("routerLink",o.route)}}var rt=(()=>{class i{services=[{id:1,icon:"robot-confused-outline",title:"Chat bot",route:"/ai-service/ai-chat-bot",description:"A bot that provides assistance, answers questions and provides information in an immediate and efficient manner. The intelligent bot relies on natural information technologies to understand and queries users."},{id:2,icon:"magnify",title:"AI Search",route:"/ai-service/ai-search",description:"Smart Search is a cutting-edge technology that uses artificial intelligence to improve the online search experience. Instead of providing a long list of links, this service analyzes the intent and context behind the question to provide the user with accurate and detailed answers."}];ngOnInit(){}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=w({type:i,selectors:[["app-ai-service-home"]],standalone:!0,features:[W],decls:6,vars:0,consts:[[1,"container","py-5"],[1,"row"],[1,"text-center","mx-auto","col-12","text-white","mb-5"],[1,"mx-auto","col-12","col-sm-6"],[1,"card","h-100"],[1,"card-header","d-flex","align-items-center"],[1,"m-0","me-auto"],[1,"card-body","h-100","d-flex","flex-column"],[2,"font-size","14px","min-height","100px","text-align","justify"],[1,"d-block","w-100","btn","btn-outline-primary","mt-auto","btn-sm","px-4",3,"routerLink"]],template:function(t,e){t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),h(3," Welcome to AI Solutions "),a(),F(4,On,11,5,"div",3,In),a()()),t&2&&(s(4),V(e.services))},dependencies:[Ae,ke]})}return i})();var Xr=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=ne({type:i});static \u0275inj=ie({imports:[D,Ae.forChild([{path:"",component:Vt,children:[{path:"",pathMatch:"full",redirectTo:"/ai-service/ai-service-home"},{path:"ai-service-home",component:rt},{path:"ai-chat-bot",component:Xt},{path:"ai-search",component:ti},{path:"ai-service-home",component:rt}]}]),Be]})}return i})();export{Xr as AiServicesModule};
